[0m17:11:47.743704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f123a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f83940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f83760>]}


============================== 17:11:47.746087 | 137d39c0-ff3d-4274-b38f-31fd13d45dfc ==============================
[0m17:11:47.746087 [info ] [MainThread]: Running with dbt=1.10.17
[0m17:11:47.746360 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'printer_width': '80', 'warn_error': 'None', 'invocation_command': 'dbt debug', 'introspect': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'log_path': '/Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics/logs', 'quiet': 'False', 'partial_parse': 'True', 'version_check': 'True', 'static_parser': 'True', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': '/Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'write_json': 'True'}
[0m17:11:47.754767 [info ] [MainThread]: dbt version: 1.10.17
[0m17:11:47.754961 [info ] [MainThread]: python version: 3.9.6
[0m17:11:47.755098 [info ] [MainThread]: python path: /Library/Developer/CommandLineTools/usr/bin/python3
[0m17:11:47.755228 [info ] [MainThread]: os info: macOS-15.7-arm64-arm-64bit
[0m17:11:47.847209 [info ] [MainThread]: Using profiles dir at /Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics
[0m17:11:47.847446 [info ] [MainThread]: Using profiles.yml file at /Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics/profiles.yml
[0m17:11:47.847597 [info ] [MainThread]: Using dbt_project.yml file at /Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics/dbt_project.yml
[0m17:11:47.848497 [info ] [MainThread]: adapter type: duckdb
[0m17:11:47.848675 [info ] [MainThread]: adapter version: 1.10.0
[0m17:11:47.890803 [info ] [MainThread]: Configuration:
[0m17:11:47.891067 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:11:47.891205 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:11:47.891345 [info ] [MainThread]: Required dependencies:
[0m17:11:47.891541 [debug] [MainThread]: Executing "git --help"
[0m17:11:47.903382 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:11:47.903838 [debug] [MainThread]: STDERR: "b''"
[0m17:11:47.904057 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:11:47.904221 [info ] [MainThread]: Connection:
[0m17:11:47.904400 [info ] [MainThread]:   database: logistics
[0m17:11:47.904526 [info ] [MainThread]:   schema: main
[0m17:11:47.904649 [info ] [MainThread]:   path: logistics.duckdb
[0m17:11:47.904771 [info ] [MainThread]:   config_options: None
[0m17:11:47.904890 [info ] [MainThread]:   extensions: None
[0m17:11:47.905015 [info ] [MainThread]:   settings: {}
[0m17:11:47.905134 [info ] [MainThread]:   external_root: .
[0m17:11:47.905256 [info ] [MainThread]:   use_credential_provider: None
[0m17:11:47.905374 [info ] [MainThread]:   attach: None
[0m17:11:47.905493 [info ] [MainThread]:   filesystems: None
[0m17:11:47.905610 [info ] [MainThread]:   remote: None
[0m17:11:47.905728 [info ] [MainThread]:   plugins: None
[0m17:11:47.905848 [info ] [MainThread]:   disable_transactions: False
[0m17:11:47.906159 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:11:47.956527 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m17:11:47.989537 [debug] [MainThread]: Using duckdb connection "debug"
[0m17:11:47.989734 [debug] [MainThread]: On debug: select 1 as id
[0m17:11:47.989862 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:11:47.998903 [debug] [MainThread]: SQL status: OK in 0.009 seconds
[0m17:11:47.999306 [debug] [MainThread]: On debug: Close
[0m17:11:47.999478 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:11:47.999629 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:11:48.000637 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.29012287, "process_in_blocks": "0", "process_kernel_time": 0.127143, "process_mem_max_rss": "126746624", "process_out_blocks": "0", "process_user_time": 0.680337}
[0m17:11:48.000824 [debug] [MainThread]: Command `dbt debug` succeeded at 17:11:48.000783 after 0.29 seconds
[0m17:11:48.000960 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:11:48.001104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f123a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f22a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105178c40>]}
[0m17:11:48.001278 [debug] [MainThread]: Flushing usage events
[0m17:11:49.409366 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:13:00.292423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a8f370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d00790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d005b0>]}


============================== 17:13:00.294295 | 8d3907b5-a375-4f2a-bc62-3c23f9b74fb3 ==============================
[0m17:13:00.294295 [info ] [MainThread]: Running with dbt=1.10.17
[0m17:13:00.294613 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'introspect': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'no_print': 'None', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run', 'write_json': 'True', 'empty': 'False', 'quiet': 'False', 'debug': 'False', 'log_path': '/Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics/logs', 'indirect_selection': 'eager', 'target_path': 'None', 'log_format': 'default', 'printer_width': '80', 'log_cache_events': 'False', 'static_parser': 'True', 'version_check': 'True'}
[0m17:13:00.436910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d3907b5-a375-4f2a-bc62-3c23f9b74fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ddd160>]}
[0m17:13:00.462606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d3907b5-a375-4f2a-bc62-3c23f9b74fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111104940>]}
[0m17:13:00.463855 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:13:00.515236 [debug] [MainThread]: checksum: a50d730a31f4c1af850aa8110f398f1e1657a0325ec5753dae2929b817189a3e, vars: {}, profile: , target: , version: 1.10.17
[0m17:13:00.515591 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:13:00.515772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8d3907b5-a375-4f2a-bc62-3c23f9b74fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112da130>]}
[0m17:13:01.004230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d3907b5-a375-4f2a-bc62-3c23f9b74fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11280d130>]}
[0m17:13:01.034404 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics/target/manifest.json
[0m17:13:01.035444 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics/target/semantic_manifest.json
[0m17:13:01.045722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d3907b5-a375-4f2a-bc62-3c23f9b74fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111698670>]}
[0m17:13:01.045967 [info ] [MainThread]: Found 3 models, 456 macros
[0m17:13:01.046126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d3907b5-a375-4f2a-bc62-3c23f9b74fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063e4430>]}
[0m17:13:01.046713 [info ] [MainThread]: 
[0m17:13:01.046870 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:13:01.047003 [info ] [MainThread]: 
[0m17:13:01.047228 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:13:01.049437 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_logistics'
[0m17:13:01.073474 [debug] [ThreadPool]: Using duckdb connection "list_logistics"
[0m17:13:01.073661 [debug] [ThreadPool]: On list_logistics: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "list_logistics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"logistics"'
    
  
  
[0m17:13:01.073782 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:13:01.082199 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:13:01.082783 [debug] [ThreadPool]: On list_logistics: Close
[0m17:13:01.083074 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_logistics, now create_logistics_main)
[0m17:13:01.083265 [debug] [ThreadPool]: Creating schema "database: "logistics"
schema: "main"
"
[0m17:13:01.086186 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m17:13:01.086322 [debug] [ThreadPool]: On create_logistics_main: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "create_logistics_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='logistics'
        and type='sqlite'
    
  
[0m17:13:01.086439 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:13:01.086963 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:13:01.087481 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m17:13:01.087603 [debug] [ThreadPool]: On create_logistics_main: BEGIN
[0m17:13:01.087786 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:13:01.087911 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m17:13:01.088035 [debug] [ThreadPool]: On create_logistics_main: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "create_logistics_main"} */

    
    
        create schema if not exists "logistics"."main"
    
[0m17:13:01.088272 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:13:01.088602 [debug] [ThreadPool]: On create_logistics_main: COMMIT
[0m17:13:01.088721 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m17:13:01.088830 [debug] [ThreadPool]: On create_logistics_main: COMMIT
[0m17:13:01.088998 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:13:01.089122 [debug] [ThreadPool]: On create_logistics_main: Close
[0m17:13:01.089590 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_logistics_main, now list_logistics_main)
[0m17:13:01.091872 [debug] [ThreadPool]: Using duckdb connection "list_logistics_main"
[0m17:13:01.091999 [debug] [ThreadPool]: On list_logistics_main: BEGIN
[0m17:13:01.092106 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:13:01.092296 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:13:01.092420 [debug] [ThreadPool]: Using duckdb connection "list_logistics_main"
[0m17:13:01.092548 [debug] [ThreadPool]: On list_logistics_main: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "list_logistics_main"} */
select
      'logistics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'logistics'
  
[0m17:13:01.098597 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m17:13:01.099266 [debug] [ThreadPool]: On list_logistics_main: ROLLBACK
[0m17:13:01.100218 [debug] [ThreadPool]: Failed to rollback 'list_logistics_main'
[0m17:13:01.100349 [debug] [ThreadPool]: On list_logistics_main: Close
[0m17:13:01.100579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d3907b5-a375-4f2a-bc62-3c23f9b74fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128fc130>]}
[0m17:13:01.100774 [debug] [MainThread]: Using duckdb connection "master"
[0m17:13:01.100889 [debug] [MainThread]: On master: BEGIN
[0m17:13:01.100993 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:13:01.101204 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:13:01.101340 [debug] [MainThread]: On master: COMMIT
[0m17:13:01.101464 [debug] [MainThread]: Using duckdb connection "master"
[0m17:13:01.101581 [debug] [MainThread]: On master: COMMIT
[0m17:13:01.101771 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:13:01.101928 [debug] [MainThread]: On master: Close
[0m17:13:01.103705 [debug] [Thread-1  ]: Began running node model.logistics_analytics.stg_shipments
[0m17:13:01.103912 [info ] [Thread-1  ]: 1 of 3 START sql view model main.stg_shipments ................................. [RUN]
[0m17:13:01.104103 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_logistics_main, now model.logistics_analytics.stg_shipments)
[0m17:13:01.104255 [debug] [Thread-1  ]: Began compiling node model.logistics_analytics.stg_shipments
[0m17:13:01.107715 [debug] [Thread-1  ]: Writing injected SQL for node "model.logistics_analytics.stg_shipments"
[0m17:13:01.108123 [debug] [Thread-1  ]: Began executing node model.logistics_analytics.stg_shipments
[0m17:13:01.121386 [debug] [Thread-1  ]: Writing runtime sql for node "model.logistics_analytics.stg_shipments"
[0m17:13:01.121932 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m17:13:01.122089 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: BEGIN
[0m17:13:01.122225 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:13:01.122529 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:13:01.122683 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m17:13:01.122843 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */

  
  create view "logistics"."main"."stg_shipments__dbt_tmp" as (
    select
    shipment_id,
    order_id,
    carrier,
    origin,
    destination,
    ship_date,
    delivery_date,
    expected_delivery_date,
    status,
    distance_km,
    datediff('day', ship_date, delivery_date) as delivery_days,
    case
        when delivery_date > expected_delivery_date then 1
        else 0
    end as is_delayed
from read_parquet('../../data/parquet/shipments.parquet')
  );

[0m17:13:01.127134 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */

  
  create view "logistics"."main"."stg_shipments__dbt_tmp" as (
    select
    shipment_id,
    order_id,
    carrier,
    origin,
    destination,
    ship_date,
    delivery_date,
    expected_delivery_date,
    status,
    distance_km,
    datediff('day', ship_date, delivery_date) as delivery_days,
    case
        when delivery_date > expected_delivery_date then 1
        else 0
    end as is_delayed
from read_parquet('../../data/parquet/shipments.parquet')
  );

[0m17:13:01.127287 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m17:13:01.127481 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: ROLLBACK
[0m17:13:01.140543 [debug] [Thread-1  ]: Failed to rollback 'model.logistics_analytics.stg_shipments'
[0m17:13:01.140756 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: Close
[0m17:13:01.143036 [debug] [Thread-1  ]: Runtime Error in model stg_shipments (models/staging/stg_shipments.sql)
  Binder Error: Referenced column "order_id" not found in FROM clause!
  Candidate bindings: "order_date", "delivery_date", "origin", "carrier", "destination"
  
  LINE 7:     order_id,
              ^
[0m17:13:01.144008 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d3907b5-a375-4f2a-bc62-3c23f9b74fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112851f10>]}
[0m17:13:01.144292 [error] [Thread-1  ]: 1 of 3 ERROR creating sql view model main.stg_shipments ........................ [[31mERROR[0m in 0.04s]
[0m17:13:01.144554 [debug] [Thread-1  ]: Finished running node model.logistics_analytics.stg_shipments
[0m17:13:01.144801 [debug] [Thread-4  ]: Marking all children of 'model.logistics_analytics.stg_shipments' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_shipments (models/staging/stg_shipments.sql)
  Binder Error: Referenced column "order_id" not found in FROM clause!
  Candidate bindings: "order_date", "delivery_date", "origin", "carrier", "destination"
  
  LINE 7:     order_id,
              ^.
[0m17:13:01.145127 [debug] [Thread-1  ]: Began running node model.logistics_analytics.carrier_performance
[0m17:13:01.145342 [info ] [Thread-1  ]: 2 of 3 SKIP relation main.carrier_performance .................................. [[33mSKIP[0m]
[0m17:13:01.145556 [debug] [Thread-1  ]: Finished running node model.logistics_analytics.carrier_performance
[0m17:13:01.145729 [debug] [Thread-1  ]: Began running node model.logistics_analytics.delivery_metrics
[0m17:13:01.145905 [info ] [Thread-1  ]: 3 of 3 SKIP relation main.delivery_metrics ..................................... [[33mSKIP[0m]
[0m17:13:01.146073 [debug] [Thread-1  ]: Finished running node model.logistics_analytics.delivery_metrics
[0m17:13:01.146506 [debug] [MainThread]: Using duckdb connection "master"
[0m17:13:01.146673 [debug] [MainThread]: On master: BEGIN
[0m17:13:01.146800 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:13:01.147071 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:13:01.147205 [debug] [MainThread]: On master: COMMIT
[0m17:13:01.147338 [debug] [MainThread]: Using duckdb connection "master"
[0m17:13:01.147458 [debug] [MainThread]: On master: COMMIT
[0m17:13:01.147636 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:13:01.147765 [debug] [MainThread]: On master: Close
[0m17:13:01.147933 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:13:01.148057 [debug] [MainThread]: Connection 'model.logistics_analytics.stg_shipments' was properly closed.
[0m17:13:01.148218 [info ] [MainThread]: 
[0m17:13:01.148367 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m17:13:01.148683 [debug] [MainThread]: Command end result
[0m17:13:01.159068 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics/target/manifest.json
[0m17:13:01.159846 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics/target/semantic_manifest.json
[0m17:13:01.162646 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics/target/run_results.json
[0m17:13:01.162775 [info ] [MainThread]: 
[0m17:13:01.162939 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:13:01.163079 [info ] [MainThread]: 
[0m17:13:01.163250 [error] [MainThread]: [31mFailure in model stg_shipments (models/staging/stg_shipments.sql)[0m
[0m17:13:01.163411 [error] [MainThread]:   Runtime Error in model stg_shipments (models/staging/stg_shipments.sql)
  Binder Error: Referenced column "order_id" not found in FROM clause!
  Candidate bindings: "order_date", "delivery_date", "origin", "carrier", "destination"
  
  LINE 7:     order_id,
              ^
[0m17:13:01.163540 [info ] [MainThread]: 
[0m17:13:01.163688 [info ] [MainThread]:   compiled code at target/compiled/logistics_analytics/models/staging/stg_shipments.sql
[0m17:13:01.163817 [info ] [MainThread]: 
[0m17:13:01.163961 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=3
[0m17:13:01.164996 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9045744, "process_in_blocks": "0", "process_kernel_time": 0.141143, "process_mem_max_rss": "142622720", "process_out_blocks": "0", "process_user_time": 1.288974}
[0m17:13:01.165227 [debug] [MainThread]: Command `dbt run` failed at 17:13:01.165176 after 0.90 seconds
[0m17:13:01.165450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a8f370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110dee7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111104940>]}
[0m17:13:01.165633 [debug] [MainThread]: Flushing usage events
[0m17:13:02.844305 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:14:55.923728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035e23a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046547c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046545e0>]}


============================== 17:14:55.925648 | a7b29592-2f6e-4491-93df-1b96cbc6f7a3 ==============================
[0m17:14:55.925648 [info ] [MainThread]: Running with dbt=1.10.17
[0m17:14:55.925951 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt run', 'printer_width': '80', 'fail_fast': 'False', 'quiet': 'False', 'write_json': 'True', 'log_path': '/Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics/logs', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'profiles_dir': '/Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics', 'partial_parse': 'True', 'debug': 'False', 'version_check': 'True', 'no_print': 'None', 'target_path': 'None', 'empty': 'False', 'indirect_selection': 'eager'}
[0m17:14:56.079512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7b29592-2f6e-4491-93df-1b96cbc6f7a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104762220>]}
[0m17:14:56.104496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7b29592-2f6e-4491-93df-1b96cbc6f7a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104741b20>]}
[0m17:14:56.105626 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:14:56.156560 [debug] [MainThread]: checksum: a50d730a31f4c1af850aa8110f398f1e1657a0325ec5753dae2929b817189a3e, vars: {}, profile: , target: , version: 1.10.17
[0m17:14:56.209128 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
[0m17:14:56.209325 [debug] [MainThread]: Partial parsing: deleted file: logistics_analytics://models/marts/delivery_metrics.sql
[0m17:14:56.209503 [debug] [MainThread]: Partial parsing: updated file: logistics_analytics://models/staging/stg_shipments.sql
[0m17:14:56.326831 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.logistics_analytics.marts
[0m17:14:56.329119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7b29592-2f6e-4491-93df-1b96cbc6f7a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10462bc40>]}
[0m17:14:56.358427 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics/target/manifest.json
[0m17:14:56.359320 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics/target/semantic_manifest.json
[0m17:14:56.368783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7b29592-2f6e-4491-93df-1b96cbc6f7a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104605f40>]}
[0m17:14:56.369003 [info ] [MainThread]: Found 2 models, 456 macros
[0m17:14:56.369154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7b29592-2f6e-4491-93df-1b96cbc6f7a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104778b50>]}
[0m17:14:56.369692 [info ] [MainThread]: 
[0m17:14:56.369845 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:14:56.369975 [info ] [MainThread]: 
[0m17:14:56.370196 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:14:56.372424 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_logistics'
[0m17:14:56.396656 [debug] [ThreadPool]: Using duckdb connection "list_logistics"
[0m17:14:56.396874 [debug] [ThreadPool]: On list_logistics: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "list_logistics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"logistics"'
    
  
  
[0m17:14:56.397109 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:56.406977 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m17:14:56.407648 [debug] [ThreadPool]: On list_logistics: Close
[0m17:14:56.407951 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_logistics, now create_logistics_main)
[0m17:14:56.408140 [debug] [ThreadPool]: Creating schema "database: "logistics"
schema: "main"
"
[0m17:14:56.411125 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m17:14:56.411265 [debug] [ThreadPool]: On create_logistics_main: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "create_logistics_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='logistics'
        and type='sqlite'
    
  
[0m17:14:56.411383 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:14:56.411911 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:14:56.412576 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m17:14:56.412700 [debug] [ThreadPool]: On create_logistics_main: BEGIN
[0m17:14:56.412881 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:14:56.413005 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m17:14:56.413133 [debug] [ThreadPool]: On create_logistics_main: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "create_logistics_main"} */

    
    
        create schema if not exists "logistics"."main"
    
[0m17:14:56.413633 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:14:56.414034 [debug] [ThreadPool]: On create_logistics_main: COMMIT
[0m17:14:56.414192 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m17:14:56.414321 [debug] [ThreadPool]: On create_logistics_main: COMMIT
[0m17:14:56.414533 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:14:56.414677 [debug] [ThreadPool]: On create_logistics_main: Close
[0m17:14:56.415150 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_logistics_main, now list_logistics_main)
[0m17:14:56.417504 [debug] [ThreadPool]: Using duckdb connection "list_logistics_main"
[0m17:14:56.417633 [debug] [ThreadPool]: On list_logistics_main: BEGIN
[0m17:14:56.417741 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:14:56.417938 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:14:56.418059 [debug] [ThreadPool]: Using duckdb connection "list_logistics_main"
[0m17:14:56.418189 [debug] [ThreadPool]: On list_logistics_main: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "list_logistics_main"} */
select
      'logistics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'logistics'
  
[0m17:14:56.424713 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m17:14:56.425350 [debug] [ThreadPool]: On list_logistics_main: ROLLBACK
[0m17:14:56.426281 [debug] [ThreadPool]: Failed to rollback 'list_logistics_main'
[0m17:14:56.426403 [debug] [ThreadPool]: On list_logistics_main: Close
[0m17:14:56.426633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7b29592-2f6e-4491-93df-1b96cbc6f7a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10460fee0>]}
[0m17:14:56.426875 [debug] [MainThread]: Using duckdb connection "master"
[0m17:14:56.427047 [debug] [MainThread]: On master: BEGIN
[0m17:14:56.427180 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:14:56.427415 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:14:56.427549 [debug] [MainThread]: On master: COMMIT
[0m17:14:56.427679 [debug] [MainThread]: Using duckdb connection "master"
[0m17:14:56.427802 [debug] [MainThread]: On master: COMMIT
[0m17:14:56.427981 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:14:56.428113 [debug] [MainThread]: On master: Close
[0m17:14:56.429045 [debug] [Thread-1  ]: Began running node model.logistics_analytics.stg_shipments
[0m17:14:56.429272 [info ] [Thread-1  ]: 1 of 2 START sql view model main.stg_shipments ................................. [RUN]
[0m17:14:56.429477 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_logistics_main, now model.logistics_analytics.stg_shipments)
[0m17:14:56.429631 [debug] [Thread-1  ]: Began compiling node model.logistics_analytics.stg_shipments
[0m17:14:56.432854 [debug] [Thread-1  ]: Writing injected SQL for node "model.logistics_analytics.stg_shipments"
[0m17:14:56.433162 [debug] [Thread-1  ]: Began executing node model.logistics_analytics.stg_shipments
[0m17:14:56.451376 [debug] [Thread-1  ]: Writing runtime sql for node "model.logistics_analytics.stg_shipments"
[0m17:14:56.451899 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m17:14:56.452087 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: BEGIN
[0m17:14:56.452245 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:14:56.452589 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:14:56.452752 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m17:14:56.452913 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */

  
  create view "logistics"."main"."stg_shipments__dbt_tmp" as (
    select
  shipment_id,
  carrier,
  origin,
  destination,
  distance_km,
  date(order_date) as order_date,
  date(delivery_date) as delivery_date,
  date(expected_delivery_date) as expected_delivery_date,
  date_diff('day', order_date, delivery_date) as delivery_time_days,
  case when delivery_date > expected_delivery_date then 1 else 0 end as is_delayed
from read_parquet('../../data/parquet/shipments.parquet')
  );

[0m17:14:56.459588 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */

  
  create view "logistics"."main"."stg_shipments__dbt_tmp" as (
    select
  shipment_id,
  carrier,
  origin,
  destination,
  distance_km,
  date(order_date) as order_date,
  date(delivery_date) as delivery_date,
  date(expected_delivery_date) as expected_delivery_date,
  date_diff('day', order_date, delivery_date) as delivery_time_days,
  case when delivery_date > expected_delivery_date then 1 else 0 end as is_delayed
from read_parquet('../../data/parquet/shipments.parquet')
  );

[0m17:14:56.459842 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m17:14:56.460092 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: ROLLBACK
[0m17:14:56.472031 [debug] [Thread-1  ]: Failed to rollback 'model.logistics_analytics.stg_shipments'
[0m17:14:56.472194 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: Close
[0m17:14:56.474383 [debug] [Thread-1  ]: Runtime Error in model stg_shipments (models/staging/stg_shipments.sql)
  Binder Error: No function matches the given name and argument types 'date_diff(STRING_LITERAL, VARCHAR, VARCHAR)'. You might need to add explicit type casts.
  	Candidate functions:
  	date_diff(VARCHAR, DATE, DATE) -> BIGINT
  	date_diff(VARCHAR, TIME, TIME) -> BIGINT
  	date_diff(VARCHAR, TIMESTAMP, TIMESTAMP) -> BIGINT
  	date_diff(VARCHAR, TIMESTAMP WITH TIME ZONE, TIMESTAMP WITH TIME ZONE) -> BIGINT
  
  
  LINE 14:   date_diff('day', order_date, delivery_date) as delivery_tim...
             ^
[0m17:14:56.475428 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7b29592-2f6e-4491-93df-1b96cbc6f7a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030887f0>]}
[0m17:14:56.475733 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model main.stg_shipments ........................ [[31mERROR[0m in 0.05s]
[0m17:14:56.476004 [debug] [Thread-1  ]: Finished running node model.logistics_analytics.stg_shipments
[0m17:14:56.476269 [debug] [Thread-4  ]: Marking all children of 'model.logistics_analytics.stg_shipments' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_shipments (models/staging/stg_shipments.sql)
  Binder Error: No function matches the given name and argument types 'date_diff(STRING_LITERAL, VARCHAR, VARCHAR)'. You might need to add explicit type casts.
  	Candidate functions:
  	date_diff(VARCHAR, DATE, DATE) -> BIGINT
  	date_diff(VARCHAR, TIME, TIME) -> BIGINT
  	date_diff(VARCHAR, TIMESTAMP, TIMESTAMP) -> BIGINT
  	date_diff(VARCHAR, TIMESTAMP WITH TIME ZONE, TIMESTAMP WITH TIME ZONE) -> BIGINT
  
  
  LINE 14:   date_diff('day', order_date, delivery_date) as delivery_tim...
             ^.
[0m17:14:56.476644 [debug] [Thread-1  ]: Began running node model.logistics_analytics.carrier_performance
[0m17:14:56.476848 [info ] [Thread-1  ]: 2 of 2 SKIP relation main.carrier_performance .................................. [[33mSKIP[0m]
[0m17:14:56.477034 [debug] [Thread-1  ]: Finished running node model.logistics_analytics.carrier_performance
[0m17:14:56.477448 [debug] [MainThread]: Using duckdb connection "master"
[0m17:14:56.477622 [debug] [MainThread]: On master: BEGIN
[0m17:14:56.477752 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:14:56.478043 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:14:56.478180 [debug] [MainThread]: On master: COMMIT
[0m17:14:56.478309 [debug] [MainThread]: Using duckdb connection "master"
[0m17:14:56.478429 [debug] [MainThread]: On master: COMMIT
[0m17:14:56.478608 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:14:56.478738 [debug] [MainThread]: On master: Close
[0m17:14:56.478910 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:14:56.479028 [debug] [MainThread]: Connection 'model.logistics_analytics.stg_shipments' was properly closed.
[0m17:14:56.479174 [info ] [MainThread]: 
[0m17:14:56.479320 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m17:14:56.479630 [debug] [MainThread]: Command end result
[0m17:14:56.489415 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics/target/manifest.json
[0m17:14:56.490134 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics/target/semantic_manifest.json
[0m17:14:56.492911 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics/target/run_results.json
[0m17:14:56.493040 [info ] [MainThread]: 
[0m17:14:56.493208 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:14:56.493352 [info ] [MainThread]: 
[0m17:14:56.493524 [error] [MainThread]: [31mFailure in model stg_shipments (models/staging/stg_shipments.sql)[0m
[0m17:14:56.493697 [error] [MainThread]:   Runtime Error in model stg_shipments (models/staging/stg_shipments.sql)
  Binder Error: No function matches the given name and argument types 'date_diff(STRING_LITERAL, VARCHAR, VARCHAR)'. You might need to add explicit type casts.
  	Candidate functions:
  	date_diff(VARCHAR, DATE, DATE) -> BIGINT
  	date_diff(VARCHAR, TIME, TIME) -> BIGINT
  	date_diff(VARCHAR, TIMESTAMP, TIMESTAMP) -> BIGINT
  	date_diff(VARCHAR, TIMESTAMP WITH TIME ZONE, TIMESTAMP WITH TIME ZONE) -> BIGINT
  
  
  LINE 14:   date_diff('day', order_date, delivery_date) as delivery_tim...
             ^
[0m17:14:56.493841 [info ] [MainThread]: 
[0m17:14:56.493996 [info ] [MainThread]:   compiled code at target/compiled/logistics_analytics/models/staging/stg_shipments.sql
[0m17:14:56.494128 [info ] [MainThread]: 
[0m17:14:56.494276 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m17:14:56.495304 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.60344285, "process_in_blocks": "0", "process_kernel_time": 0.143263, "process_mem_max_rss": "140984320", "process_out_blocks": "0", "process_user_time": 0.97331}
[0m17:14:56.495493 [debug] [MainThread]: Command `dbt run` failed at 17:14:56.495454 after 0.60 seconds
[0m17:14:56.495667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035e23a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045c9400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045c90d0>]}
[0m17:14:56.495841 [debug] [MainThread]: Flushing usage events
[0m17:15:00.592619 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:15:17.097974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035b3370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104624790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046245b0>]}


============================== 17:15:17.099921 | 95f1196b-8e0e-4c2d-90be-58a6db9f1349 ==============================
[0m17:15:17.099921 [info ] [MainThread]: Running with dbt=1.10.17
[0m17:15:17.100229 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': '/Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics/logs', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False', 'invocation_command': 'dbt run', 'profiles_dir': '/Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'write_json': 'True', 'empty': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'warn_error': 'None', 'no_print': 'None', 'printer_width': '80', 'quiet': 'False'}
[0m17:15:17.235267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95f1196b-8e0e-4c2d-90be-58a6db9f1349', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10481e160>]}
[0m17:15:17.259412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95f1196b-8e0e-4c2d-90be-58a6db9f1349', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104844940>]}
[0m17:15:17.260751 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:15:17.314061 [debug] [MainThread]: checksum: a50d730a31f4c1af850aa8110f398f1e1657a0325ec5753dae2929b817189a3e, vars: {}, profile: , target: , version: 1.10.17
[0m17:15:17.364367 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:15:17.364656 [debug] [MainThread]: Partial parsing: updated file: logistics_analytics://models/staging/stg_shipments.sql
[0m17:15:17.481371 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.logistics_analytics.marts
[0m17:15:17.483721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95f1196b-8e0e-4c2d-90be-58a6db9f1349', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048816a0>]}
[0m17:15:17.512148 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics/target/manifest.json
[0m17:15:17.513174 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics/target/semantic_manifest.json
[0m17:15:17.522675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95f1196b-8e0e-4c2d-90be-58a6db9f1349', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104599cd0>]}
[0m17:15:17.522898 [info ] [MainThread]: Found 2 models, 456 macros
[0m17:15:17.523053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95f1196b-8e0e-4c2d-90be-58a6db9f1349', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10486d6a0>]}
[0m17:15:17.523633 [info ] [MainThread]: 
[0m17:15:17.523801 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:15:17.523937 [info ] [MainThread]: 
[0m17:15:17.524159 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:15:17.526414 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_logistics'
[0m17:15:17.550478 [debug] [ThreadPool]: Using duckdb connection "list_logistics"
[0m17:15:17.550671 [debug] [ThreadPool]: On list_logistics: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "list_logistics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"logistics"'
    
  
  
[0m17:15:17.550800 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:15:17.559544 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m17:15:17.560122 [debug] [ThreadPool]: On list_logistics: Close
[0m17:15:17.560410 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_logistics, now create_logistics_main)
[0m17:15:17.560595 [debug] [ThreadPool]: Creating schema "database: "logistics"
schema: "main"
"
[0m17:15:17.563462 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m17:15:17.563594 [debug] [ThreadPool]: On create_logistics_main: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "create_logistics_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='logistics'
        and type='sqlite'
    
  
[0m17:15:17.563710 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:15:17.564249 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:15:17.564872 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m17:15:17.564995 [debug] [ThreadPool]: On create_logistics_main: BEGIN
[0m17:15:17.565242 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:15:17.565406 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m17:15:17.565539 [debug] [ThreadPool]: On create_logistics_main: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "create_logistics_main"} */

    
    
        create schema if not exists "logistics"."main"
    
[0m17:15:17.568059 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:15:17.568372 [debug] [ThreadPool]: On create_logistics_main: COMMIT
[0m17:15:17.568491 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m17:15:17.568617 [debug] [ThreadPool]: On create_logistics_main: COMMIT
[0m17:15:17.568795 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:15:17.568923 [debug] [ThreadPool]: On create_logistics_main: Close
[0m17:15:17.569357 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_logistics_main, now list_logistics_main)
[0m17:15:17.571614 [debug] [ThreadPool]: Using duckdb connection "list_logistics_main"
[0m17:15:17.571733 [debug] [ThreadPool]: On list_logistics_main: BEGIN
[0m17:15:17.571839 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:15:17.572020 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:15:17.572142 [debug] [ThreadPool]: Using duckdb connection "list_logistics_main"
[0m17:15:17.572268 [debug] [ThreadPool]: On list_logistics_main: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "list_logistics_main"} */
select
      'logistics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'logistics'
  
[0m17:15:17.578060 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m17:15:17.578706 [debug] [ThreadPool]: On list_logistics_main: ROLLBACK
[0m17:15:17.579614 [debug] [ThreadPool]: Failed to rollback 'list_logistics_main'
[0m17:15:17.579735 [debug] [ThreadPool]: On list_logistics_main: Close
[0m17:15:17.579956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95f1196b-8e0e-4c2d-90be-58a6db9f1349', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102021bb0>]}
[0m17:15:17.580140 [debug] [MainThread]: Using duckdb connection "master"
[0m17:15:17.580257 [debug] [MainThread]: On master: BEGIN
[0m17:15:17.580366 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:15:17.580567 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:15:17.580695 [debug] [MainThread]: On master: COMMIT
[0m17:15:17.580820 [debug] [MainThread]: Using duckdb connection "master"
[0m17:15:17.580937 [debug] [MainThread]: On master: COMMIT
[0m17:15:17.581107 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:15:17.581235 [debug] [MainThread]: On master: Close
[0m17:15:17.582213 [debug] [Thread-1  ]: Began running node model.logistics_analytics.stg_shipments
[0m17:15:17.582436 [info ] [Thread-1  ]: 1 of 2 START sql view model main.stg_shipments ................................. [RUN]
[0m17:15:17.582623 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_logistics_main, now model.logistics_analytics.stg_shipments)
[0m17:15:17.582777 [debug] [Thread-1  ]: Began compiling node model.logistics_analytics.stg_shipments
[0m17:15:17.585837 [debug] [Thread-1  ]: Writing injected SQL for node "model.logistics_analytics.stg_shipments"
[0m17:15:17.586102 [debug] [Thread-1  ]: Began executing node model.logistics_analytics.stg_shipments
[0m17:15:17.598560 [debug] [Thread-1  ]: Writing runtime sql for node "model.logistics_analytics.stg_shipments"
[0m17:15:17.598925 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m17:15:17.599095 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: BEGIN
[0m17:15:17.599359 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:15:17.599703 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:15:17.599863 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m17:15:17.600020 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */

  
  create view "logistics"."main"."stg_shipments__dbt_tmp" as (
    select
    shipment_id,
    carrier,
    origin,
    destination,
    order_date,
    delivery_date,
    expected_delivery_date,
    distance_km,

    datediff('day', order_date, delivery_date) as delivery_days,

    case
        when delivery_date > expected_delivery_date then 1
        else 0
    end as is_delayed

from read_parquet('../../data/parquet/shipments.parquet')
  );

[0m17:15:17.604334 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */

  
  create view "logistics"."main"."stg_shipments__dbt_tmp" as (
    select
    shipment_id,
    carrier,
    origin,
    destination,
    order_date,
    delivery_date,
    expected_delivery_date,
    distance_km,

    datediff('day', order_date, delivery_date) as delivery_days,

    case
        when delivery_date > expected_delivery_date then 1
        else 0
    end as is_delayed

from read_parquet('../../data/parquet/shipments.parquet')
  );

[0m17:15:17.604486 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m17:15:17.604670 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: ROLLBACK
[0m17:15:17.616195 [debug] [Thread-1  ]: Failed to rollback 'model.logistics_analytics.stg_shipments'
[0m17:15:17.616345 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: Close
[0m17:15:17.618639 [debug] [Thread-1  ]: Runtime Error in model stg_shipments (models/staging/stg_shipments.sql)
  Binder Error: No function matches the given name and argument types 'datediff(STRING_LITERAL, VARCHAR, VARCHAR)'. You might need to add explicit type casts.
  	Candidate functions:
  	datediff(VARCHAR, DATE, DATE) -> BIGINT
  	datediff(VARCHAR, TIME, TIME) -> BIGINT
  	datediff(VARCHAR, TIMESTAMP, TIMESTAMP) -> BIGINT
  	datediff(VARCHAR, TIMESTAMP WITH TIME ZONE, TIMESTAMP WITH TIME ZONE) -> BIGINT
  
  
  LINE 15:     datediff('day', order_date, delivery_date) as delivery_days...
               ^
[0m17:15:17.619546 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95f1196b-8e0e-4c2d-90be-58a6db9f1349', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057a26a0>]}
[0m17:15:17.619845 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model main.stg_shipments ........................ [[31mERROR[0m in 0.04s]
[0m17:15:17.620125 [debug] [Thread-1  ]: Finished running node model.logistics_analytics.stg_shipments
[0m17:15:17.620364 [debug] [Thread-4  ]: Marking all children of 'model.logistics_analytics.stg_shipments' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_shipments (models/staging/stg_shipments.sql)
  Binder Error: No function matches the given name and argument types 'datediff(STRING_LITERAL, VARCHAR, VARCHAR)'. You might need to add explicit type casts.
  	Candidate functions:
  	datediff(VARCHAR, DATE, DATE) -> BIGINT
  	datediff(VARCHAR, TIME, TIME) -> BIGINT
  	datediff(VARCHAR, TIMESTAMP, TIMESTAMP) -> BIGINT
  	datediff(VARCHAR, TIMESTAMP WITH TIME ZONE, TIMESTAMP WITH TIME ZONE) -> BIGINT
  
  
  LINE 15:     datediff('day', order_date, delivery_date) as delivery_days...
               ^.
[0m17:15:17.620712 [debug] [Thread-1  ]: Began running node model.logistics_analytics.carrier_performance
[0m17:15:17.620928 [info ] [Thread-1  ]: 2 of 2 SKIP relation main.carrier_performance .................................. [[33mSKIP[0m]
[0m17:15:17.621126 [debug] [Thread-1  ]: Finished running node model.logistics_analytics.carrier_performance
[0m17:15:17.621554 [debug] [MainThread]: Using duckdb connection "master"
[0m17:15:17.621716 [debug] [MainThread]: On master: BEGIN
[0m17:15:17.621832 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:15:17.622074 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:15:17.622206 [debug] [MainThread]: On master: COMMIT
[0m17:15:17.622330 [debug] [MainThread]: Using duckdb connection "master"
[0m17:15:17.622439 [debug] [MainThread]: On master: COMMIT
[0m17:15:17.622617 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:15:17.622746 [debug] [MainThread]: On master: Close
[0m17:15:17.622909 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:15:17.623020 [debug] [MainThread]: Connection 'model.logistics_analytics.stg_shipments' was properly closed.
[0m17:15:17.623163 [info ] [MainThread]: 
[0m17:15:17.623310 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m17:15:17.623620 [debug] [MainThread]: Command end result
[0m17:15:17.633580 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics/target/manifest.json
[0m17:15:17.634344 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics/target/semantic_manifest.json
[0m17:15:17.637052 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics/target/run_results.json
[0m17:15:17.637180 [info ] [MainThread]: 
[0m17:15:17.637337 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:15:17.637482 [info ] [MainThread]: 
[0m17:15:17.637654 [error] [MainThread]: [31mFailure in model stg_shipments (models/staging/stg_shipments.sql)[0m
[0m17:15:17.637825 [error] [MainThread]:   Runtime Error in model stg_shipments (models/staging/stg_shipments.sql)
  Binder Error: No function matches the given name and argument types 'datediff(STRING_LITERAL, VARCHAR, VARCHAR)'. You might need to add explicit type casts.
  	Candidate functions:
  	datediff(VARCHAR, DATE, DATE) -> BIGINT
  	datediff(VARCHAR, TIME, TIME) -> BIGINT
  	datediff(VARCHAR, TIMESTAMP, TIMESTAMP) -> BIGINT
  	datediff(VARCHAR, TIMESTAMP WITH TIME ZONE, TIMESTAMP WITH TIME ZONE) -> BIGINT
  
  
  LINE 15:     datediff('day', order_date, delivery_date) as delivery_days...
               ^
[0m17:15:17.637964 [info ] [MainThread]: 
[0m17:15:17.638118 [info ] [MainThread]:   compiled code at target/compiled/logistics_analytics/models/staging/stg_shipments.sql
[0m17:15:17.638250 [info ] [MainThread]: 
[0m17:15:17.638394 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m17:15:17.639394 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.57194567, "process_in_blocks": "0", "process_kernel_time": 0.135378, "process_mem_max_rss": "139264000", "process_out_blocks": "0", "process_user_time": 0.96386}
[0m17:15:17.639577 [debug] [MainThread]: Command `dbt run` failed at 17:15:17.639539 after 0.57 seconds
[0m17:15:17.639741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035b3370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104938670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104938490>]}
[0m17:15:17.639896 [debug] [MainThread]: Flushing usage events
[0m17:15:19.229837 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:17:30.809618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10481e340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bc0790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bc05b0>]}


============================== 17:17:30.811491 | d6d47ba8-c6de-410a-9972-986f7a0b2906 ==============================
[0m17:17:30.811491 [info ] [MainThread]: Running with dbt=1.10.17
[0m17:17:30.811791 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics', 'no_print': 'None', 'log_path': '/Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics/logs', 'log_format': 'default', 'version_check': 'True', 'log_cache_events': 'False', 'empty': 'False', 'target_path': 'None', 'debug': 'False', 'write_json': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'use_colors': 'True', 'quiet': 'False', 'warn_error': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m17:17:30.980811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6d47ba8-c6de-410a-9972-986f7a0b2906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e01c40>]}
[0m17:17:31.006595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6d47ba8-c6de-410a-9972-986f7a0b2906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c91850>]}
[0m17:17:31.007850 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:17:31.059628 [debug] [MainThread]: checksum: a50d730a31f4c1af850aa8110f398f1e1657a0325ec5753dae2929b817189a3e, vars: {}, profile: , target: , version: 1.10.17
[0m17:17:31.115335 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:17:31.115655 [debug] [MainThread]: Partial parsing: updated file: logistics_analytics://models/staging/stg_shipments.sql
[0m17:17:31.230867 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.logistics_analytics.marts
[0m17:17:31.233154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6d47ba8-c6de-410a-9972-986f7a0b2906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cec610>]}
[0m17:17:31.261985 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics/target/manifest.json
[0m17:17:31.262987 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics/target/semantic_manifest.json
[0m17:17:31.272650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6d47ba8-c6de-410a-9972-986f7a0b2906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b530a0>]}
[0m17:17:31.272870 [info ] [MainThread]: Found 2 models, 456 macros
[0m17:17:31.273042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6d47ba8-c6de-410a-9972-986f7a0b2906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cd9400>]}
[0m17:17:31.273595 [info ] [MainThread]: 
[0m17:17:31.273749 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:17:31.273878 [info ] [MainThread]: 
[0m17:17:31.274095 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:17:31.276309 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_logistics'
[0m17:17:31.300879 [debug] [ThreadPool]: Using duckdb connection "list_logistics"
[0m17:17:31.301071 [debug] [ThreadPool]: On list_logistics: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "list_logistics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"logistics"'
    
  
  
[0m17:17:31.301192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:31.313521 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m17:17:31.314470 [debug] [ThreadPool]: On list_logistics: Close
[0m17:17:31.314752 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_logistics, now create_logistics_main)
[0m17:17:31.314949 [debug] [ThreadPool]: Creating schema "database: "logistics"
schema: "main"
"
[0m17:17:31.317989 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m17:17:31.318120 [debug] [ThreadPool]: On create_logistics_main: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "create_logistics_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='logistics'
        and type='sqlite'
    
  
[0m17:17:31.318236 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:17:31.318786 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:17:31.319379 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m17:17:31.319499 [debug] [ThreadPool]: On create_logistics_main: BEGIN
[0m17:17:31.319681 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:17:31.319803 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m17:17:31.319929 [debug] [ThreadPool]: On create_logistics_main: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "create_logistics_main"} */

    
    
        create schema if not exists "logistics"."main"
    
[0m17:17:31.320563 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:17:31.320871 [debug] [ThreadPool]: On create_logistics_main: COMMIT
[0m17:17:31.320987 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m17:17:31.321098 [debug] [ThreadPool]: On create_logistics_main: COMMIT
[0m17:17:31.321267 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:17:31.321392 [debug] [ThreadPool]: On create_logistics_main: Close
[0m17:17:31.321817 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_logistics_main, now list_logistics_main)
[0m17:17:31.324132 [debug] [ThreadPool]: Using duckdb connection "list_logistics_main"
[0m17:17:31.324254 [debug] [ThreadPool]: On list_logistics_main: BEGIN
[0m17:17:31.324358 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:17:31.324543 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:17:31.324664 [debug] [ThreadPool]: Using duckdb connection "list_logistics_main"
[0m17:17:31.324791 [debug] [ThreadPool]: On list_logistics_main: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "list_logistics_main"} */
select
      'logistics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'logistics'
  
[0m17:17:31.332276 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m17:17:31.332964 [debug] [ThreadPool]: On list_logistics_main: ROLLBACK
[0m17:17:31.333914 [debug] [ThreadPool]: Failed to rollback 'list_logistics_main'
[0m17:17:31.334069 [debug] [ThreadPool]: On list_logistics_main: Close
[0m17:17:31.334425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6d47ba8-c6de-410a-9972-986f7a0b2906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030d5b80>]}
[0m17:17:31.334624 [debug] [MainThread]: Using duckdb connection "master"
[0m17:17:31.334741 [debug] [MainThread]: On master: BEGIN
[0m17:17:31.334847 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:17:31.335065 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:17:31.335191 [debug] [MainThread]: On master: COMMIT
[0m17:17:31.335316 [debug] [MainThread]: Using duckdb connection "master"
[0m17:17:31.335434 [debug] [MainThread]: On master: COMMIT
[0m17:17:31.335633 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:17:31.335811 [debug] [MainThread]: On master: Close
[0m17:17:31.336922 [debug] [Thread-1  ]: Began running node model.logistics_analytics.stg_shipments
[0m17:17:31.337151 [info ] [Thread-1  ]: 1 of 2 START sql view model main.stg_shipments ................................. [RUN]
[0m17:17:31.337344 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_logistics_main, now model.logistics_analytics.stg_shipments)
[0m17:17:31.337500 [debug] [Thread-1  ]: Began compiling node model.logistics_analytics.stg_shipments
[0m17:17:31.340570 [debug] [Thread-1  ]: Writing injected SQL for node "model.logistics_analytics.stg_shipments"
[0m17:17:31.340839 [debug] [Thread-1  ]: Began executing node model.logistics_analytics.stg_shipments
[0m17:17:31.353731 [debug] [Thread-1  ]: Writing runtime sql for node "model.logistics_analytics.stg_shipments"
[0m17:17:31.354117 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m17:17:31.354268 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: BEGIN
[0m17:17:31.354400 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:17:31.354688 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:17:31.354836 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m17:17:31.354994 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */

  
  create view "logistics"."main"."stg_shipments__dbt_tmp" as (
    select
    shipment_id,
    carrier,
    origin,
    destination,

    cast(order_date as date) as order_date,
    cast(delivery_date as date) as delivery_date,
    cast(expected_delivery_date as date) as expected_delivery_date,

    distance_km,

    datediff(
        'day',
        cast(order_date as date),
        cast(delivery_date as date)
    ) as delivery_days,

    case
        when cast(delivery_date as date) > cast(expected_delivery_date as date)
            then 1
        else 0
    end as is_delayed

from read_parquet('../../data/parquet/shipments.parquet')
  );

[0m17:17:31.357200 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m17:17:31.360380 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m17:17:31.360531 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */
alter view "logistics"."main"."stg_shipments__dbt_tmp" rename to "stg_shipments"
[0m17:17:31.361362 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:17:31.365320 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: COMMIT
[0m17:17:31.365490 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m17:17:31.365637 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: COMMIT
[0m17:17:31.366566 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:17:31.368777 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m17:17:31.368935 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */

      drop view if exists "logistics"."main"."stg_shipments__dbt_backup" cascade
    
[0m17:17:31.369435 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:17:31.370439 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: Close
[0m17:17:31.371344 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6d47ba8-c6de-410a-9972-986f7a0b2906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b107f10>]}
[0m17:17:31.371609 [info ] [Thread-1  ]: 1 of 2 OK created sql view model main.stg_shipments ............................ [[32mOK[0m in 0.03s]
[0m17:17:31.371848 [debug] [Thread-1  ]: Finished running node model.logistics_analytics.stg_shipments
[0m17:17:31.372148 [debug] [Thread-1  ]: Began running node model.logistics_analytics.carrier_performance
[0m17:17:31.372415 [info ] [Thread-1  ]: 2 of 2 START sql view model main.carrier_performance ........................... [RUN]
[0m17:17:31.372644 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.logistics_analytics.stg_shipments, now model.logistics_analytics.carrier_performance)
[0m17:17:31.372815 [debug] [Thread-1  ]: Began compiling node model.logistics_analytics.carrier_performance
[0m17:17:31.374037 [debug] [Thread-1  ]: Writing injected SQL for node "model.logistics_analytics.carrier_performance"
[0m17:17:31.374308 [debug] [Thread-1  ]: Began executing node model.logistics_analytics.carrier_performance
[0m17:17:31.375806 [debug] [Thread-1  ]: Writing runtime sql for node "model.logistics_analytics.carrier_performance"
[0m17:17:31.376054 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m17:17:31.376194 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: BEGIN
[0m17:17:31.376324 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:17:31.376566 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:17:31.376714 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m17:17:31.376869 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */

  
  create view "logistics"."main"."carrier_performance__dbt_tmp" as (
    select
  carrier,
  count(*) as total_shipments,
  avg(delivery_time_days) as avg_delivery_time,
  avg(is_delayed) as delay_rate
from "logistics"."main"."stg_shipments"
group by carrier
  );

[0m17:17:31.380145 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */

  
  create view "logistics"."main"."carrier_performance__dbt_tmp" as (
    select
  carrier,
  count(*) as total_shipments,
  avg(delivery_time_days) as avg_delivery_time,
  avg(is_delayed) as delay_rate
from "logistics"."main"."stg_shipments"
group by carrier
  );

[0m17:17:31.380317 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m17:17:31.380501 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: ROLLBACK
[0m17:17:31.393060 [debug] [Thread-1  ]: Failed to rollback 'model.logistics_analytics.carrier_performance'
[0m17:17:31.393229 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: Close
[0m17:17:31.395675 [debug] [Thread-1  ]: Runtime Error in model carrier_performance (models/staging/carrier_performance.sql)
  Binder Error: Referenced column "delivery_time_days" not found in FROM clause!
  Candidate bindings: "delivery_days", "delivery_date", "expected_delivery_date", "order_date", "is_delayed"
  
  LINE 8:   avg(delivery_time_days) as avg_delivery_time,
                ^
[0m17:17:31.395893 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6d47ba8-c6de-410a-9972-986f7a0b2906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b283df0>]}
[0m17:17:31.396168 [error] [Thread-1  ]: 2 of 2 ERROR creating sql view model main.carrier_performance .................. [[31mERROR[0m in 0.02s]
[0m17:17:31.396416 [debug] [Thread-1  ]: Finished running node model.logistics_analytics.carrier_performance
[0m17:17:31.396643 [debug] [Thread-4  ]: Marking all children of 'model.logistics_analytics.carrier_performance' to be skipped because of status 'error'.  Reason: Runtime Error in model carrier_performance (models/staging/carrier_performance.sql)
  Binder Error: Referenced column "delivery_time_days" not found in FROM clause!
  Candidate bindings: "delivery_days", "delivery_date", "expected_delivery_date", "order_date", "is_delayed"
  
  LINE 8:   avg(delivery_time_days) as avg_delivery_time,
                ^.
[0m17:17:31.397108 [debug] [MainThread]: Using duckdb connection "master"
[0m17:17:31.397279 [debug] [MainThread]: On master: BEGIN
[0m17:17:31.397419 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:17:31.397726 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:17:31.397862 [debug] [MainThread]: On master: COMMIT
[0m17:17:31.397995 [debug] [MainThread]: Using duckdb connection "master"
[0m17:17:31.398118 [debug] [MainThread]: On master: COMMIT
[0m17:17:31.398316 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:17:31.398444 [debug] [MainThread]: On master: Close
[0m17:17:31.398617 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:17:31.398735 [debug] [MainThread]: Connection 'model.logistics_analytics.carrier_performance' was properly closed.
[0m17:17:31.398882 [info ] [MainThread]: 
[0m17:17:31.399029 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m17:17:31.399380 [debug] [MainThread]: Command end result
[0m17:17:31.409214 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics/target/manifest.json
[0m17:17:31.409930 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics/target/semantic_manifest.json
[0m17:17:31.412808 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics/target/run_results.json
[0m17:17:31.412937 [info ] [MainThread]: 
[0m17:17:31.413099 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:17:31.413260 [info ] [MainThread]: 
[0m17:17:31.413487 [error] [MainThread]: [31mFailure in model carrier_performance (models/staging/carrier_performance.sql)[0m
[0m17:17:31.413687 [error] [MainThread]:   Runtime Error in model carrier_performance (models/staging/carrier_performance.sql)
  Binder Error: Referenced column "delivery_time_days" not found in FROM clause!
  Candidate bindings: "delivery_days", "delivery_date", "expected_delivery_date", "order_date", "is_delayed"
  
  LINE 8:   avg(delivery_time_days) as avg_delivery_time,
                ^
[0m17:17:31.413827 [info ] [MainThread]: 
[0m17:17:31.413981 [info ] [MainThread]:   compiled code at target/compiled/logistics_analytics/models/staging/carrier_performance.sql
[0m17:17:31.414111 [info ] [MainThread]: 
[0m17:17:31.414254 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m17:17:31.415444 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.63910264, "process_in_blocks": "0", "process_kernel_time": 0.140375, "process_mem_max_rss": "140181504", "process_out_blocks": "0", "process_user_time": 0.981384}
[0m17:17:31.415637 [debug] [MainThread]: Command `dbt run` failed at 17:17:31.415600 after 0.64 seconds
[0m17:17:31.415811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10481e340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aa3c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b283160>]}
[0m17:17:31.415976 [debug] [MainThread]: Flushing usage events
[0m17:17:32.967132 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:18:38.808248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11099f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112540790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125405b0>]}


============================== 17:18:38.810210 | 995c6710-b2df-48cb-8d8f-0d00761be0b9 ==============================
[0m17:18:38.810210 [info ] [MainThread]: Running with dbt=1.10.17
[0m17:18:38.810513 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'introspect': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'debug': 'False', 'empty': 'False', 'quiet': 'False', 'log_path': '/Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics/logs', 'invocation_command': 'dbt run', 'version_check': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'warn_error': 'None'}
[0m17:18:38.970614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '995c6710-b2df-48cb-8d8f-0d00761be0b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112780c40>]}
[0m17:18:38.996127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '995c6710-b2df-48cb-8d8f-0d00761be0b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112710850>]}
[0m17:18:38.997445 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:18:39.053000 [debug] [MainThread]: checksum: a50d730a31f4c1af850aa8110f398f1e1657a0325ec5753dae2929b817189a3e, vars: {}, profile: , target: , version: 1.10.17
[0m17:18:39.105163 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:18:39.105426 [debug] [MainThread]: Partial parsing: updated file: logistics_analytics://models/staging/carrier_performance.sql
[0m17:18:39.221446 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.logistics_analytics.marts
[0m17:18:39.223780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '995c6710-b2df-48cb-8d8f-0d00761be0b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112780670>]}
[0m17:18:39.252640 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics/target/manifest.json
[0m17:18:39.253669 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics/target/semantic_manifest.json
[0m17:18:39.263206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '995c6710-b2df-48cb-8d8f-0d00761be0b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124d3fd0>]}
[0m17:18:39.263417 [info ] [MainThread]: Found 2 models, 456 macros
[0m17:18:39.263571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '995c6710-b2df-48cb-8d8f-0d00761be0b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112762fa0>]}
[0m17:18:39.264113 [info ] [MainThread]: 
[0m17:18:39.264271 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:18:39.264399 [info ] [MainThread]: 
[0m17:18:39.264616 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:18:39.266953 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_logistics'
[0m17:18:39.291543 [debug] [ThreadPool]: Using duckdb connection "list_logistics"
[0m17:18:39.291749 [debug] [ThreadPool]: On list_logistics: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "list_logistics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"logistics"'
    
  
  
[0m17:18:39.291884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:39.303452 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m17:18:39.304110 [debug] [ThreadPool]: On list_logistics: Close
[0m17:18:39.304413 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_logistics, now create_logistics_main)
[0m17:18:39.304623 [debug] [ThreadPool]: Creating schema "database: "logistics"
schema: "main"
"
[0m17:18:39.307533 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m17:18:39.307674 [debug] [ThreadPool]: On create_logistics_main: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "create_logistics_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='logistics'
        and type='sqlite'
    
  
[0m17:18:39.307794 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:18:39.308364 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:18:39.308967 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m17:18:39.309096 [debug] [ThreadPool]: On create_logistics_main: BEGIN
[0m17:18:39.309283 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:18:39.309411 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m17:18:39.309539 [debug] [ThreadPool]: On create_logistics_main: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "create_logistics_main"} */

    
    
        create schema if not exists "logistics"."main"
    
[0m17:18:39.309891 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:18:39.310262 [debug] [ThreadPool]: On create_logistics_main: COMMIT
[0m17:18:39.310384 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m17:18:39.310494 [debug] [ThreadPool]: On create_logistics_main: COMMIT
[0m17:18:39.310668 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:18:39.310796 [debug] [ThreadPool]: On create_logistics_main: Close
[0m17:18:39.311228 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_logistics_main, now list_logistics_main)
[0m17:18:39.313579 [debug] [ThreadPool]: Using duckdb connection "list_logistics_main"
[0m17:18:39.313707 [debug] [ThreadPool]: On list_logistics_main: BEGIN
[0m17:18:39.313816 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:18:39.314005 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:18:39.314127 [debug] [ThreadPool]: Using duckdb connection "list_logistics_main"
[0m17:18:39.314258 [debug] [ThreadPool]: On list_logistics_main: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "list_logistics_main"} */
select
      'logistics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'logistics'
  
[0m17:18:39.321016 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m17:18:39.321627 [debug] [ThreadPool]: On list_logistics_main: ROLLBACK
[0m17:18:39.322623 [debug] [ThreadPool]: Failed to rollback 'list_logistics_main'
[0m17:18:39.322799 [debug] [ThreadPool]: On list_logistics_main: Close
[0m17:18:39.323252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '995c6710-b2df-48cb-8d8f-0d00761be0b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107135b80>]}
[0m17:18:39.323468 [debug] [MainThread]: Using duckdb connection "master"
[0m17:18:39.323600 [debug] [MainThread]: On master: BEGIN
[0m17:18:39.323719 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:18:39.323925 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:18:39.324056 [debug] [MainThread]: On master: COMMIT
[0m17:18:39.324182 [debug] [MainThread]: Using duckdb connection "master"
[0m17:18:39.324301 [debug] [MainThread]: On master: COMMIT
[0m17:18:39.324490 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:18:39.324643 [debug] [MainThread]: On master: Close
[0m17:18:39.325627 [debug] [Thread-1  ]: Began running node model.logistics_analytics.stg_shipments
[0m17:18:39.325864 [info ] [Thread-1  ]: 1 of 2 START sql view model main.stg_shipments ................................. [RUN]
[0m17:18:39.326137 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_logistics_main, now model.logistics_analytics.stg_shipments)
[0m17:18:39.326301 [debug] [Thread-1  ]: Began compiling node model.logistics_analytics.stg_shipments
[0m17:18:39.329299 [debug] [Thread-1  ]: Writing injected SQL for node "model.logistics_analytics.stg_shipments"
[0m17:18:39.329599 [debug] [Thread-1  ]: Began executing node model.logistics_analytics.stg_shipments
[0m17:18:39.342357 [debug] [Thread-1  ]: Writing runtime sql for node "model.logistics_analytics.stg_shipments"
[0m17:18:39.342740 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m17:18:39.342892 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: BEGIN
[0m17:18:39.343031 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:18:39.343340 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:18:39.343493 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m17:18:39.343660 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */

  
  create view "logistics"."main"."stg_shipments__dbt_tmp" as (
    select
    shipment_id,
    carrier,
    origin,
    destination,

    cast(order_date as date) as order_date,
    cast(delivery_date as date) as delivery_date,
    cast(expected_delivery_date as date) as expected_delivery_date,

    distance_km,

    datediff(
        'day',
        cast(order_date as date),
        cast(delivery_date as date)
    ) as delivery_days,

    case
        when cast(delivery_date as date) > cast(expected_delivery_date as date)
            then 1
        else 0
    end as is_delayed

from read_parquet('../../data/parquet/shipments.parquet')
  );

[0m17:18:39.346016 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m17:18:39.349387 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m17:18:39.349570 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */
alter view "logistics"."main"."stg_shipments" rename to "stg_shipments__dbt_backup"
[0m17:18:39.350247 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:18:39.351554 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m17:18:39.351704 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */
alter view "logistics"."main"."stg_shipments__dbt_tmp" rename to "stg_shipments"
[0m17:18:39.351940 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:18:39.356706 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: COMMIT
[0m17:18:39.356855 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m17:18:39.356987 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: COMMIT
[0m17:18:39.357654 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:18:39.359850 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m17:18:39.360036 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */

      drop view if exists "logistics"."main"."stg_shipments__dbt_backup" cascade
    
[0m17:18:39.360325 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:18:39.361328 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: Close
[0m17:18:39.362245 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '995c6710-b2df-48cb-8d8f-0d00761be0b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145aa730>]}
[0m17:18:39.362507 [info ] [Thread-1  ]: 1 of 2 OK created sql view model main.stg_shipments ............................ [[32mOK[0m in 0.04s]
[0m17:18:39.362753 [debug] [Thread-1  ]: Finished running node model.logistics_analytics.stg_shipments
[0m17:18:39.363037 [debug] [Thread-1  ]: Began running node model.logistics_analytics.carrier_performance
[0m17:18:39.363277 [info ] [Thread-1  ]: 2 of 2 START sql view model main.carrier_performance ........................... [RUN]
[0m17:18:39.363492 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.logistics_analytics.stg_shipments, now model.logistics_analytics.carrier_performance)
[0m17:18:39.363653 [debug] [Thread-1  ]: Began compiling node model.logistics_analytics.carrier_performance
[0m17:18:39.364818 [debug] [Thread-1  ]: Writing injected SQL for node "model.logistics_analytics.carrier_performance"
[0m17:18:39.365068 [debug] [Thread-1  ]: Began executing node model.logistics_analytics.carrier_performance
[0m17:18:39.366622 [debug] [Thread-1  ]: Writing runtime sql for node "model.logistics_analytics.carrier_performance"
[0m17:18:39.366859 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m17:18:39.366996 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: BEGIN
[0m17:18:39.367123 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:18:39.367350 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:18:39.367496 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m17:18:39.367650 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */

  
  create view "logistics"."main"."carrier_performance__dbt_tmp" as (
    select
    carrier,
    count(*) as total_shipments,
    round(avg(delivery_days), 2) as avg_delivery_days,
    round(100.0 * avg(is_delayed), 2) as delay_rate_pct
from "logistics"."main"."stg_shipments"
group by carrier
  );

[0m17:18:39.368311 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:18:39.369854 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m17:18:39.370052 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */
alter view "logistics"."main"."carrier_performance__dbt_tmp" rename to "carrier_performance"
[0m17:18:39.370340 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:18:39.370945 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: COMMIT
[0m17:18:39.371096 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m17:18:39.371228 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: COMMIT
[0m17:18:39.371501 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:18:39.373047 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m17:18:39.373191 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */

      drop view if exists "logistics"."main"."carrier_performance__dbt_backup" cascade
    
[0m17:18:39.373408 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:18:39.373910 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: Close
[0m17:18:39.374140 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '995c6710-b2df-48cb-8d8f-0d00761be0b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11491f730>]}
[0m17:18:39.374395 [info ] [Thread-1  ]: 2 of 2 OK created sql view model main.carrier_performance ...................... [[32mOK[0m in 0.01s]
[0m17:18:39.374633 [debug] [Thread-1  ]: Finished running node model.logistics_analytics.carrier_performance
[0m17:18:39.375167 [debug] [MainThread]: Using duckdb connection "master"
[0m17:18:39.375344 [debug] [MainThread]: On master: BEGIN
[0m17:18:39.375483 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:18:39.375712 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:18:39.375852 [debug] [MainThread]: On master: COMMIT
[0m17:18:39.375985 [debug] [MainThread]: Using duckdb connection "master"
[0m17:18:39.376111 [debug] [MainThread]: On master: COMMIT
[0m17:18:39.376297 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:18:39.376433 [debug] [MainThread]: On master: Close
[0m17:18:39.376618 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:18:39.376735 [debug] [MainThread]: Connection 'model.logistics_analytics.carrier_performance' was properly closed.
[0m17:18:39.376889 [info ] [MainThread]: 
[0m17:18:39.377038 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m17:18:39.377391 [debug] [MainThread]: Command end result
[0m17:18:39.387818 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics/target/manifest.json
[0m17:18:39.388639 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics/target/semantic_manifest.json
[0m17:18:39.391447 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics/target/run_results.json
[0m17:18:39.391580 [info ] [MainThread]: 
[0m17:18:39.391751 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:18:39.391890 [info ] [MainThread]: 
[0m17:18:39.392038 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m17:18:39.393034 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.61932844, "process_in_blocks": "0", "process_kernel_time": 0.131632, "process_mem_max_rss": "140017664", "process_out_blocks": "0", "process_user_time": 0.973703}
[0m17:18:39.393213 [debug] [MainThread]: Command `dbt run` succeeded at 17:18:39.393176 after 0.62 seconds
[0m17:18:39.393362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11099f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114924670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124d3400>]}
[0m17:18:39.393518 [debug] [MainThread]: Flushing usage events
[0m17:18:40.963296 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:07:08.941287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91a72460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f7f56d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f7f59a0>]}


============================== 12:07:08.943674 | 2ec89652-4937-4589-840b-a612786d7bba ==============================
[0m12:07:08.943674 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:07:08.943999 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/logistics_analytics', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logistics_analytics/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:07:09.042764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ec89652-4937-4589-840b-a612786d7bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f8b9f10>]}
[0m12:07:09.067304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ec89652-4937-4589-840b-a612786d7bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f7f55b0>]}
[0m12:07:09.067920 [info ] [MainThread]: Registered adapter: duckdb=1.7.5
[0m12:07:09.072395 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m12:07:09.078029 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m12:07:09.078288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2ec89652-4937-4589-840b-a612786d7bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f583fd0>]}
[0m12:07:09.462769 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.logistics_analytics.marts
[0m12:07:09.464847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ec89652-4937-4589-840b-a612786d7bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bfc5d00>]}
[0m12:07:09.471409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ec89652-4937-4589-840b-a612786d7bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bfc5f70>]}
[0m12:07:09.471663 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m12:07:09.471855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ec89652-4937-4589-840b-a612786d7bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f583ee0>]}
[0m12:07:09.472448 [info ] [MainThread]: 
[0m12:07:09.472801 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:07:09.473345 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_logistics'
[0m12:07:09.478504 [debug] [ThreadPool]: Using duckdb connection "list_logistics"
[0m12:07:09.478726 [debug] [ThreadPool]: On list_logistics: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "list_logistics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"logistics"'
    
  
  
[0m12:07:09.478896 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:09.481910 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:07:09.482162 [debug] [MainThread]: Connection 'list_logistics' was properly closed.
[0m12:07:09.482349 [info ] [MainThread]: 
[0m12:07:09.482584 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.01 seconds (0.01s).
[0m12:07:09.482880 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Trying to read a database file with version number 64, but we can only read version 51.
  The database file was created with an newer version of DuckDB.
  
  The storage of DuckDB is not yet stable; newer versions of DuckDB cannot read old database files and vice versa.
  The storage will be stabilized when version 1.0 releases.
  
  For now, we recommend that you load the database file in a supported version of DuckDB, and use the EXPORT DATABASE command followed by IMPORT DATABASE on the current version of DuckDB.
  
  See the storage page for more information: https://duckdb.org/internals/storage
[0m12:07:09.483273 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.56056875, "process_user_time": 1.626113, "process_kernel_time": 0.090283, "process_mem_max_rss": "145364", "process_out_blocks": "3190", "command_success": false, "process_in_blocks": "0"}
[0m12:07:09.483543 [debug] [MainThread]: Command `dbt run` failed at 12:07:09.483479 after 0.56 seconds
[0m12:07:09.483753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91a72460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bf7a460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bfa31c0>]}
[0m12:07:09.483950 [debug] [MainThread]: Flushing usage events
[0m17:37:37.235710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10720e3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108280850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108280670>]}


============================== 17:37:37.237779 | bb7cb926-046a-4da8-bda5-65c63bf38aec ==============================
[0m17:37:37.237779 [info ] [MainThread]: Running with dbt=1.10.17
[0m17:37:37.238107 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics/logs', 'target_path': 'None', 'empty': 'False', 'introspect': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'debug': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'warn_error': 'None', 'write_json': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'use_colors': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'profiles_dir': '/Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics', 'static_parser': 'True', 'invocation_command': 'dbt run'}
[0m17:37:37.394252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb7cb926-046a-4da8-bda5-65c63bf38aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083996d0>]}
[0m17:37:37.421621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb7cb926-046a-4da8-bda5-65c63bf38aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108485820>]}
[0m17:37:37.422958 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:37:37.477808 [debug] [MainThread]: checksum: a50d730a31f4c1af850aa8110f398f1e1657a0325ec5753dae2929b817189a3e, vars: {}, profile: , target: , version: 1.10.17
[0m17:37:37.513123 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:37:37.513417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bb7cb926-046a-4da8-bda5-65c63bf38aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107548940>]}
[0m17:37:38.021294 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.logistics_analytics.marts
[0m17:37:38.023841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb7cb926-046a-4da8-bda5-65c63bf38aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10890e130>]}
[0m17:37:38.054868 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics/target/manifest.json
[0m17:37:38.055957 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics/target/semantic_manifest.json
[0m17:37:38.065961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb7cb926-046a-4da8-bda5-65c63bf38aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089328b0>]}
[0m17:37:38.066195 [info ] [MainThread]: Found 2 models, 456 macros
[0m17:37:38.066353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb7cb926-046a-4da8-bda5-65c63bf38aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084a83a0>]}
[0m17:37:38.066926 [info ] [MainThread]: 
[0m17:37:38.067087 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:37:38.067217 [info ] [MainThread]: 
[0m17:37:38.067452 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:37:38.069821 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_logistics'
[0m17:37:38.095914 [debug] [ThreadPool]: Using duckdb connection "list_logistics"
[0m17:37:38.096155 [debug] [ThreadPool]: On list_logistics: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "list_logistics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"logistics"'
    
  
  
[0m17:37:38.096298 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:37:38.111536 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m17:37:38.112263 [debug] [ThreadPool]: On list_logistics: Close
[0m17:37:38.112614 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_logistics, now create_logistics_main)
[0m17:37:38.112857 [debug] [ThreadPool]: Creating schema "database: "logistics"
schema: "main"
"
[0m17:37:38.116239 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m17:37:38.116398 [debug] [ThreadPool]: On create_logistics_main: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "create_logistics_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='logistics'
        and type='sqlite'
    
  
[0m17:37:38.116532 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:37:38.117133 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:37:38.117674 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m17:37:38.117817 [debug] [ThreadPool]: On create_logistics_main: BEGIN
[0m17:37:38.118026 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:37:38.118153 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m17:37:38.118283 [debug] [ThreadPool]: On create_logistics_main: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "create_logistics_main"} */

    
    
        create schema if not exists "logistics"."main"
    
[0m17:37:38.118507 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:37:38.118848 [debug] [ThreadPool]: On create_logistics_main: COMMIT
[0m17:37:38.118986 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m17:37:38.119110 [debug] [ThreadPool]: On create_logistics_main: COMMIT
[0m17:37:38.119334 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:37:38.119525 [debug] [ThreadPool]: On create_logistics_main: Close
[0m17:37:38.120067 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_logistics_main, now list_logistics_main)
[0m17:37:38.122730 [debug] [ThreadPool]: Using duckdb connection "list_logistics_main"
[0m17:37:38.122873 [debug] [ThreadPool]: On list_logistics_main: BEGIN
[0m17:37:38.122997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:37:38.123211 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:37:38.123338 [debug] [ThreadPool]: Using duckdb connection "list_logistics_main"
[0m17:37:38.123470 [debug] [ThreadPool]: On list_logistics_main: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "list_logistics_main"} */
select
      'logistics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'logistics'
  
[0m17:37:38.130463 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m17:37:38.131068 [debug] [ThreadPool]: On list_logistics_main: ROLLBACK
[0m17:37:38.132089 [debug] [ThreadPool]: Failed to rollback 'list_logistics_main'
[0m17:37:38.132237 [debug] [ThreadPool]: On list_logistics_main: Close
[0m17:37:38.132655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb7cb926-046a-4da8-bda5-65c63bf38aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108351130>]}
[0m17:37:38.132890 [debug] [MainThread]: Using duckdb connection "master"
[0m17:37:38.133032 [debug] [MainThread]: On master: BEGIN
[0m17:37:38.133163 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:37:38.133397 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:37:38.133532 [debug] [MainThread]: On master: COMMIT
[0m17:37:38.133663 [debug] [MainThread]: Using duckdb connection "master"
[0m17:37:38.133790 [debug] [MainThread]: On master: COMMIT
[0m17:37:38.133979 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:37:38.134112 [debug] [MainThread]: On master: Close
[0m17:37:38.135225 [debug] [Thread-1  ]: Began running node model.logistics_analytics.stg_shipments
[0m17:37:38.135461 [info ] [Thread-1  ]: 1 of 2 START sql view model main.stg_shipments ................................. [RUN]
[0m17:37:38.135671 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_logistics_main, now model.logistics_analytics.stg_shipments)
[0m17:37:38.135832 [debug] [Thread-1  ]: Began compiling node model.logistics_analytics.stg_shipments
[0m17:37:38.139832 [debug] [Thread-1  ]: Writing injected SQL for node "model.logistics_analytics.stg_shipments"
[0m17:37:38.140317 [debug] [Thread-1  ]: Began executing node model.logistics_analytics.stg_shipments
[0m17:37:38.154805 [debug] [Thread-1  ]: Writing runtime sql for node "model.logistics_analytics.stg_shipments"
[0m17:37:38.155258 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m17:37:38.155427 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: BEGIN
[0m17:37:38.155579 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:37:38.155887 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:37:38.156041 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m17:37:38.156205 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */

  
  create view "logistics"."main"."stg_shipments__dbt_tmp" as (
    select
    shipment_id,
    carrier,
    origin,
    destination,

    cast(order_date as date) as order_date,
    cast(delivery_date as date) as delivery_date,
    cast(expected_delivery_date as date) as expected_delivery_date,

    distance_km,

    datediff(
        'day',
        cast(order_date as date),
        cast(delivery_date as date)
    ) as delivery_days,

    case
        when cast(delivery_date as date) > cast(expected_delivery_date as date)
            then 1
        else 0
    end as is_delayed

from read_parquet('../../data/parquet/shipments.parquet')
  );

[0m17:37:38.158108 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m17:37:38.161272 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m17:37:38.161456 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */
alter view "logistics"."main"."stg_shipments" rename to "stg_shipments__dbt_backup"
[0m17:37:38.161992 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:37:38.163390 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m17:37:38.163554 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */
alter view "logistics"."main"."stg_shipments__dbt_tmp" rename to "stg_shipments"
[0m17:37:38.163801 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:37:38.168971 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: COMMIT
[0m17:37:38.169138 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m17:37:38.169287 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: COMMIT
[0m17:37:38.169901 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:37:38.172423 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m17:37:38.172593 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */

      drop view if exists "logistics"."main"."stg_shipments__dbt_backup" cascade
    
[0m17:37:38.173025 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:37:38.174141 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: Close
[0m17:37:38.175331 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb7cb926-046a-4da8-bda5-65c63bf38aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ddde50>]}
[0m17:37:38.175666 [info ] [Thread-1  ]: 1 of 2 OK created sql view model main.stg_shipments ............................ [[32mOK[0m in 0.04s]
[0m17:37:38.175940 [debug] [Thread-1  ]: Finished running node model.logistics_analytics.stg_shipments
[0m17:37:38.176239 [debug] [Thread-1  ]: Began running node model.logistics_analytics.carrier_performance
[0m17:37:38.176483 [info ] [Thread-1  ]: 2 of 2 START sql view model main.carrier_performance ........................... [RUN]
[0m17:37:38.176697 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.logistics_analytics.stg_shipments, now model.logistics_analytics.carrier_performance)
[0m17:37:38.176859 [debug] [Thread-1  ]: Began compiling node model.logistics_analytics.carrier_performance
[0m17:37:38.178717 [debug] [Thread-1  ]: Writing injected SQL for node "model.logistics_analytics.carrier_performance"
[0m17:37:38.179141 [debug] [Thread-1  ]: Began executing node model.logistics_analytics.carrier_performance
[0m17:37:38.180790 [debug] [Thread-1  ]: Writing runtime sql for node "model.logistics_analytics.carrier_performance"
[0m17:37:38.181081 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m17:37:38.181236 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: BEGIN
[0m17:37:38.181384 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:37:38.181644 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:37:38.181899 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m17:37:38.182068 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */

  
  create view "logistics"."main"."carrier_performance__dbt_tmp" as (
    select
    carrier,
    count(*) as total_shipments,
    round(avg(delivery_days), 2) as avg_delivery_days,
    round(100.0 * avg(is_delayed), 2) as delay_rate_pct
from "logistics"."main"."stg_shipments"
group by carrier
  );

[0m17:37:38.182865 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m17:37:38.184799 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m17:37:38.185004 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */
alter view "logistics"."main"."carrier_performance" rename to "carrier_performance__dbt_backup"
[0m17:37:38.185340 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:37:38.186981 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m17:37:38.187163 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */
alter view "logistics"."main"."carrier_performance__dbt_tmp" rename to "carrier_performance"
[0m17:37:38.187451 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:37:38.188136 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: COMMIT
[0m17:37:38.188342 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m17:37:38.188514 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: COMMIT
[0m17:37:38.188858 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:37:38.190054 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m17:37:38.190216 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.10.17", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */

      drop view if exists "logistics"."main"."carrier_performance__dbt_backup" cascade
    
[0m17:37:38.190502 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m17:37:38.191166 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: Close
[0m17:37:38.191572 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb7cb926-046a-4da8-bda5-65c63bf38aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ef5610>]}
[0m17:37:38.192013 [info ] [Thread-1  ]: 2 of 2 OK created sql view model main.carrier_performance ...................... [[32mOK[0m in 0.01s]
[0m17:37:38.192282 [debug] [Thread-1  ]: Finished running node model.logistics_analytics.carrier_performance
[0m17:37:38.192753 [debug] [MainThread]: Using duckdb connection "master"
[0m17:37:38.192896 [debug] [MainThread]: On master: BEGIN
[0m17:37:38.193021 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:37:38.193257 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:37:38.193387 [debug] [MainThread]: On master: COMMIT
[0m17:37:38.193513 [debug] [MainThread]: Using duckdb connection "master"
[0m17:37:38.193638 [debug] [MainThread]: On master: COMMIT
[0m17:37:38.193819 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:37:38.193947 [debug] [MainThread]: On master: Close
[0m17:37:38.194109 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:37:38.194234 [debug] [MainThread]: Connection 'model.logistics_analytics.carrier_performance' was properly closed.
[0m17:37:38.194394 [info ] [MainThread]: 
[0m17:37:38.194539 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m17:37:38.194877 [debug] [MainThread]: Command end result
[0m17:37:38.233187 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics/target/manifest.json
[0m17:37:38.234022 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics/target/semantic_manifest.json
[0m17:37:38.237480 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ishikaishani/Desktop/logistics-analytics/dbt/logistics_analytics/target/run_results.json
[0m17:37:38.237657 [info ] [MainThread]: 
[0m17:37:38.237849 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:37:38.237995 [info ] [MainThread]: 
[0m17:37:38.238148 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m17:37:38.239315 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.040379, "process_in_blocks": "0", "process_kernel_time": 0.14905, "process_mem_max_rss": "142327808", "process_out_blocks": "0", "process_user_time": 1.475897}
[0m17:37:38.239507 [debug] [MainThread]: Command `dbt run` succeeded at 17:37:38.239468 after 1.04 seconds
[0m17:37:38.239678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10720e3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d04850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dd38b0>]}
[0m17:37:38.239851 [debug] [MainThread]: Flushing usage events
[0m17:37:39.542059 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:07:47.239565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ffc83d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ddb65e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ddb6850>]}


============================== 12:07:47.241958 | e6624ebf-bfdd-4476-9d7a-75c45fec591e ==============================
[0m12:07:47.241958 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:07:47.242260 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt/logistics_analytics', 'log_path': '/opt/airflow/dbt/logistics_analytics/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:07:47.321079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6624ebf-bfdd-4476-9d7a-75c45fec591e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dce6b80>]}
[0m12:07:47.354838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6624ebf-bfdd-4476-9d7a-75c45fec591e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ddb6250>]}
[0m12:07:47.355392 [info ] [MainThread]: Registered adapter: duckdb=1.7.5
[0m12:07:47.359675 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m12:07:47.364316 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m12:07:47.364563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e6624ebf-bfdd-4476-9d7a-75c45fec591e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9da870d0>]}
[0m12:07:47.749312 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.logistics_analytics.marts
[0m12:07:47.751676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6624ebf-bfdd-4476-9d7a-75c45fec591e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a4c3c40>]}
[0m12:07:47.757802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6624ebf-bfdd-4476-9d7a-75c45fec591e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a4c3eb0>]}
[0m12:07:47.758038 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m12:07:47.758236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6624ebf-bfdd-4476-9d7a-75c45fec591e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ae7eb80>]}
[0m12:07:47.758809 [info ] [MainThread]: 
[0m12:07:47.759163 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:07:47.759710 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_logistics'
[0m12:07:47.765213 [debug] [ThreadPool]: Using duckdb connection "list_logistics"
[0m12:07:47.765439 [debug] [ThreadPool]: On list_logistics: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "list_logistics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"logistics"'
    
  
  
[0m12:07:47.765638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:47.768376 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:07:47.768666 [debug] [MainThread]: Connection 'list_logistics' was properly closed.
[0m12:07:47.768852 [info ] [MainThread]: 
[0m12:07:47.769040 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.01 seconds (0.01s).
[0m12:07:47.769304 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Trying to read a database file with version number 64, but we can only read version 51.
  The database file was created with an newer version of DuckDB.
  
  The storage of DuckDB is not yet stable; newer versions of DuckDB cannot read old database files and vice versa.
  The storage will be stabilized when version 1.0 releases.
  
  For now, we recommend that you load the database file in a supported version of DuckDB, and use the EXPORT DATABASE command followed by IMPORT DATABASE on the current version of DuckDB.
  
  See the storage page for more information: https://duckdb.org/internals/storage
[0m12:07:47.769690 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.54891527, "process_user_time": 1.555531, "process_kernel_time": 0.067892, "process_mem_max_rss": "145460", "process_out_blocks": "1510", "command_success": false, "process_in_blocks": "0"}
[0m12:07:47.769945 [debug] [MainThread]: Command `dbt run` failed at 12:07:47.769890 after 0.55 seconds
[0m12:07:47.770148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ffc83d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99bc1a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9af82b50>]}
[0m12:07:47.770348 [debug] [MainThread]: Flushing usage events
[0m12:07:57.792441 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m12:13:08.841242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4b7b3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2935610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2935880>]}


============================== 12:13:08.843603 | 4e2a416c-bbaa-460e-961b-31c6d41624a8 ==============================
[0m12:13:08.843603 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:13:08.843881 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logistics_analytics/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt/logistics_analytics', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:13:08.927420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e2a416c-bbaa-460e-961b-31c6d41624a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa28a6bb0>]}
[0m12:13:08.951280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e2a416c-bbaa-460e-961b-31c6d41624a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa292db20>]}
[0m12:13:08.951647 [info ] [MainThread]: Registered adapter: duckdb=1.7.5
[0m12:13:08.955653 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m12:13:08.967955 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:13:08.968163 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:13:08.968457 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.logistics_analytics.marts
[0m12:13:08.971059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e2a416c-bbaa-460e-961b-31c6d41624a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fa4fee0>]}
[0m12:13:08.977326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e2a416c-bbaa-460e-961b-31c6d41624a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fb29250>]}
[0m12:13:08.977549 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m12:13:08.977751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e2a416c-bbaa-460e-961b-31c6d41624a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fb29040>]}
[0m12:13:08.978366 [info ] [MainThread]: 
[0m12:13:08.978716 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:13:08.979273 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_logistics'
[0m12:13:08.984651 [debug] [ThreadPool]: Using duckdb connection "list_logistics"
[0m12:13:08.984846 [debug] [ThreadPool]: On list_logistics: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "list_logistics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"logistics"'
    
  
  
[0m12:13:08.985012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:13:08.989794 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:13:08.990551 [debug] [ThreadPool]: On list_logistics: Close
[0m12:13:08.991777 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_logistics, now create_logistics_main)
[0m12:13:08.992107 [debug] [ThreadPool]: Creating schema "database: "logistics"
schema: "main"
"
[0m12:13:08.995014 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m12:13:08.995210 [debug] [ThreadPool]: On create_logistics_main: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "create_logistics_main"} */

    
        select type from duckdb_databases()
        where database_name='logistics'
        and type='sqlite'
    
  
[0m12:13:08.995372 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:13:08.997491 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:13:08.998057 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m12:13:08.998248 [debug] [ThreadPool]: On create_logistics_main: BEGIN
[0m12:13:08.998458 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:13:08.998660 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m12:13:08.998914 [debug] [ThreadPool]: On create_logistics_main: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "create_logistics_main"} */

    
    
        create schema if not exists "logistics"."main"
    
[0m12:13:08.999233 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:13:08.999626 [debug] [ThreadPool]: On create_logistics_main: COMMIT
[0m12:13:08.999796 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m12:13:08.999998 [debug] [ThreadPool]: On create_logistics_main: COMMIT
[0m12:13:09.000229 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:13:09.000411 [debug] [ThreadPool]: On create_logistics_main: Close
[0m12:13:09.001649 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_logistics_main, now list_logistics_main)
[0m12:13:09.003973 [debug] [ThreadPool]: Using duckdb connection "list_logistics_main"
[0m12:13:09.004169 [debug] [ThreadPool]: On list_logistics_main: BEGIN
[0m12:13:09.004335 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:13:09.006292 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:13:09.006468 [debug] [ThreadPool]: Using duckdb connection "list_logistics_main"
[0m12:13:09.006644 [debug] [ThreadPool]: On list_logistics_main: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "list_logistics_main"} */
select
      'logistics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'logistics'
  
[0m12:13:09.012144 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:13:09.013043 [debug] [ThreadPool]: On list_logistics_main: ROLLBACK
[0m12:13:09.013354 [debug] [ThreadPool]: Failed to rollback 'list_logistics_main'
[0m12:13:09.013539 [debug] [ThreadPool]: On list_logistics_main: Close
[0m12:13:09.014569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e2a416c-bbaa-460e-961b-31c6d41624a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f1e67c0>]}
[0m12:13:09.014801 [debug] [MainThread]: Using duckdb connection "master"
[0m12:13:09.014986 [debug] [MainThread]: On master: BEGIN
[0m12:13:09.015153 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:13:09.016996 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:13:09.017170 [debug] [MainThread]: On master: COMMIT
[0m12:13:09.017337 [debug] [MainThread]: Using duckdb connection "master"
[0m12:13:09.017499 [debug] [MainThread]: On master: COMMIT
[0m12:13:09.017688 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:13:09.017858 [debug] [MainThread]: On master: Close
[0m12:13:09.018602 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:13:09.018808 [info ] [MainThread]: 
[0m12:13:09.022087 [debug] [Thread-1  ]: Began running node model.logistics_analytics.stg_shipments
[0m12:13:09.022347 [info ] [Thread-1  ]: 1 of 2 START sql view model main.stg_shipments ................................. [RUN]
[0m12:13:09.022696 [debug] [Thread-1  ]: Acquiring new duckdb connection 'model.logistics_analytics.stg_shipments'
[0m12:13:09.022909 [debug] [Thread-1  ]: Began compiling node model.logistics_analytics.stg_shipments
[0m12:13:09.026029 [debug] [Thread-1  ]: Writing injected SQL for node "model.logistics_analytics.stg_shipments"
[0m12:13:09.026897 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.stg_shipments (compile): 12:13:09.023042 => 12:13:09.026787
[0m12:13:09.027119 [debug] [Thread-1  ]: Began executing node model.logistics_analytics.stg_shipments
[0m12:13:09.040924 [debug] [Thread-1  ]: Writing runtime sql for node "model.logistics_analytics.stg_shipments"
[0m12:13:09.041493 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m12:13:09.041686 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: BEGIN
[0m12:13:09.041884 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m12:13:09.044443 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:13:09.044625 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m12:13:09.044798 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */

  
  create view "logistics"."main"."stg_shipments__dbt_tmp" as (
    select
    shipment_id,
    carrier,
    origin,
    destination,

    cast(order_date as date) as order_date,
    cast(delivery_date as date) as delivery_date,
    cast(expected_delivery_date as date) as expected_delivery_date,

    distance_km,

    datediff(
        'day',
        cast(order_date as date),
        cast(delivery_date as date)
    ) as delivery_days,

    case
        when cast(delivery_date as date) > cast(expected_delivery_date as date)
            then 1
        else 0
    end as is_delayed

from read_parquet('../../data/parquet/shipments.parquet')
  );

[0m12:13:09.045560 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:13:09.048721 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m12:13:09.048934 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */
alter view "logistics"."main"."stg_shipments__dbt_tmp" rename to "stg_shipments"
[0m12:13:09.049152 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:13:09.055240 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: COMMIT
[0m12:13:09.055464 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m12:13:09.055662 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: COMMIT
[0m12:13:09.056062 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:13:09.058366 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m12:13:09.058547 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */
drop view if exists "logistics"."main"."stg_shipments__dbt_backup" cascade
[0m12:13:09.058778 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:13:09.059410 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.stg_shipments (execute): 12:13:09.027314 => 12:13:09.059318
[0m12:13:09.059593 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: Close
[0m12:13:09.061054 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e2a416c-bbaa-460e-961b-31c6d41624a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f1425b0>]}
[0m12:13:09.061341 [info ] [Thread-1  ]: 1 of 2 OK created sql view model main.stg_shipments ............................ [[32mOK[0m in 0.04s]
[0m12:13:09.061629 [debug] [Thread-1  ]: Finished running node model.logistics_analytics.stg_shipments
[0m12:13:09.062093 [debug] [Thread-1  ]: Began running node model.logistics_analytics.carrier_performance
[0m12:13:09.062319 [info ] [Thread-1  ]: 2 of 2 START sql view model main.carrier_performance ........................... [RUN]
[0m12:13:09.062631 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.logistics_analytics.stg_shipments, now model.logistics_analytics.carrier_performance)
[0m12:13:09.062812 [debug] [Thread-1  ]: Began compiling node model.logistics_analytics.carrier_performance
[0m12:13:09.064038 [debug] [Thread-1  ]: Writing injected SQL for node "model.logistics_analytics.carrier_performance"
[0m12:13:09.064584 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.carrier_performance (compile): 12:13:09.062927 => 12:13:09.064487
[0m12:13:09.064773 [debug] [Thread-1  ]: Began executing node model.logistics_analytics.carrier_performance
[0m12:13:09.066496 [debug] [Thread-1  ]: Writing runtime sql for node "model.logistics_analytics.carrier_performance"
[0m12:13:09.066912 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m12:13:09.067109 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: BEGIN
[0m12:13:09.067286 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:13:09.069577 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:13:09.069771 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m12:13:09.069954 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */

  
  create view "logistics"."main"."carrier_performance__dbt_tmp" as (
    select
    carrier,
    count(*) as total_shipments,
    round(avg(delivery_days), 2) as avg_delivery_days,
    round(100.0 * avg(is_delayed), 2) as delay_rate_pct
from "logistics"."main"."stg_shipments"
group by carrier
  );

[0m12:13:09.070558 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:13:09.071948 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m12:13:09.072169 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */
alter view "logistics"."main"."carrier_performance__dbt_tmp" rename to "carrier_performance"
[0m12:13:09.072402 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:13:09.073053 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: COMMIT
[0m12:13:09.073338 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m12:13:09.073571 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: COMMIT
[0m12:13:09.073886 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:13:09.075037 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m12:13:09.075249 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */
drop view if exists "logistics"."main"."carrier_performance__dbt_backup" cascade
[0m12:13:09.075490 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:13:09.076075 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.carrier_performance (execute): 12:13:09.064879 => 12:13:09.075977
[0m12:13:09.076271 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: Close
[0m12:13:09.077906 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e2a416c-bbaa-460e-961b-31c6d41624a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f0c33d0>]}
[0m12:13:09.078214 [info ] [Thread-1  ]: 2 of 2 OK created sql view model main.carrier_performance ...................... [[32mOK[0m in 0.02s]
[0m12:13:09.078521 [debug] [Thread-1  ]: Finished running node model.logistics_analytics.carrier_performance
[0m12:13:09.079162 [debug] [MainThread]: Using duckdb connection "master"
[0m12:13:09.079354 [debug] [MainThread]: On master: BEGIN
[0m12:13:09.079500 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:13:09.081807 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:13:09.081993 [debug] [MainThread]: On master: COMMIT
[0m12:13:09.082154 [debug] [MainThread]: Using duckdb connection "master"
[0m12:13:09.082306 [debug] [MainThread]: On master: COMMIT
[0m12:13:09.082466 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:13:09.082615 [debug] [MainThread]: On master: Close
[0m12:13:09.083350 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:13:09.083512 [debug] [MainThread]: Connection 'list_logistics_main' was properly closed.
[0m12:13:09.083667 [debug] [MainThread]: Connection 'model.logistics_analytics.carrier_performance' was properly closed.
[0m12:13:09.083838 [info ] [MainThread]: 
[0m12:13:09.084022 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m12:13:09.084375 [debug] [MainThread]: Command end result
[0m12:13:09.088888 [info ] [MainThread]: 
[0m12:13:09.089124 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:13:09.089460 [info ] [MainThread]: 
[0m12:13:09.089684 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:13:09.090098 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.2674024, "process_user_time": 1.287982, "process_kernel_time": 0.097695, "process_mem_max_rss": "145444", "process_out_blocks": "4804", "process_in_blocks": "0"}
[0m12:13:09.090364 [debug] [MainThread]: Command `dbt run` succeeded at 12:13:09.090301 after 0.27 seconds
[0m12:13:09.090572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4b7b3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa26aeee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2646ca0>]}
[0m12:13:09.090786 [debug] [MainThread]: Flushing usage events
[0m12:13:14.294903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8bee370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6a37790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6a37b50>]}


============================== 12:13:14.297392 | 2eb7db94-e60b-4431-9dfb-8711826b218a ==============================
[0m12:13:14.297392 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:13:14.297702 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/logistics_analytics', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logistics_analytics/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:13:14.376776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2eb7db94-e60b-4431-9dfb-8711826b218a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6a7cd60>]}
[0m12:13:14.400776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2eb7db94-e60b-4431-9dfb-8711826b218a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa67071f0>]}
[0m12:13:14.401172 [info ] [MainThread]: Registered adapter: duckdb=1.7.5
[0m12:13:14.405076 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m12:13:14.417233 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:13:14.417456 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:13:14.417783 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.logistics_analytics.marts
[0m12:13:14.420479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2eb7db94-e60b-4431-9dfb-8711826b218a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3a92e20>]}
[0m12:13:14.426561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2eb7db94-e60b-4431-9dfb-8711826b218a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6718070>]}
[0m12:13:14.426784 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m12:13:14.426980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2eb7db94-e60b-4431-9dfb-8711826b218a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6718250>]}
[0m12:13:14.427603 [info ] [MainThread]: 
[0m12:13:14.427974 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:13:14.428588 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_logistics'
[0m12:13:14.434261 [debug] [ThreadPool]: Using duckdb connection "list_logistics"
[0m12:13:14.434475 [debug] [ThreadPool]: On list_logistics: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "list_logistics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"logistics"'
    
  
  
[0m12:13:14.434702 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:13:14.438597 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:13:14.439253 [debug] [ThreadPool]: On list_logistics: Close
[0m12:13:14.440612 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_logistics, now create_logistics_main)
[0m12:13:14.440948 [debug] [ThreadPool]: Creating schema "database: "logistics"
schema: "main"
"
[0m12:13:14.443946 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m12:13:14.444167 [debug] [ThreadPool]: On create_logistics_main: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "create_logistics_main"} */

    
        select type from duckdb_databases()
        where database_name='logistics'
        and type='sqlite'
    
  
[0m12:13:14.444349 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:13:14.446958 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:13:14.447527 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m12:13:14.447705 [debug] [ThreadPool]: On create_logistics_main: BEGIN
[0m12:13:14.447923 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:13:14.448121 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m12:13:14.448324 [debug] [ThreadPool]: On create_logistics_main: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "create_logistics_main"} */

    
    
        create schema if not exists "logistics"."main"
    
[0m12:13:14.448742 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:13:14.449165 [debug] [ThreadPool]: On create_logistics_main: COMMIT
[0m12:13:14.449346 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m12:13:14.449533 [debug] [ThreadPool]: On create_logistics_main: COMMIT
[0m12:13:14.449732 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:13:14.449919 [debug] [ThreadPool]: On create_logistics_main: Close
[0m12:13:14.451297 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_logistics_main, now list_logistics_main)
[0m12:13:14.453745 [debug] [ThreadPool]: Using duckdb connection "list_logistics_main"
[0m12:13:14.453934 [debug] [ThreadPool]: On list_logistics_main: BEGIN
[0m12:13:14.454104 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:13:14.456509 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:13:14.456699 [debug] [ThreadPool]: Using duckdb connection "list_logistics_main"
[0m12:13:14.456918 [debug] [ThreadPool]: On list_logistics_main: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "list_logistics_main"} */
select
      'logistics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'logistics'
  
[0m12:13:14.462402 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:13:14.463416 [debug] [ThreadPool]: On list_logistics_main: ROLLBACK
[0m12:13:14.463711 [debug] [ThreadPool]: Failed to rollback 'list_logistics_main'
[0m12:13:14.463899 [debug] [ThreadPool]: On list_logistics_main: Close
[0m12:13:14.465224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2eb7db94-e60b-4431-9dfb-8711826b218a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa67acd30>]}
[0m12:13:14.465477 [debug] [MainThread]: Using duckdb connection "master"
[0m12:13:14.465664 [debug] [MainThread]: On master: BEGIN
[0m12:13:14.465837 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:13:14.468218 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:13:14.468396 [debug] [MainThread]: On master: COMMIT
[0m12:13:14.468574 [debug] [MainThread]: Using duckdb connection "master"
[0m12:13:14.468739 [debug] [MainThread]: On master: COMMIT
[0m12:13:14.468935 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:13:14.469103 [debug] [MainThread]: On master: Close
[0m12:13:14.469918 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:13:14.470138 [info ] [MainThread]: 
[0m12:13:14.473397 [debug] [Thread-1  ]: Began running node model.logistics_analytics.stg_shipments
[0m12:13:14.473674 [info ] [Thread-1  ]: 1 of 2 START sql view model main.stg_shipments ................................. [RUN]
[0m12:13:14.474058 [debug] [Thread-1  ]: Acquiring new duckdb connection 'model.logistics_analytics.stg_shipments'
[0m12:13:14.474270 [debug] [Thread-1  ]: Began compiling node model.logistics_analytics.stg_shipments
[0m12:13:14.477488 [debug] [Thread-1  ]: Writing injected SQL for node "model.logistics_analytics.stg_shipments"
[0m12:13:14.478210 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.stg_shipments (compile): 12:13:14.474398 => 12:13:14.478066
[0m12:13:14.478430 [debug] [Thread-1  ]: Began executing node model.logistics_analytics.stg_shipments
[0m12:13:14.491966 [debug] [Thread-1  ]: Writing runtime sql for node "model.logistics_analytics.stg_shipments"
[0m12:13:14.492583 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m12:13:14.492800 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: BEGIN
[0m12:13:14.493030 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m12:13:14.495862 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:13:14.496087 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m12:13:14.496290 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */

  
  create view "logistics"."main"."stg_shipments__dbt_tmp" as (
    select
    shipment_id,
    carrier,
    origin,
    destination,

    cast(order_date as date) as order_date,
    cast(delivery_date as date) as delivery_date,
    cast(expected_delivery_date as date) as expected_delivery_date,

    distance_km,

    datediff(
        'day',
        cast(order_date as date),
        cast(delivery_date as date)
    ) as delivery_days,

    case
        when cast(delivery_date as date) > cast(expected_delivery_date as date)
            then 1
        else 0
    end as is_delayed

from read_parquet('../../data/parquet/shipments.parquet')
  );

[0m12:13:14.496825 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:13:14.500157 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m12:13:14.500366 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */
alter view "logistics"."main"."stg_shipments" rename to "stg_shipments__dbt_backup"
[0m12:13:14.500609 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:13:14.501956 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m12:13:14.502186 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */
alter view "logistics"."main"."stg_shipments__dbt_tmp" rename to "stg_shipments"
[0m12:13:14.502459 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:13:14.509560 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: COMMIT
[0m12:13:14.509788 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m12:13:14.509989 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: COMMIT
[0m12:13:14.510412 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:13:14.512600 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m12:13:14.512814 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */
drop view if exists "logistics"."main"."stg_shipments__dbt_backup" cascade
[0m12:13:14.513275 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:13:14.513893 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.stg_shipments (execute): 12:13:14.478567 => 12:13:14.513790
[0m12:13:14.514101 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: Close
[0m12:13:14.515803 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eb7db94-e60b-4431-9dfb-8711826b218a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa274afa0>]}
[0m12:13:14.516107 [info ] [Thread-1  ]: 1 of 2 OK created sql view model main.stg_shipments ............................ [[32mOK[0m in 0.04s]
[0m12:13:14.516409 [debug] [Thread-1  ]: Finished running node model.logistics_analytics.stg_shipments
[0m12:13:14.516852 [debug] [Thread-1  ]: Began running node model.logistics_analytics.carrier_performance
[0m12:13:14.517101 [info ] [Thread-1  ]: 2 of 2 START sql view model main.carrier_performance ........................... [RUN]
[0m12:13:14.517419 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.logistics_analytics.stg_shipments, now model.logistics_analytics.carrier_performance)
[0m12:13:14.517610 [debug] [Thread-1  ]: Began compiling node model.logistics_analytics.carrier_performance
[0m12:13:14.518871 [debug] [Thread-1  ]: Writing injected SQL for node "model.logistics_analytics.carrier_performance"
[0m12:13:14.519344 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.carrier_performance (compile): 12:13:14.517721 => 12:13:14.519243
[0m12:13:14.519517 [debug] [Thread-1  ]: Began executing node model.logistics_analytics.carrier_performance
[0m12:13:14.521279 [debug] [Thread-1  ]: Writing runtime sql for node "model.logistics_analytics.carrier_performance"
[0m12:13:14.521649 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m12:13:14.521836 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: BEGIN
[0m12:13:14.522030 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:13:14.524390 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:13:14.524579 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m12:13:14.524746 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */

  
  create view "logistics"."main"."carrier_performance__dbt_tmp" as (
    select
    carrier,
    count(*) as total_shipments,
    round(avg(delivery_days), 2) as avg_delivery_days,
    round(100.0 * avg(is_delayed), 2) as delay_rate_pct
from "logistics"."main"."stg_shipments"
group by carrier
  );

[0m12:13:14.525241 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:13:14.526668 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m12:13:14.526890 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */
alter view "logistics"."main"."carrier_performance" rename to "carrier_performance__dbt_backup"
[0m12:13:14.527122 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:13:14.528504 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m12:13:14.528744 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */
alter view "logistics"."main"."carrier_performance__dbt_tmp" rename to "carrier_performance"
[0m12:13:14.529046 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:13:14.529851 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: COMMIT
[0m12:13:14.530058 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m12:13:14.530234 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: COMMIT
[0m12:13:14.530541 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:13:14.532150 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m12:13:14.532348 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */
drop view if exists "logistics"."main"."carrier_performance__dbt_backup" cascade
[0m12:13:14.532636 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:13:14.533251 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.carrier_performance (execute): 12:13:14.519627 => 12:13:14.533159
[0m12:13:14.533448 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: Close
[0m12:13:14.534920 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eb7db94-e60b-4431-9dfb-8711826b218a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa30d0f70>]}
[0m12:13:14.535215 [info ] [Thread-1  ]: 2 of 2 OK created sql view model main.carrier_performance ...................... [[32mOK[0m in 0.02s]
[0m12:13:14.535507 [debug] [Thread-1  ]: Finished running node model.logistics_analytics.carrier_performance
[0m12:13:14.536171 [debug] [MainThread]: Using duckdb connection "master"
[0m12:13:14.536382 [debug] [MainThread]: On master: BEGIN
[0m12:13:14.536566 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:13:14.539120 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:13:14.539308 [debug] [MainThread]: On master: COMMIT
[0m12:13:14.539470 [debug] [MainThread]: Using duckdb connection "master"
[0m12:13:14.539614 [debug] [MainThread]: On master: COMMIT
[0m12:13:14.539793 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:13:14.539958 [debug] [MainThread]: On master: Close
[0m12:13:14.540690 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:13:14.540851 [debug] [MainThread]: Connection 'list_logistics_main' was properly closed.
[0m12:13:14.541058 [debug] [MainThread]: Connection 'model.logistics_analytics.carrier_performance' was properly closed.
[0m12:13:14.541258 [info ] [MainThread]: 
[0m12:13:14.541455 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m12:13:14.541828 [debug] [MainThread]: Command end result
[0m12:13:14.565145 [info ] [MainThread]: 
[0m12:13:14.565408 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:13:14.565602 [info ] [MainThread]: 
[0m12:13:14.565793 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:13:14.566193 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.28984383, "process_user_time": 1.298223, "process_kernel_time": 0.05801, "process_mem_max_rss": "145572", "process_out_blocks": "3615", "process_in_blocks": "0"}
[0m12:13:14.566450 [debug] [MainThread]: Command `dbt run` succeeded at 12:13:14.566393 after 0.29 seconds
[0m12:13:14.566629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8bee370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa683e700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6a7cd60>]}
[0m12:13:14.566812 [debug] [MainThread]: Flushing usage events
[0m12:53:48.569545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa205b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fdf9670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fdf9940>]}


============================== 12:53:48.572311 | 985ce81d-ccec-4c56-a891-a25dd73bafc7 ==============================
[0m12:53:48.572311 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:53:48.572584 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/logistics_analytics', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logistics_analytics/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:53:48.664444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '985ce81d-ccec-4c56-a891-a25dd73bafc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fd66bb0>]}
[0m12:53:48.689053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '985ce81d-ccec-4c56-a891-a25dd73bafc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fdf92e0>]}
[0m12:53:48.689437 [info ] [MainThread]: Registered adapter: duckdb=1.7.5
[0m12:53:48.694252 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m12:53:48.715226 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:53:48.715579 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:53:48.715906 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.logistics_analytics.marts
[0m12:53:48.719163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '985ce81d-ccec-4c56-a891-a25dd73bafc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cf0ff10>]}
[0m12:53:48.727946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '985ce81d-ccec-4c56-a891-a25dd73bafc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cfe9070>]}
[0m12:53:48.728320 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m12:53:48.728533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '985ce81d-ccec-4c56-a891-a25dd73bafc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fc8b6d0>]}
[0m12:53:48.729311 [info ] [MainThread]: 
[0m12:53:48.729725 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:53:48.730356 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_logistics'
[0m12:53:48.736410 [debug] [ThreadPool]: Using duckdb connection "list_logistics"
[0m12:53:48.736766 [debug] [ThreadPool]: On list_logistics: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "list_logistics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"logistics"'
    
  
  
[0m12:53:48.737077 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:48.742542 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:53:48.743382 [debug] [ThreadPool]: On list_logistics: Close
[0m12:53:48.745090 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_logistics, now create_logistics_main)
[0m12:53:48.745595 [debug] [ThreadPool]: Creating schema "database: "logistics"
schema: "main"
"
[0m12:53:48.748836 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m12:53:48.749052 [debug] [ThreadPool]: On create_logistics_main: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "create_logistics_main"} */

    
        select type from duckdb_databases()
        where database_name='logistics'
        and type='sqlite'
    
  
[0m12:53:48.749250 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:48.752352 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:53:48.753399 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m12:53:48.753611 [debug] [ThreadPool]: On create_logistics_main: BEGIN
[0m12:53:48.753837 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:53:48.754015 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m12:53:48.754208 [debug] [ThreadPool]: On create_logistics_main: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "create_logistics_main"} */

    
    
        create schema if not exists "logistics"."main"
    
[0m12:53:48.754463 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:53:48.754828 [debug] [ThreadPool]: On create_logistics_main: COMMIT
[0m12:53:48.755011 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m12:53:48.755197 [debug] [ThreadPool]: On create_logistics_main: COMMIT
[0m12:53:48.755398 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:53:48.755568 [debug] [ThreadPool]: On create_logistics_main: Close
[0m12:53:48.757007 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_logistics_main, now list_logistics_main)
[0m12:53:48.759446 [debug] [ThreadPool]: Using duckdb connection "list_logistics_main"
[0m12:53:48.759653 [debug] [ThreadPool]: On list_logistics_main: BEGIN
[0m12:53:48.759854 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:48.762472 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:53:48.762652 [debug] [ThreadPool]: Using duckdb connection "list_logistics_main"
[0m12:53:48.762826 [debug] [ThreadPool]: On list_logistics_main: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "list_logistics_main"} */
select
      'logistics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'logistics'
  
[0m12:53:48.768489 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:53:48.769570 [debug] [ThreadPool]: On list_logistics_main: ROLLBACK
[0m12:53:48.769917 [debug] [ThreadPool]: Failed to rollback 'list_logistics_main'
[0m12:53:48.770133 [debug] [ThreadPool]: On list_logistics_main: Close
[0m12:53:48.771625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '985ce81d-ccec-4c56-a891-a25dd73bafc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cee77f0>]}
[0m12:53:48.771887 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:48.772141 [debug] [MainThread]: On master: BEGIN
[0m12:53:48.772339 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:53:48.775261 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:53:48.775466 [debug] [MainThread]: On master: COMMIT
[0m12:53:48.775652 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:48.775831 [debug] [MainThread]: On master: COMMIT
[0m12:53:48.776036 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:53:48.776232 [debug] [MainThread]: On master: Close
[0m12:53:48.777183 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:53:48.777410 [info ] [MainThread]: 
[0m12:53:48.780765 [debug] [Thread-1  ]: Began running node model.logistics_analytics.stg_shipments
[0m12:53:48.781055 [info ] [Thread-1  ]: 1 of 2 START sql view model main.stg_shipments ................................. [RUN]
[0m12:53:48.781418 [debug] [Thread-1  ]: Acquiring new duckdb connection 'model.logistics_analytics.stg_shipments'
[0m12:53:48.781594 [debug] [Thread-1  ]: Began compiling node model.logistics_analytics.stg_shipments
[0m12:53:48.784909 [debug] [Thread-1  ]: Writing injected SQL for node "model.logistics_analytics.stg_shipments"
[0m12:53:48.786300 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.stg_shipments (compile): 12:53:48.781708 => 12:53:48.786173
[0m12:53:48.786504 [debug] [Thread-1  ]: Began executing node model.logistics_analytics.stg_shipments
[0m12:53:48.800799 [debug] [Thread-1  ]: Writing runtime sql for node "model.logistics_analytics.stg_shipments"
[0m12:53:48.801676 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m12:53:48.801923 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: BEGIN
[0m12:53:48.802128 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m12:53:48.804795 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:53:48.804999 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m12:53:48.805195 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */

  
  create view "logistics"."main"."stg_shipments__dbt_tmp" as (
    select
    shipment_id,
    carrier,
    origin,
    destination,

    cast(order_date as date) as order_date,
    cast(delivery_date as date) as delivery_date,
    cast(expected_delivery_date as date) as expected_delivery_date,

    distance_km,

    datediff(
        'day',
        cast(order_date as date),
        cast(delivery_date as date)
    ) as delivery_days,

    case
        when cast(delivery_date as date) > cast(expected_delivery_date as date)
            then 1
        else 0
    end as is_delayed

from read_parquet('../../data/parquet/shipments.parquet')
  );

[0m12:53:48.805830 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:53:48.809240 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m12:53:48.809460 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */
alter view "logistics"."main"."stg_shipments" rename to "stg_shipments__dbt_backup"
[0m12:53:48.809719 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:53:48.811072 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m12:53:48.811281 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */
alter view "logistics"."main"."stg_shipments__dbt_tmp" rename to "stg_shipments"
[0m12:53:48.811523 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:53:48.818649 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: COMMIT
[0m12:53:48.818870 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m12:53:48.819090 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: COMMIT
[0m12:53:48.819505 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:53:48.821726 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m12:53:48.821916 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */
drop view if exists "logistics"."main"."stg_shipments__dbt_backup" cascade
[0m12:53:48.822320 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:53:48.822967 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.stg_shipments (execute): 12:53:48.786636 => 12:53:48.822864
[0m12:53:48.823186 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: Close
[0m12:53:48.825041 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '985ce81d-ccec-4c56-a891-a25dd73bafc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c57e250>]}
[0m12:53:48.825338 [info ] [Thread-1  ]: 1 of 2 OK created sql view model main.stg_shipments ............................ [[32mOK[0m in 0.04s]
[0m12:53:48.825636 [debug] [Thread-1  ]: Finished running node model.logistics_analytics.stg_shipments
[0m12:53:48.826118 [debug] [Thread-1  ]: Began running node model.logistics_analytics.carrier_performance
[0m12:53:48.826359 [info ] [Thread-1  ]: 2 of 2 START sql view model main.carrier_performance ........................... [RUN]
[0m12:53:48.826662 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.logistics_analytics.stg_shipments, now model.logistics_analytics.carrier_performance)
[0m12:53:48.826842 [debug] [Thread-1  ]: Began compiling node model.logistics_analytics.carrier_performance
[0m12:53:48.828067 [debug] [Thread-1  ]: Writing injected SQL for node "model.logistics_analytics.carrier_performance"
[0m12:53:48.828822 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.carrier_performance (compile): 12:53:48.826951 => 12:53:48.828698
[0m12:53:48.829031 [debug] [Thread-1  ]: Began executing node model.logistics_analytics.carrier_performance
[0m12:53:48.830758 [debug] [Thread-1  ]: Writing runtime sql for node "model.logistics_analytics.carrier_performance"
[0m12:53:48.831233 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m12:53:48.831423 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: BEGIN
[0m12:53:48.831590 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:53:48.833922 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:53:48.834120 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m12:53:48.834332 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */

  
  create view "logistics"."main"."carrier_performance__dbt_tmp" as (
    select
    carrier,
    count(*) as total_shipments,
    round(avg(delivery_days), 2) as avg_delivery_days,
    round(100.0 * avg(is_delayed), 2) as delay_rate_pct
from "logistics"."main"."stg_shipments"
group by carrier
  );

[0m12:53:48.834902 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:53:48.836411 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m12:53:48.836630 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */
alter view "logistics"."main"."carrier_performance" rename to "carrier_performance__dbt_backup"
[0m12:53:48.837001 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:53:48.838418 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m12:53:48.838614 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */
alter view "logistics"."main"."carrier_performance__dbt_tmp" rename to "carrier_performance"
[0m12:53:48.838825 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:53:48.839639 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: COMMIT
[0m12:53:48.839840 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m12:53:48.840018 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: COMMIT
[0m12:53:48.840335 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:53:48.841981 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m12:53:48.842188 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */
drop view if exists "logistics"."main"."carrier_performance__dbt_backup" cascade
[0m12:53:48.842516 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:53:48.843136 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.carrier_performance (execute): 12:53:48.829151 => 12:53:48.843046
[0m12:53:48.843335 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: Close
[0m12:53:48.844864 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '985ce81d-ccec-4c56-a891-a25dd73bafc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cef9190>]}
[0m12:53:48.845181 [info ] [Thread-1  ]: 2 of 2 OK created sql view model main.carrier_performance ...................... [[32mOK[0m in 0.02s]
[0m12:53:48.845474 [debug] [Thread-1  ]: Finished running node model.logistics_analytics.carrier_performance
[0m12:53:48.846166 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:48.846363 [debug] [MainThread]: On master: BEGIN
[0m12:53:48.846540 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:53:48.848973 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:53:48.849153 [debug] [MainThread]: On master: COMMIT
[0m12:53:48.849318 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:48.849470 [debug] [MainThread]: On master: COMMIT
[0m12:53:48.849636 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:53:48.849792 [debug] [MainThread]: On master: Close
[0m12:53:48.850590 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:53:48.850760 [debug] [MainThread]: Connection 'list_logistics_main' was properly closed.
[0m12:53:48.850915 [debug] [MainThread]: Connection 'model.logistics_analytics.carrier_performance' was properly closed.
[0m12:53:48.851118 [info ] [MainThread]: 
[0m12:53:48.851310 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m12:53:48.851668 [debug] [MainThread]: Command end result
[0m12:53:48.875812 [info ] [MainThread]: 
[0m12:53:48.876093 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:53:48.876304 [info ] [MainThread]: 
[0m12:53:48.876510 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:53:48.876929 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.32642546, "process_user_time": 1.33942, "process_kernel_time": 0.104876, "process_mem_max_rss": "145456", "process_out_blocks": "5295", "process_in_blocks": "0"}
[0m12:53:48.877237 [debug] [MainThread]: Command `dbt run` succeeded at 12:53:48.877179 after 0.33 seconds
[0m12:53:48.877435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa205b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fb71a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fb048b0>]}
[0m12:53:48.877633 [debug] [MainThread]: Flushing usage events
[0m12:53:53.014670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa95483d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa73395e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7339850>]}


============================== 12:53:53.017491 | 72cac216-5db4-4785-aeda-5fffedb8cb9c ==============================
[0m12:53:53.017491 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:53:53.017786 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logistics_analytics/logs', 'profiles_dir': '/opt/airflow/dbt/logistics_analytics', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:53:53.096920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72cac216-5db4-4785-aeda-5fffedb8cb9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7266b80>]}
[0m12:53:53.122076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72cac216-5db4-4785-aeda-5fffedb8cb9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7339250>]}
[0m12:53:53.122457 [info ] [MainThread]: Registered adapter: duckdb=1.7.5
[0m12:53:53.126518 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m12:53:53.138221 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:53:53.138430 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:53:53.138739 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.logistics_analytics.marts
[0m12:53:53.141451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72cac216-5db4-4785-aeda-5fffedb8cb9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3b52eb0>]}
[0m12:53:53.147736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72cac216-5db4-4785-aeda-5fffedb8cb9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa70ced30>]}
[0m12:53:53.147979 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m12:53:53.148208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72cac216-5db4-4785-aeda-5fffedb8cb9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4469220>]}
[0m12:53:53.148795 [info ] [MainThread]: 
[0m12:53:53.149154 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:53:53.149713 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_logistics'
[0m12:53:53.155223 [debug] [ThreadPool]: Using duckdb connection "list_logistics"
[0m12:53:53.155465 [debug] [ThreadPool]: On list_logistics: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "list_logistics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"logistics"'
    
  
  
[0m12:53:53.155756 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:53.159565 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:53:53.160213 [debug] [ThreadPool]: On list_logistics: Close
[0m12:53:53.161412 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_logistics, now create_logistics_main)
[0m12:53:53.161722 [debug] [ThreadPool]: Creating schema "database: "logistics"
schema: "main"
"
[0m12:53:53.164738 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m12:53:53.164940 [debug] [ThreadPool]: On create_logistics_main: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "create_logistics_main"} */

    
        select type from duckdb_databases()
        where database_name='logistics'
        and type='sqlite'
    
  
[0m12:53:53.165143 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:53.167599 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:53:53.168180 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m12:53:53.168369 [debug] [ThreadPool]: On create_logistics_main: BEGIN
[0m12:53:53.168564 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:53:53.168728 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m12:53:53.168897 [debug] [ThreadPool]: On create_logistics_main: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "create_logistics_main"} */

    
    
        create schema if not exists "logistics"."main"
    
[0m12:53:53.169108 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:53:53.169472 [debug] [ThreadPool]: On create_logistics_main: COMMIT
[0m12:53:53.169685 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m12:53:53.169908 [debug] [ThreadPool]: On create_logistics_main: COMMIT
[0m12:53:53.170257 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:53:53.170485 [debug] [ThreadPool]: On create_logistics_main: Close
[0m12:53:53.171918 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_logistics_main, now list_logistics_main)
[0m12:53:53.174356 [debug] [ThreadPool]: Using duckdb connection "list_logistics_main"
[0m12:53:53.174553 [debug] [ThreadPool]: On list_logistics_main: BEGIN
[0m12:53:53.174723 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:53.177150 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:53:53.177324 [debug] [ThreadPool]: Using duckdb connection "list_logistics_main"
[0m12:53:53.177497 [debug] [ThreadPool]: On list_logistics_main: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "list_logistics_main"} */
select
      'logistics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'logistics'
  
[0m12:53:53.182865 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:53:53.183769 [debug] [ThreadPool]: On list_logistics_main: ROLLBACK
[0m12:53:53.184086 [debug] [ThreadPool]: Failed to rollback 'list_logistics_main'
[0m12:53:53.184292 [debug] [ThreadPool]: On list_logistics_main: Close
[0m12:53:53.185564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72cac216-5db4-4785-aeda-5fffedb8cb9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3b2b790>]}
[0m12:53:53.185795 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:53.185975 [debug] [MainThread]: On master: BEGIN
[0m12:53:53.186140 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:53:53.188387 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:53:53.188564 [debug] [MainThread]: On master: COMMIT
[0m12:53:53.188733 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:53.188895 [debug] [MainThread]: On master: COMMIT
[0m12:53:53.189088 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:53:53.189281 [debug] [MainThread]: On master: Close
[0m12:53:53.190296 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:53:53.190497 [info ] [MainThread]: 
[0m12:53:53.193654 [debug] [Thread-1  ]: Began running node model.logistics_analytics.stg_shipments
[0m12:53:53.193929 [info ] [Thread-1  ]: 1 of 2 START sql view model main.stg_shipments ................................. [RUN]
[0m12:53:53.194301 [debug] [Thread-1  ]: Acquiring new duckdb connection 'model.logistics_analytics.stg_shipments'
[0m12:53:53.194495 [debug] [Thread-1  ]: Began compiling node model.logistics_analytics.stg_shipments
[0m12:53:53.197728 [debug] [Thread-1  ]: Writing injected SQL for node "model.logistics_analytics.stg_shipments"
[0m12:53:53.198375 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.stg_shipments (compile): 12:53:53.194618 => 12:53:53.198247
[0m12:53:53.198594 [debug] [Thread-1  ]: Began executing node model.logistics_analytics.stg_shipments
[0m12:53:53.212344 [debug] [Thread-1  ]: Writing runtime sql for node "model.logistics_analytics.stg_shipments"
[0m12:53:53.212904 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m12:53:53.213124 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: BEGIN
[0m12:53:53.213351 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m12:53:53.215838 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:53:53.216045 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m12:53:53.216244 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */

  
  create view "logistics"."main"."stg_shipments__dbt_tmp" as (
    select
    shipment_id,
    carrier,
    origin,
    destination,

    cast(order_date as date) as order_date,
    cast(delivery_date as date) as delivery_date,
    cast(expected_delivery_date as date) as expected_delivery_date,

    distance_km,

    datediff(
        'day',
        cast(order_date as date),
        cast(delivery_date as date)
    ) as delivery_days,

    case
        when cast(delivery_date as date) > cast(expected_delivery_date as date)
            then 1
        else 0
    end as is_delayed

from read_parquet('../../data/parquet/shipments.parquet')
  );

[0m12:53:53.216738 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:53:53.220021 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m12:53:53.220238 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */
alter view "logistics"."main"."stg_shipments" rename to "stg_shipments__dbt_backup"
[0m12:53:53.220475 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:53:53.221808 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m12:53:53.222020 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */
alter view "logistics"."main"."stg_shipments__dbt_tmp" rename to "stg_shipments"
[0m12:53:53.222240 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:53:53.229487 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: COMMIT
[0m12:53:53.229713 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m12:53:53.229936 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: COMMIT
[0m12:53:53.230377 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:53:53.232541 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m12:53:53.232739 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */
drop view if exists "logistics"."main"."stg_shipments__dbt_backup" cascade
[0m12:53:53.233123 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:53:53.233823 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.stg_shipments (execute): 12:53:53.198718 => 12:53:53.233720
[0m12:53:53.234029 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: Close
[0m12:53:53.235622 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72cac216-5db4-4785-aeda-5fffedb8cb9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3a8cb50>]}
[0m12:53:53.235899 [info ] [Thread-1  ]: 1 of 2 OK created sql view model main.stg_shipments ............................ [[32mOK[0m in 0.04s]
[0m12:53:53.236196 [debug] [Thread-1  ]: Finished running node model.logistics_analytics.stg_shipments
[0m12:53:53.236566 [debug] [Thread-1  ]: Began running node model.logistics_analytics.carrier_performance
[0m12:53:53.236845 [info ] [Thread-1  ]: 2 of 2 START sql view model main.carrier_performance ........................... [RUN]
[0m12:53:53.237188 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.logistics_analytics.stg_shipments, now model.logistics_analytics.carrier_performance)
[0m12:53:53.237396 [debug] [Thread-1  ]: Began compiling node model.logistics_analytics.carrier_performance
[0m12:53:53.238576 [debug] [Thread-1  ]: Writing injected SQL for node "model.logistics_analytics.carrier_performance"
[0m12:53:53.239048 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.carrier_performance (compile): 12:53:53.237517 => 12:53:53.238936
[0m12:53:53.239250 [debug] [Thread-1  ]: Began executing node model.logistics_analytics.carrier_performance
[0m12:53:53.240997 [debug] [Thread-1  ]: Writing runtime sql for node "model.logistics_analytics.carrier_performance"
[0m12:53:53.241404 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m12:53:53.241587 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: BEGIN
[0m12:53:53.241756 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:53:53.244045 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:53:53.244240 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m12:53:53.244423 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */

  
  create view "logistics"."main"."carrier_performance__dbt_tmp" as (
    select
    carrier,
    count(*) as total_shipments,
    round(avg(delivery_days), 2) as avg_delivery_days,
    round(100.0 * avg(is_delayed), 2) as delay_rate_pct
from "logistics"."main"."stg_shipments"
group by carrier
  );

[0m12:53:53.244926 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:53:53.246399 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m12:53:53.246607 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */
alter view "logistics"."main"."carrier_performance" rename to "carrier_performance__dbt_backup"
[0m12:53:53.246862 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:53:53.248343 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m12:53:53.248544 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */
alter view "logistics"."main"."carrier_performance__dbt_tmp" rename to "carrier_performance"
[0m12:53:53.248766 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:53:53.249550 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: COMMIT
[0m12:53:53.249743 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m12:53:53.249918 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: COMMIT
[0m12:53:53.250238 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:53:53.251877 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m12:53:53.252080 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */
drop view if exists "logistics"."main"."carrier_performance__dbt_backup" cascade
[0m12:53:53.252369 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m12:53:53.252950 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.carrier_performance (execute): 12:53:53.239371 => 12:53:53.252856
[0m12:53:53.253154 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: Close
[0m12:53:53.254588 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72cac216-5db4-4785-aeda-5fffedb8cb9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3a897c0>]}
[0m12:53:53.254877 [info ] [Thread-1  ]: 2 of 2 OK created sql view model main.carrier_performance ...................... [[32mOK[0m in 0.02s]
[0m12:53:53.255165 [debug] [Thread-1  ]: Finished running node model.logistics_analytics.carrier_performance
[0m12:53:53.255877 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:53.256094 [debug] [MainThread]: On master: BEGIN
[0m12:53:53.256268 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:53:53.258576 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:53:53.258746 [debug] [MainThread]: On master: COMMIT
[0m12:53:53.258893 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:53.259045 [debug] [MainThread]: On master: COMMIT
[0m12:53:53.259220 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:53:53.259384 [debug] [MainThread]: On master: Close
[0m12:53:53.260180 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:53:53.260351 [debug] [MainThread]: Connection 'list_logistics_main' was properly closed.
[0m12:53:53.260486 [debug] [MainThread]: Connection 'model.logistics_analytics.carrier_performance' was properly closed.
[0m12:53:53.260656 [info ] [MainThread]: 
[0m12:53:53.260836 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m12:53:53.261186 [debug] [MainThread]: Command end result
[0m12:53:53.284707 [info ] [MainThread]: 
[0m12:53:53.284991 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:53:53.285197 [info ] [MainThread]: 
[0m12:53:53.285421 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:53:53.285826 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.29048595, "process_user_time": 1.303104, "process_kernel_time": 0.059912, "process_mem_max_rss": "145552", "process_out_blocks": "3615", "process_in_blocks": "0"}
[0m12:53:53.286076 [debug] [MainThread]: Command `dbt run` succeeded at 12:53:53.286018 after 0.29 seconds
[0m12:53:53.286260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa95483d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa70cedc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7182940>]}
[0m12:53:53.286440 [debug] [MainThread]: Flushing usage events
[0m13:43:29.857670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0b9a460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e9f76a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e9f7970>]}


============================== 13:43:29.860242 | d51cf29a-3aa7-4bfe-a7b0-02181a89d0fc ==============================
[0m13:43:29.860242 [info ] [MainThread]: Running with dbt=1.7.18
[0m13:43:29.860544 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/logistics_analytics', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logistics_analytics/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:43:29.954356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd51cf29a-3aa7-4bfe-a7b0-02181a89d0fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ea3cd90>]}
[0m13:43:29.979540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd51cf29a-3aa7-4bfe-a7b0-02181a89d0fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e9f7580>]}
[0m13:43:29.980168 [info ] [MainThread]: Registered adapter: duckdb=1.7.5
[0m13:43:29.984703 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m13:43:29.997949 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:43:29.998161 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:43:29.998445 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.logistics_analytics.marts
[0m13:43:30.001180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd51cf29a-3aa7-4bfe-a7b0-02181a89d0fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ba52eb0>]}
[0m13:43:30.007950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd51cf29a-3aa7-4bfe-a7b0-02181a89d0fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bb27160>]}
[0m13:43:30.008186 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m13:43:30.008411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd51cf29a-3aa7-4bfe-a7b0-02181a89d0fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e7e28e0>]}
[0m13:43:30.009147 [info ] [MainThread]: 
[0m13:43:30.009566 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:43:30.010171 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_logistics'
[0m13:43:30.015628 [debug] [ThreadPool]: Using duckdb connection "list_logistics"
[0m13:43:30.015825 [debug] [ThreadPool]: On list_logistics: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "list_logistics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"logistics"'
    
  
  
[0m13:43:30.016000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:30.020125 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:30.021395 [debug] [ThreadPool]: On list_logistics: Close
[0m13:43:30.022699 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_logistics, now create_logistics_main)
[0m13:43:30.023004 [debug] [ThreadPool]: Creating schema "database: "logistics"
schema: "main"
"
[0m13:43:30.026019 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m13:43:30.026215 [debug] [ThreadPool]: On create_logistics_main: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "create_logistics_main"} */

    
        select type from duckdb_databases()
        where database_name='logistics'
        and type='sqlite'
    
  
[0m13:43:30.026374 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:30.028565 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:30.029152 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m13:43:30.029351 [debug] [ThreadPool]: On create_logistics_main: BEGIN
[0m13:43:30.029622 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:30.029827 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m13:43:30.029994 [debug] [ThreadPool]: On create_logistics_main: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "create_logistics_main"} */

    
    
        create schema if not exists "logistics"."main"
    
[0m13:43:30.030221 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:30.030641 [debug] [ThreadPool]: On create_logistics_main: COMMIT
[0m13:43:30.030834 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m13:43:30.030970 [debug] [ThreadPool]: On create_logistics_main: COMMIT
[0m13:43:30.031147 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:30.031315 [debug] [ThreadPool]: On create_logistics_main: Close
[0m13:43:30.032703 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_logistics_main, now list_logistics_main)
[0m13:43:30.035090 [debug] [ThreadPool]: Using duckdb connection "list_logistics_main"
[0m13:43:30.035284 [debug] [ThreadPool]: On list_logistics_main: BEGIN
[0m13:43:30.035470 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:30.037640 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:30.037811 [debug] [ThreadPool]: Using duckdb connection "list_logistics_main"
[0m13:43:30.037988 [debug] [ThreadPool]: On list_logistics_main: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "list_logistics_main"} */
select
      'logistics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'logistics'
  
[0m13:43:30.043358 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:30.044257 [debug] [ThreadPool]: On list_logistics_main: ROLLBACK
[0m13:43:30.044866 [debug] [ThreadPool]: Failed to rollback 'list_logistics_main'
[0m13:43:30.045054 [debug] [ThreadPool]: On list_logistics_main: Close
[0m13:43:30.046187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd51cf29a-3aa7-4bfe-a7b0-02181a89d0fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e6b4700>]}
[0m13:43:30.046464 [debug] [MainThread]: Using duckdb connection "master"
[0m13:43:30.046628 [debug] [MainThread]: On master: BEGIN
[0m13:43:30.046772 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:43:30.048755 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:43:30.048923 [debug] [MainThread]: On master: COMMIT
[0m13:43:30.049085 [debug] [MainThread]: Using duckdb connection "master"
[0m13:43:30.049242 [debug] [MainThread]: On master: COMMIT
[0m13:43:30.049459 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:43:30.049636 [debug] [MainThread]: On master: Close
[0m13:43:30.050451 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:43:30.050670 [info ] [MainThread]: 
[0m13:43:30.053967 [debug] [Thread-1  ]: Began running node model.logistics_analytics.stg_shipments
[0m13:43:30.054308 [info ] [Thread-1  ]: 1 of 2 START sql view model main.stg_shipments ................................. [RUN]
[0m13:43:30.054719 [debug] [Thread-1  ]: Acquiring new duckdb connection 'model.logistics_analytics.stg_shipments'
[0m13:43:30.054922 [debug] [Thread-1  ]: Began compiling node model.logistics_analytics.stg_shipments
[0m13:43:30.058126 [debug] [Thread-1  ]: Writing injected SQL for node "model.logistics_analytics.stg_shipments"
[0m13:43:30.059221 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.stg_shipments (compile): 13:43:30.055055 => 13:43:30.059118
[0m13:43:30.059417 [debug] [Thread-1  ]: Began executing node model.logistics_analytics.stg_shipments
[0m13:43:30.072814 [debug] [Thread-1  ]: Writing runtime sql for node "model.logistics_analytics.stg_shipments"
[0m13:43:30.073594 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m13:43:30.073781 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: BEGIN
[0m13:43:30.073972 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:43:30.076094 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m13:43:30.076293 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m13:43:30.076496 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */

  
  create view "logistics"."main"."stg_shipments__dbt_tmp" as (
    select
    shipment_id,
    carrier,
    origin,
    destination,

    cast(order_date as date) as order_date,
    cast(delivery_date as date) as delivery_date,
    cast(expected_delivery_date as date) as expected_delivery_date,

    distance_km,

    datediff(
        'day',
        cast(order_date as date),
        cast(delivery_date as date)
    ) as delivery_days,

    case
        when cast(delivery_date as date) > cast(expected_delivery_date as date)
            then 1
        else 0
    end as is_delayed

from read_parquet('../../data/parquet/shipments.parquet')
  );

[0m13:43:30.077539 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m13:43:30.080726 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m13:43:30.080923 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */
alter view "logistics"."main"."stg_shipments__dbt_tmp" rename to "stg_shipments"
[0m13:43:30.081244 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m13:43:30.088076 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: COMMIT
[0m13:43:30.088302 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m13:43:30.088480 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: COMMIT
[0m13:43:30.088875 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m13:43:30.091278 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m13:43:30.091511 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */
drop view if exists "logistics"."main"."stg_shipments__dbt_backup" cascade
[0m13:43:30.091843 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m13:43:30.092570 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.stg_shipments (execute): 13:43:30.059551 => 13:43:30.092477
[0m13:43:30.092769 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: Close
[0m13:43:30.094485 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd51cf29a-3aa7-4bfe-a7b0-02181a89d0fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b142610>]}
[0m13:43:30.094819 [info ] [Thread-1  ]: 1 of 2 OK created sql view model main.stg_shipments ............................ [[32mOK[0m in 0.04s]
[0m13:43:30.095190 [debug] [Thread-1  ]: Finished running node model.logistics_analytics.stg_shipments
[0m13:43:30.095719 [debug] [Thread-1  ]: Began running node model.logistics_analytics.carrier_performance
[0m13:43:30.095973 [info ] [Thread-1  ]: 2 of 2 START sql view model main.carrier_performance ........................... [RUN]
[0m13:43:30.096474 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.logistics_analytics.stg_shipments, now model.logistics_analytics.carrier_performance)
[0m13:43:30.096695 [debug] [Thread-1  ]: Began compiling node model.logistics_analytics.carrier_performance
[0m13:43:30.098197 [debug] [Thread-1  ]: Writing injected SQL for node "model.logistics_analytics.carrier_performance"
[0m13:43:30.098947 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.carrier_performance (compile): 13:43:30.096827 => 13:43:30.098837
[0m13:43:30.099151 [debug] [Thread-1  ]: Began executing node model.logistics_analytics.carrier_performance
[0m13:43:30.100998 [debug] [Thread-1  ]: Writing runtime sql for node "model.logistics_analytics.carrier_performance"
[0m13:43:30.101553 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m13:43:30.101739 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: BEGIN
[0m13:43:30.101916 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:43:30.104766 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m13:43:30.105012 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m13:43:30.105219 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */

  
  create view "logistics"."main"."carrier_performance__dbt_tmp" as (
    select
    carrier,
    count(*) as total_shipments,
    round(avg(delivery_days), 2) as avg_delivery_days,
    round(100.0 * avg(is_delayed), 2) as delay_rate_pct
from "logistics"."main"."stg_shipments"
group by carrier
  );

[0m13:43:30.106642 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m13:43:30.108486 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m13:43:30.108678 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */
alter view "logistics"."main"."carrier_performance__dbt_tmp" rename to "carrier_performance"
[0m13:43:30.108918 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m13:43:30.109582 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: COMMIT
[0m13:43:30.109765 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m13:43:30.109934 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: COMMIT
[0m13:43:30.110251 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m13:43:30.111359 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m13:43:30.111533 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */
drop view if exists "logistics"."main"."carrier_performance__dbt_backup" cascade
[0m13:43:30.111761 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m13:43:30.112353 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.carrier_performance (execute): 13:43:30.099274 => 13:43:30.112253
[0m13:43:30.112529 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: Close
[0m13:43:30.114825 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd51cf29a-3aa7-4bfe-a7b0-02181a89d0fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b169220>]}
[0m13:43:30.115113 [info ] [Thread-1  ]: 2 of 2 OK created sql view model main.carrier_performance ...................... [[32mOK[0m in 0.02s]
[0m13:43:30.115407 [debug] [Thread-1  ]: Finished running node model.logistics_analytics.carrier_performance
[0m13:43:30.116111 [debug] [MainThread]: Using duckdb connection "master"
[0m13:43:30.116311 [debug] [MainThread]: On master: BEGIN
[0m13:43:30.116484 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:43:30.119144 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:43:30.119324 [debug] [MainThread]: On master: COMMIT
[0m13:43:30.119483 [debug] [MainThread]: Using duckdb connection "master"
[0m13:43:30.119621 [debug] [MainThread]: On master: COMMIT
[0m13:43:30.119789 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:43:30.119936 [debug] [MainThread]: On master: Close
[0m13:43:30.120696 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:43:30.120879 [debug] [MainThread]: Connection 'list_logistics_main' was properly closed.
[0m13:43:30.121019 [debug] [MainThread]: Connection 'model.logistics_analytics.carrier_performance' was properly closed.
[0m13:43:30.121220 [info ] [MainThread]: 
[0m13:43:30.121428 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m13:43:30.121864 [debug] [MainThread]: Command end result
[0m13:43:30.126531 [info ] [MainThread]: 
[0m13:43:30.126780 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:43:30.127008 [info ] [MainThread]: 
[0m13:43:30.127264 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:43:30.128007 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.28880814, "process_user_time": 1.275418, "process_kernel_time": 0.094586, "process_mem_max_rss": "131604", "process_in_blocks": "10200", "process_out_blocks": "3124"}
[0m13:43:30.128300 [debug] [MainThread]: Command `dbt run` succeeded at 13:43:30.128238 after 0.29 seconds
[0m13:43:30.128496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0b9a460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b14c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ea3cd90>]}
[0m13:43:30.128670 [debug] [MainThread]: Flushing usage events
[0m13:46:59.687154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff927583d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff905795e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90579850>]}


============================== 13:46:59.689897 | 2d73db08-0ff9-4b4a-88ca-f64b845f389d ==============================
[0m13:46:59.689897 [info ] [MainThread]: Running with dbt=1.7.18
[0m13:46:59.690186 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt/logistics_analytics', 'log_path': '/opt/airflow/dbt/logistics_analytics/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:46:59.778389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d73db08-0ff9-4b4a-88ca-f64b845f389d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff904a6b80>]}
[0m13:46:59.802753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d73db08-0ff9-4b4a-88ca-f64b845f389d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90579250>]}
[0m13:46:59.803139 [info ] [MainThread]: Registered adapter: duckdb=1.7.5
[0m13:46:59.807309 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m13:46:59.824843 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:46:59.825061 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:46:59.825342 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.logistics_analytics.marts
[0m13:46:59.828104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d73db08-0ff9-4b4a-88ca-f64b845f389d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cd92eb0>]}
[0m13:46:59.835432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d73db08-0ff9-4b4a-88ca-f64b845f389d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9034ad30>]}
[0m13:46:59.835694 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m13:46:59.836026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d73db08-0ff9-4b4a-88ca-f64b845f389d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d6a8220>]}
[0m13:46:59.837205 [info ] [MainThread]: 
[0m13:46:59.837909 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:46:59.838616 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_logistics'
[0m13:46:59.845246 [debug] [ThreadPool]: Using duckdb connection "list_logistics"
[0m13:46:59.845791 [debug] [ThreadPool]: On list_logistics: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "list_logistics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"logistics"'
    
  
  
[0m13:46:59.846106 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:59.850360 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:46:59.851114 [debug] [ThreadPool]: On list_logistics: Close
[0m13:46:59.852274 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_logistics, now create_logistics_main)
[0m13:46:59.852612 [debug] [ThreadPool]: Creating schema "database: "logistics"
schema: "main"
"
[0m13:46:59.855687 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m13:46:59.855895 [debug] [ThreadPool]: On create_logistics_main: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "create_logistics_main"} */

    
        select type from duckdb_databases()
        where database_name='logistics'
        and type='sqlite'
    
  
[0m13:46:59.856058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:46:59.858187 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:46:59.858763 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m13:46:59.858957 [debug] [ThreadPool]: On create_logistics_main: BEGIN
[0m13:46:59.859148 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:46:59.859296 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m13:46:59.859435 [debug] [ThreadPool]: On create_logistics_main: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "create_logistics_main"} */

    
    
        create schema if not exists "logistics"."main"
    
[0m13:46:59.859730 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:46:59.860328 [debug] [ThreadPool]: On create_logistics_main: COMMIT
[0m13:46:59.860512 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m13:46:59.860677 [debug] [ThreadPool]: On create_logistics_main: COMMIT
[0m13:46:59.860903 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:46:59.861098 [debug] [ThreadPool]: On create_logistics_main: Close
[0m13:46:59.862528 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_logistics_main, now list_logistics_main)
[0m13:46:59.864983 [debug] [ThreadPool]: Using duckdb connection "list_logistics_main"
[0m13:46:59.865181 [debug] [ThreadPool]: On list_logistics_main: BEGIN
[0m13:46:59.865347 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:46:59.867328 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:46:59.867526 [debug] [ThreadPool]: Using duckdb connection "list_logistics_main"
[0m13:46:59.867695 [debug] [ThreadPool]: On list_logistics_main: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "list_logistics_main"} */
select
      'logistics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'logistics'
  
[0m13:46:59.873255 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:46:59.874146 [debug] [ThreadPool]: On list_logistics_main: ROLLBACK
[0m13:46:59.874490 [debug] [ThreadPool]: Failed to rollback 'list_logistics_main'
[0m13:46:59.874660 [debug] [ThreadPool]: On list_logistics_main: Close
[0m13:46:59.875795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d73db08-0ff9-4b4a-88ca-f64b845f389d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cd6a790>]}
[0m13:46:59.876054 [debug] [MainThread]: Using duckdb connection "master"
[0m13:46:59.876224 [debug] [MainThread]: On master: BEGIN
[0m13:46:59.876387 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:46:59.878401 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:46:59.878576 [debug] [MainThread]: On master: COMMIT
[0m13:46:59.878752 [debug] [MainThread]: Using duckdb connection "master"
[0m13:46:59.878926 [debug] [MainThread]: On master: COMMIT
[0m13:46:59.879108 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:46:59.879270 [debug] [MainThread]: On master: Close
[0m13:46:59.880076 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:46:59.880323 [info ] [MainThread]: 
[0m13:46:59.883943 [debug] [Thread-1  ]: Began running node model.logistics_analytics.stg_shipments
[0m13:46:59.884227 [info ] [Thread-1  ]: 1 of 2 START sql view model main.stg_shipments ................................. [RUN]
[0m13:46:59.884655 [debug] [Thread-1  ]: Acquiring new duckdb connection 'model.logistics_analytics.stg_shipments'
[0m13:46:59.884894 [debug] [Thread-1  ]: Began compiling node model.logistics_analytics.stg_shipments
[0m13:46:59.888187 [debug] [Thread-1  ]: Writing injected SQL for node "model.logistics_analytics.stg_shipments"
[0m13:46:59.889116 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.stg_shipments (compile): 13:46:59.885026 => 13:46:59.889001
[0m13:46:59.889309 [debug] [Thread-1  ]: Began executing node model.logistics_analytics.stg_shipments
[0m13:46:59.902882 [debug] [Thread-1  ]: Writing runtime sql for node "model.logistics_analytics.stg_shipments"
[0m13:46:59.903551 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m13:46:59.903751 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: BEGIN
[0m13:46:59.903938 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:46:59.906134 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m13:46:59.906341 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m13:46:59.906514 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */

  
  create view "logistics"."main"."stg_shipments__dbt_tmp" as (
    select
    shipment_id,
    carrier,
    origin,
    destination,

    cast(order_date as date) as order_date,
    cast(delivery_date as date) as delivery_date,
    cast(expected_delivery_date as date) as expected_delivery_date,

    distance_km,

    datediff(
        'day',
        cast(order_date as date),
        cast(delivery_date as date)
    ) as delivery_days,

    case
        when cast(delivery_date as date) > cast(expected_delivery_date as date)
            then 1
        else 0
    end as is_delayed

from read_parquet('../../data/parquet/shipments.parquet')
  );

[0m13:46:59.907228 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m13:46:59.910442 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m13:46:59.910647 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */
alter view "logistics"."main"."stg_shipments__dbt_tmp" rename to "stg_shipments"
[0m13:46:59.910917 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m13:46:59.917140 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: COMMIT
[0m13:46:59.917350 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m13:46:59.917539 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: COMMIT
[0m13:46:59.917952 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m13:46:59.920073 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m13:46:59.920258 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */
drop view if exists "logistics"."main"."stg_shipments__dbt_backup" cascade
[0m13:46:59.920508 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m13:46:59.921213 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.stg_shipments (execute): 13:46:59.889437 => 13:46:59.921109
[0m13:46:59.921400 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: Close
[0m13:46:59.922913 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d73db08-0ff9-4b4a-88ca-f64b845f389d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ccc3580>]}
[0m13:46:59.923249 [info ] [Thread-1  ]: 1 of 2 OK created sql view model main.stg_shipments ............................ [[32mOK[0m in 0.04s]
[0m13:46:59.923598 [debug] [Thread-1  ]: Finished running node model.logistics_analytics.stg_shipments
[0m13:46:59.924165 [debug] [Thread-1  ]: Began running node model.logistics_analytics.carrier_performance
[0m13:46:59.924675 [info ] [Thread-1  ]: 2 of 2 START sql view model main.carrier_performance ........................... [RUN]
[0m13:46:59.925461 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.logistics_analytics.stg_shipments, now model.logistics_analytics.carrier_performance)
[0m13:46:59.925907 [debug] [Thread-1  ]: Began compiling node model.logistics_analytics.carrier_performance
[0m13:46:59.927430 [debug] [Thread-1  ]: Writing injected SQL for node "model.logistics_analytics.carrier_performance"
[0m13:46:59.928173 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.carrier_performance (compile): 13:46:59.926055 => 13:46:59.928056
[0m13:46:59.928348 [debug] [Thread-1  ]: Began executing node model.logistics_analytics.carrier_performance
[0m13:46:59.930127 [debug] [Thread-1  ]: Writing runtime sql for node "model.logistics_analytics.carrier_performance"
[0m13:46:59.930570 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m13:46:59.930759 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: BEGIN
[0m13:46:59.930937 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:46:59.933200 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m13:46:59.933436 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m13:46:59.933849 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */

  
  create view "logistics"."main"."carrier_performance__dbt_tmp" as (
    select
    carrier,
    count(*) as total_shipments,
    round(avg(delivery_days), 2) as avg_delivery_days,
    round(100.0 * avg(is_delayed), 2) as delay_rate_pct
from "logistics"."main"."stg_shipments"
group by carrier
  );

[0m13:46:59.934978 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m13:46:59.936750 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m13:46:59.936952 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */
alter view "logistics"."main"."carrier_performance__dbt_tmp" rename to "carrier_performance"
[0m13:46:59.937234 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m13:46:59.938018 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: COMMIT
[0m13:46:59.938427 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m13:46:59.938729 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: COMMIT
[0m13:46:59.939189 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m13:46:59.940479 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m13:46:59.940675 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */
drop view if exists "logistics"."main"."carrier_performance__dbt_backup" cascade
[0m13:46:59.940949 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m13:46:59.941642 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.carrier_performance (execute): 13:46:59.928454 => 13:46:59.941539
[0m13:46:59.941851 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: Close
[0m13:46:59.943732 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d73db08-0ff9-4b4a-88ca-f64b845f389d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ccd34f0>]}
[0m13:46:59.944080 [info ] [Thread-1  ]: 2 of 2 OK created sql view model main.carrier_performance ...................... [[32mOK[0m in 0.02s]
[0m13:46:59.944463 [debug] [Thread-1  ]: Finished running node model.logistics_analytics.carrier_performance
[0m13:46:59.945338 [debug] [MainThread]: Using duckdb connection "master"
[0m13:46:59.945560 [debug] [MainThread]: On master: BEGIN
[0m13:46:59.945746 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:46:59.949102 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:46:59.949304 [debug] [MainThread]: On master: COMMIT
[0m13:46:59.949470 [debug] [MainThread]: Using duckdb connection "master"
[0m13:46:59.949638 [debug] [MainThread]: On master: COMMIT
[0m13:46:59.950000 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:46:59.950187 [debug] [MainThread]: On master: Close
[0m13:46:59.951045 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:46:59.951225 [debug] [MainThread]: Connection 'list_logistics_main' was properly closed.
[0m13:46:59.951368 [debug] [MainThread]: Connection 'model.logistics_analytics.carrier_performance' was properly closed.
[0m13:46:59.951547 [info ] [MainThread]: 
[0m13:46:59.951775 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m13:46:59.952258 [debug] [MainThread]: Command end result
[0m13:46:59.957875 [info ] [MainThread]: 
[0m13:46:59.958196 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:46:59.958485 [info ] [MainThread]: 
[0m13:46:59.958742 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:46:59.959289 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.2902142, "process_user_time": 1.325645, "process_kernel_time": 0.109053, "process_mem_max_rss": "135584", "process_out_blocks": "3124", "process_in_blocks": "0"}
[0m13:46:59.959595 [debug] [MainThread]: Command `dbt run` succeeded at 13:46:59.959537 after 0.29 seconds
[0m13:46:59.959799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff927583d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cd2df70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ccc3580>]}
[0m13:46:59.960026 [debug] [MainThread]: Flushing usage events
[0m13:53:13.988460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84cc4340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82a355e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82a35850>]}


============================== 13:53:13.990870 | c34d50c2-f0cf-48be-9529-1ebb24cd9ead ==============================
[0m13:53:13.990870 [info ] [MainThread]: Running with dbt=1.7.18
[0m13:53:13.991142 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logistics_analytics/logs', 'profiles_dir': '/opt/airflow/dbt/logistics_analytics', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:53:14.079871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c34d50c2-f0cf-48be-9529-1ebb24cd9ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff829a6b80>]}
[0m13:53:14.104202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c34d50c2-f0cf-48be-9529-1ebb24cd9ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82a35250>]}
[0m13:53:14.104611 [info ] [MainThread]: Registered adapter: duckdb=1.7.5
[0m13:53:14.108801 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m13:53:14.123608 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:53:14.123824 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:53:14.124116 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.logistics_analytics.marts
[0m13:53:14.126786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c34d50c2-f0cf-48be-9529-1ebb24cd9ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fb50eb0>]}
[0m13:53:14.133064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c34d50c2-f0cf-48be-9529-1ebb24cd9ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8294ad30>]}
[0m13:53:14.133324 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m13:53:14.133523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c34d50c2-f0cf-48be-9529-1ebb24cd9ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82669220>]}
[0m13:53:14.134159 [info ] [MainThread]: 
[0m13:53:14.134520 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:53:14.135116 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_logistics'
[0m13:53:14.140460 [debug] [ThreadPool]: Using duckdb connection "list_logistics"
[0m13:53:14.140668 [debug] [ThreadPool]: On list_logistics: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "list_logistics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"logistics"'
    
  
  
[0m13:53:14.140839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:53:14.144974 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:53:14.145679 [debug] [ThreadPool]: On list_logistics: Close
[0m13:53:14.146767 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_logistics, now create_logistics_main)
[0m13:53:14.147092 [debug] [ThreadPool]: Creating schema "database: "logistics"
schema: "main"
"
[0m13:53:14.150025 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m13:53:14.150216 [debug] [ThreadPool]: On create_logistics_main: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "create_logistics_main"} */

    
        select type from duckdb_databases()
        where database_name='logistics'
        and type='sqlite'
    
  
[0m13:53:14.150376 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:53:14.152444 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:53:14.152989 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m13:53:14.153172 [debug] [ThreadPool]: On create_logistics_main: BEGIN
[0m13:53:14.153358 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:53:14.153514 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m13:53:14.153669 [debug] [ThreadPool]: On create_logistics_main: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "create_logistics_main"} */

    
    
        create schema if not exists "logistics"."main"
    
[0m13:53:14.153894 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:53:14.154250 [debug] [ThreadPool]: On create_logistics_main: COMMIT
[0m13:53:14.154471 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m13:53:14.154723 [debug] [ThreadPool]: On create_logistics_main: COMMIT
[0m13:53:14.154968 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:53:14.155148 [debug] [ThreadPool]: On create_logistics_main: Close
[0m13:53:14.156446 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_logistics_main, now list_logistics_main)
[0m13:53:14.158802 [debug] [ThreadPool]: Using duckdb connection "list_logistics_main"
[0m13:53:14.159014 [debug] [ThreadPool]: On list_logistics_main: BEGIN
[0m13:53:14.159202 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:53:14.161250 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:53:14.161430 [debug] [ThreadPool]: Using duckdb connection "list_logistics_main"
[0m13:53:14.161612 [debug] [ThreadPool]: On list_logistics_main: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "list_logistics_main"} */
select
      'logistics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'logistics'
  
[0m13:53:14.167469 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:53:14.168336 [debug] [ThreadPool]: On list_logistics_main: ROLLBACK
[0m13:53:14.168655 [debug] [ThreadPool]: Failed to rollback 'list_logistics_main'
[0m13:53:14.168844 [debug] [ThreadPool]: On list_logistics_main: Close
[0m13:53:14.170040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c34d50c2-f0cf-48be-9529-1ebb24cd9ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fb27790>]}
[0m13:53:14.170281 [debug] [MainThread]: Using duckdb connection "master"
[0m13:53:14.170453 [debug] [MainThread]: On master: BEGIN
[0m13:53:14.170615 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:53:14.172583 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:53:14.172754 [debug] [MainThread]: On master: COMMIT
[0m13:53:14.172925 [debug] [MainThread]: Using duckdb connection "master"
[0m13:53:14.173115 [debug] [MainThread]: On master: COMMIT
[0m13:53:14.173304 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:53:14.173468 [debug] [MainThread]: On master: Close
[0m13:53:14.174263 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:53:14.174479 [info ] [MainThread]: 
[0m13:53:14.177558 [debug] [Thread-1  ]: Began running node model.logistics_analytics.stg_shipments
[0m13:53:14.177827 [info ] [Thread-1  ]: 1 of 2 START sql view model main.stg_shipments ................................. [RUN]
[0m13:53:14.178227 [debug] [Thread-1  ]: Acquiring new duckdb connection 'model.logistics_analytics.stg_shipments'
[0m13:53:14.178419 [debug] [Thread-1  ]: Began compiling node model.logistics_analytics.stg_shipments
[0m13:53:14.181605 [debug] [Thread-1  ]: Writing injected SQL for node "model.logistics_analytics.stg_shipments"
[0m13:53:14.182487 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.stg_shipments (compile): 13:53:14.178546 => 13:53:14.182374
[0m13:53:14.182679 [debug] [Thread-1  ]: Began executing node model.logistics_analytics.stg_shipments
[0m13:53:14.196038 [debug] [Thread-1  ]: Writing runtime sql for node "model.logistics_analytics.stg_shipments"
[0m13:53:14.196815 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m13:53:14.197039 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: BEGIN
[0m13:53:14.197246 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:53:14.199457 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m13:53:14.199640 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m13:53:14.199841 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */

  
  create view "logistics"."main"."stg_shipments__dbt_tmp" as (
    select
    shipment_id,
    carrier,
    origin,
    destination,

    cast(order_date as date) as order_date,
    cast(delivery_date as date) as delivery_date,
    cast(expected_delivery_date as date) as expected_delivery_date,

    distance_km,

    datediff(
        'day',
        cast(order_date as date),
        cast(delivery_date as date)
    ) as delivery_days,

    case
        when cast(delivery_date as date) > cast(expected_delivery_date as date)
            then 1
        else 0
    end as is_delayed

from read_parquet('../../data/parquet/shipments.parquet')
  );

[0m13:53:14.200537 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m13:53:14.203781 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m13:53:14.203981 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */
alter view "logistics"."main"."stg_shipments__dbt_tmp" rename to "stg_shipments"
[0m13:53:14.204226 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m13:53:14.210243 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: COMMIT
[0m13:53:14.210472 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m13:53:14.210679 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: COMMIT
[0m13:53:14.211136 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m13:53:14.213523 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m13:53:14.213728 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */
drop view if exists "logistics"."main"."stg_shipments__dbt_backup" cascade
[0m13:53:14.214010 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m13:53:14.214641 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.stg_shipments (execute): 13:53:14.182805 => 13:53:14.214551
[0m13:53:14.214823 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: Close
[0m13:53:14.216333 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c34d50c2-f0cf-48be-9529-1ebb24cd9ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fa82580>]}
[0m13:53:14.216620 [info ] [Thread-1  ]: 1 of 2 OK created sql view model main.stg_shipments ............................ [[32mOK[0m in 0.04s]
[0m13:53:14.216939 [debug] [Thread-1  ]: Finished running node model.logistics_analytics.stg_shipments
[0m13:53:14.217387 [debug] [Thread-1  ]: Began running node model.logistics_analytics.carrier_performance
[0m13:53:14.217617 [info ] [Thread-1  ]: 2 of 2 START sql view model main.carrier_performance ........................... [RUN]
[0m13:53:14.217956 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.logistics_analytics.stg_shipments, now model.logistics_analytics.carrier_performance)
[0m13:53:14.218162 [debug] [Thread-1  ]: Began compiling node model.logistics_analytics.carrier_performance
[0m13:53:14.219399 [debug] [Thread-1  ]: Writing injected SQL for node "model.logistics_analytics.carrier_performance"
[0m13:53:14.220009 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.carrier_performance (compile): 13:53:14.218286 => 13:53:14.219910
[0m13:53:14.220200 [debug] [Thread-1  ]: Began executing node model.logistics_analytics.carrier_performance
[0m13:53:14.221929 [debug] [Thread-1  ]: Writing runtime sql for node "model.logistics_analytics.carrier_performance"
[0m13:53:14.222361 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m13:53:14.222543 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: BEGIN
[0m13:53:14.222716 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:53:14.225705 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m13:53:14.225893 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m13:53:14.226079 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */

  
  create view "logistics"."main"."carrier_performance__dbt_tmp" as (
    select
    carrier,
    count(*) as total_shipments,
    round(avg(delivery_days), 2) as avg_delivery_days,
    round(100.0 * avg(is_delayed), 2) as delay_rate_pct
from "logistics"."main"."stg_shipments"
group by carrier
  );

[0m13:53:14.226924 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m13:53:14.228448 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m13:53:14.228625 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */
alter view "logistics"."main"."carrier_performance__dbt_tmp" rename to "carrier_performance"
[0m13:53:14.228854 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m13:53:14.229516 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: COMMIT
[0m13:53:14.229702 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m13:53:14.229872 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: COMMIT
[0m13:53:14.230178 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m13:53:14.231294 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m13:53:14.231487 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */
drop view if exists "logistics"."main"."carrier_performance__dbt_backup" cascade
[0m13:53:14.231714 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m13:53:14.232304 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.carrier_performance (execute): 13:53:14.220320 => 13:53:14.232208
[0m13:53:14.232493 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: Close
[0m13:53:14.234443 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c34d50c2-f0cf-48be-9529-1ebb24cd9ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fa914f0>]}
[0m13:53:14.234721 [info ] [Thread-1  ]: 2 of 2 OK created sql view model main.carrier_performance ...................... [[32mOK[0m in 0.02s]
[0m13:53:14.235010 [debug] [Thread-1  ]: Finished running node model.logistics_analytics.carrier_performance
[0m13:53:14.235660 [debug] [MainThread]: Using duckdb connection "master"
[0m13:53:14.235840 [debug] [MainThread]: On master: BEGIN
[0m13:53:14.236005 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:53:14.238420 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:53:14.238589 [debug] [MainThread]: On master: COMMIT
[0m13:53:14.238732 [debug] [MainThread]: Using duckdb connection "master"
[0m13:53:14.238881 [debug] [MainThread]: On master: COMMIT
[0m13:53:14.239040 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:53:14.239210 [debug] [MainThread]: On master: Close
[0m13:53:14.239977 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:53:14.240149 [debug] [MainThread]: Connection 'list_logistics_main' was properly closed.
[0m13:53:14.240299 [debug] [MainThread]: Connection 'model.logistics_analytics.carrier_performance' was properly closed.
[0m13:53:14.240468 [info ] [MainThread]: 
[0m13:53:14.240650 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m13:53:14.241021 [debug] [MainThread]: Command end result
[0m13:53:14.245317 [info ] [MainThread]: 
[0m13:53:14.245550 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:53:14.245731 [info ] [MainThread]: 
[0m13:53:14.245912 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:53:14.246328 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.27688092, "process_user_time": 1.331916, "process_kernel_time": 0.119081, "process_mem_max_rss": "145348", "process_in_blocks": "2056", "process_out_blocks": "4804"}
[0m13:53:14.246593 [debug] [MainThread]: Command `dbt run` succeeded at 13:53:14.246534 after 0.28 seconds
[0m13:53:14.246798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84cc4340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff829bc940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8296ee80>]}
[0m13:53:14.247011 [debug] [MainThread]: Flushing usage events
[0m13:54:17.967149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff816253d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f479610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f479880>]}


============================== 13:54:17.970026 | ccb94a8d-28c6-4649-9e4c-3254bc0141f8 ==============================
[0m13:54:17.970026 [info ] [MainThread]: Running with dbt=1.7.18
[0m13:54:17.970331 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/logistics_analytics', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logistics_analytics/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:54:18.065894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ccb94a8d-28c6-4649-9e4c-3254bc0141f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f3a6bb0>]}
[0m13:54:18.092413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ccb94a8d-28c6-4649-9e4c-3254bc0141f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f470b20>]}
[0m13:54:18.092934 [info ] [MainThread]: Registered adapter: duckdb=1.7.5
[0m13:54:18.097223 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m13:54:18.110381 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:54:18.110599 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:54:18.110898 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.logistics_analytics.marts
[0m13:54:18.113723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ccb94a8d-28c6-4649-9e4c-3254bc0141f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c4d2ee0>]}
[0m13:54:18.120167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ccb94a8d-28c6-4649-9e4c-3254bc0141f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c5a8250>]}
[0m13:54:18.120389 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m13:54:18.120580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccb94a8d-28c6-4649-9e4c-3254bc0141f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c5a8040>]}
[0m13:54:18.121216 [info ] [MainThread]: 
[0m13:54:18.121570 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:54:18.122197 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_logistics'
[0m13:54:18.127866 [debug] [ThreadPool]: Using duckdb connection "list_logistics"
[0m13:54:18.128083 [debug] [ThreadPool]: On list_logistics: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "list_logistics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"logistics"'
    
  
  
[0m13:54:18.128265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:18.139907 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:54:18.140913 [debug] [ThreadPool]: On list_logistics: Close
[0m13:54:18.142424 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_logistics, now create_logistics_main)
[0m13:54:18.142860 [debug] [ThreadPool]: Creating schema "database: "logistics"
schema: "main"
"
[0m13:54:18.146398 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m13:54:18.146680 [debug] [ThreadPool]: On create_logistics_main: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "create_logistics_main"} */

    
        select type from duckdb_databases()
        where database_name='logistics'
        and type='sqlite'
    
  
[0m13:54:18.146901 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:18.150838 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:54:18.151703 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m13:54:18.151968 [debug] [ThreadPool]: On create_logistics_main: BEGIN
[0m13:54:18.152224 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:54:18.152416 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m13:54:18.152603 [debug] [ThreadPool]: On create_logistics_main: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "create_logistics_main"} */

    
    
        create schema if not exists "logistics"."main"
    
[0m13:54:18.152891 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:54:18.153308 [debug] [ThreadPool]: On create_logistics_main: COMMIT
[0m13:54:18.153504 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m13:54:18.153692 [debug] [ThreadPool]: On create_logistics_main: COMMIT
[0m13:54:18.153932 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:54:18.154126 [debug] [ThreadPool]: On create_logistics_main: Close
[0m13:54:18.155836 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_logistics_main, now list_logistics_main)
[0m13:54:18.158739 [debug] [ThreadPool]: Using duckdb connection "list_logistics_main"
[0m13:54:18.158996 [debug] [ThreadPool]: On list_logistics_main: BEGIN
[0m13:54:18.159200 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:18.162381 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:54:18.162645 [debug] [ThreadPool]: Using duckdb connection "list_logistics_main"
[0m13:54:18.162842 [debug] [ThreadPool]: On list_logistics_main: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "list_logistics_main"} */
select
      'logistics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'logistics'
  
[0m13:54:18.168333 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:54:18.169170 [debug] [ThreadPool]: On list_logistics_main: ROLLBACK
[0m13:54:18.169881 [debug] [ThreadPool]: Failed to rollback 'list_logistics_main'
[0m13:54:18.170066 [debug] [ThreadPool]: On list_logistics_main: Close
[0m13:54:18.171375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccb94a8d-28c6-4649-9e4c-3254bc0141f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c4ab7c0>]}
[0m13:54:18.171639 [debug] [MainThread]: Using duckdb connection "master"
[0m13:54:18.171828 [debug] [MainThread]: On master: BEGIN
[0m13:54:18.171984 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:54:18.174590 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:54:18.174814 [debug] [MainThread]: On master: COMMIT
[0m13:54:18.174988 [debug] [MainThread]: Using duckdb connection "master"
[0m13:54:18.175159 [debug] [MainThread]: On master: COMMIT
[0m13:54:18.175353 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:54:18.175519 [debug] [MainThread]: On master: Close
[0m13:54:18.176288 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:54:18.176513 [info ] [MainThread]: 
[0m13:54:18.179933 [debug] [Thread-1  ]: Began running node model.logistics_analytics.stg_shipments
[0m13:54:18.180202 [info ] [Thread-1  ]: 1 of 2 START sql view model main.stg_shipments ................................. [RUN]
[0m13:54:18.180577 [debug] [Thread-1  ]: Acquiring new duckdb connection 'model.logistics_analytics.stg_shipments'
[0m13:54:18.180803 [debug] [Thread-1  ]: Began compiling node model.logistics_analytics.stg_shipments
[0m13:54:18.183994 [debug] [Thread-1  ]: Writing injected SQL for node "model.logistics_analytics.stg_shipments"
[0m13:54:18.184661 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.stg_shipments (compile): 13:54:18.180936 => 13:54:18.184550
[0m13:54:18.184875 [debug] [Thread-1  ]: Began executing node model.logistics_analytics.stg_shipments
[0m13:54:18.198833 [debug] [Thread-1  ]: Writing runtime sql for node "model.logistics_analytics.stg_shipments"
[0m13:54:18.199410 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m13:54:18.199596 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: BEGIN
[0m13:54:18.199766 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:54:18.202245 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m13:54:18.202427 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m13:54:18.202604 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */

  
  create view "logistics"."main"."stg_shipments__dbt_tmp" as (
    select
    shipment_id,
    carrier,
    origin,
    destination,

    cast(order_date as date) as order_date,
    cast(delivery_date as date) as delivery_date,
    cast(expected_delivery_date as date) as expected_delivery_date,

    distance_km,

    datediff(
        'day',
        cast(order_date as date),
        cast(delivery_date as date)
    ) as delivery_days,

    case
        when cast(delivery_date as date) > cast(expected_delivery_date as date)
            then 1
        else 0
    end as is_delayed

from read_parquet('../../data/parquet/shipments.parquet')
  );

[0m13:54:18.203238 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m13:54:18.206604 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m13:54:18.206829 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */
alter view "logistics"."main"."stg_shipments" rename to "stg_shipments__dbt_backup"
[0m13:54:18.207076 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m13:54:18.208421 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m13:54:18.208648 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */
alter view "logistics"."main"."stg_shipments__dbt_tmp" rename to "stg_shipments"
[0m13:54:18.208908 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m13:54:18.216065 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: COMMIT
[0m13:54:18.216312 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m13:54:18.216510 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: COMMIT
[0m13:54:18.216962 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m13:54:18.219093 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m13:54:18.219293 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */
drop view if exists "logistics"."main"."stg_shipments__dbt_backup" cascade
[0m13:54:18.219639 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m13:54:18.220271 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.stg_shipments (execute): 13:54:18.185015 => 13:54:18.220180
[0m13:54:18.220471 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: Close
[0m13:54:18.223060 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccb94a8d-28c6-4649-9e4c-3254bc0141f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bbcce80>]}
[0m13:54:18.223393 [info ] [Thread-1  ]: 1 of 2 OK created sql view model main.stg_shipments ............................ [[32mOK[0m in 0.04s]
[0m13:54:18.223709 [debug] [Thread-1  ]: Finished running node model.logistics_analytics.stg_shipments
[0m13:54:18.224097 [debug] [Thread-1  ]: Began running node model.logistics_analytics.carrier_performance
[0m13:54:18.224383 [info ] [Thread-1  ]: 2 of 2 START sql view model main.carrier_performance ........................... [RUN]
[0m13:54:18.224701 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.logistics_analytics.stg_shipments, now model.logistics_analytics.carrier_performance)
[0m13:54:18.224905 [debug] [Thread-1  ]: Began compiling node model.logistics_analytics.carrier_performance
[0m13:54:18.226158 [debug] [Thread-1  ]: Writing injected SQL for node "model.logistics_analytics.carrier_performance"
[0m13:54:18.226811 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.carrier_performance (compile): 13:54:18.225065 => 13:54:18.226705
[0m13:54:18.226995 [debug] [Thread-1  ]: Began executing node model.logistics_analytics.carrier_performance
[0m13:54:18.228688 [debug] [Thread-1  ]: Writing runtime sql for node "model.logistics_analytics.carrier_performance"
[0m13:54:18.229114 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m13:54:18.229304 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: BEGIN
[0m13:54:18.229463 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:18.232097 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m13:54:18.232280 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m13:54:18.232459 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */

  
  create view "logistics"."main"."carrier_performance__dbt_tmp" as (
    select
    carrier,
    count(*) as total_shipments,
    round(avg(delivery_days), 2) as avg_delivery_days,
    round(100.0 * avg(is_delayed), 2) as delay_rate_pct
from "logistics"."main"."stg_shipments"
group by carrier
  );

[0m13:54:18.232999 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m13:54:18.234490 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m13:54:18.234716 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */
alter view "logistics"."main"."carrier_performance" rename to "carrier_performance__dbt_backup"
[0m13:54:18.235069 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m13:54:18.236479 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m13:54:18.236697 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */
alter view "logistics"."main"."carrier_performance__dbt_tmp" rename to "carrier_performance"
[0m13:54:18.236935 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m13:54:18.237705 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: COMMIT
[0m13:54:18.237904 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m13:54:18.238084 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: COMMIT
[0m13:54:18.238390 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m13:54:18.240017 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m13:54:18.240213 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */
drop view if exists "logistics"."main"."carrier_performance__dbt_backup" cascade
[0m13:54:18.240499 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m13:54:18.241124 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.carrier_performance (execute): 13:54:18.227116 => 13:54:18.241010
[0m13:54:18.241359 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: Close
[0m13:54:18.244094 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccb94a8d-28c6-4649-9e4c-3254bc0141f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c47e160>]}
[0m13:54:18.244405 [info ] [Thread-1  ]: 2 of 2 OK created sql view model main.carrier_performance ...................... [[32mOK[0m in 0.02s]
[0m13:54:18.244706 [debug] [Thread-1  ]: Finished running node model.logistics_analytics.carrier_performance
[0m13:54:18.245424 [debug] [MainThread]: Using duckdb connection "master"
[0m13:54:18.245633 [debug] [MainThread]: On master: BEGIN
[0m13:54:18.245827 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:54:18.248679 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:54:18.248861 [debug] [MainThread]: On master: COMMIT
[0m13:54:18.249030 [debug] [MainThread]: Using duckdb connection "master"
[0m13:54:18.249193 [debug] [MainThread]: On master: COMMIT
[0m13:54:18.249358 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:54:18.249505 [debug] [MainThread]: On master: Close
[0m13:54:18.250280 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:54:18.250438 [debug] [MainThread]: Connection 'list_logistics_main' was properly closed.
[0m13:54:18.250574 [debug] [MainThread]: Connection 'model.logistics_analytics.carrier_performance' was properly closed.
[0m13:54:18.250744 [info ] [MainThread]: 
[0m13:54:18.250940 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m13:54:18.251301 [debug] [MainThread]: Command end result
[0m13:54:18.274897 [info ] [MainThread]: 
[0m13:54:18.275157 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:54:18.275333 [info ] [MainThread]: 
[0m13:54:18.275511 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:54:18.275918 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.32712096, "process_user_time": 1.461779, "process_kernel_time": 0.106347, "process_mem_max_rss": "145532", "process_in_blocks": "1432", "process_out_blocks": "3615"}
[0m13:54:18.276174 [debug] [MainThread]: Command `dbt run` succeeded at 13:54:18.276119 after 0.33 seconds
[0m13:54:18.276382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff816253d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f1e4190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f470b20>]}
[0m13:54:18.276653 [debug] [MainThread]: Flushing usage events
[0m14:07:14.448733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3bc75e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb190f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb190fb80>]}


============================== 14:07:14.451657 | 8606f34c-c915-45ad-b4fd-3302aea62d06 ==============================
[0m14:07:14.451657 [info ] [MainThread]: Running with dbt=1.7.18
[0m14:07:14.452151 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/logistics_analytics', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logistics_analytics/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:07:14.549003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8606f34c-c915-45ad-b4fd-3302aea62d06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2a36d30>]}
[0m14:07:14.574878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8606f34c-c915-45ad-b4fd-3302aea62d06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb173e130>]}
[0m14:07:14.575383 [info ] [MainThread]: Registered adapter: duckdb=1.7.5
[0m14:07:14.580038 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m14:07:14.593566 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:07:14.593851 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:07:14.594170 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.logistics_analytics.marts
[0m14:07:14.597207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8606f34c-c915-45ad-b4fd-3302aea62d06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaea52f10>]}
[0m14:07:14.604323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8606f34c-c915-45ad-b4fd-3302aea62d06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaeb26130>]}
[0m14:07:14.604621 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m14:07:14.604862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8606f34c-c915-45ad-b4fd-3302aea62d06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb166d8e0>]}
[0m14:07:14.605615 [info ] [MainThread]: 
[0m14:07:14.606062 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:07:14.606720 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_logistics'
[0m14:07:14.612640 [debug] [ThreadPool]: Using duckdb connection "list_logistics"
[0m14:07:14.612909 [debug] [ThreadPool]: On list_logistics: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "list_logistics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"logistics"'
    
  
  
[0m14:07:14.613231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:14.617258 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:14.618003 [debug] [ThreadPool]: On list_logistics: Close
[0m14:07:14.619630 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_logistics, now create_logistics_main)
[0m14:07:14.619984 [debug] [ThreadPool]: Creating schema "database: "logistics"
schema: "main"
"
[0m14:07:14.623645 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m14:07:14.623864 [debug] [ThreadPool]: On create_logistics_main: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "create_logistics_main"} */

    
        select type from duckdb_databases()
        where database_name='logistics'
        and type='sqlite'
    
  
[0m14:07:14.624033 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:07:14.626476 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:14.627283 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m14:07:14.627477 [debug] [ThreadPool]: On create_logistics_main: BEGIN
[0m14:07:14.627700 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:14.627863 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m14:07:14.628021 [debug] [ThreadPool]: On create_logistics_main: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "create_logistics_main"} */

    
    
        create schema if not exists "logistics"."main"
    
[0m14:07:14.628249 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:14.628690 [debug] [ThreadPool]: On create_logistics_main: COMMIT
[0m14:07:14.628902 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m14:07:14.629100 [debug] [ThreadPool]: On create_logistics_main: COMMIT
[0m14:07:14.629350 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:14.629550 [debug] [ThreadPool]: On create_logistics_main: Close
[0m14:07:14.631062 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_logistics_main, now list_logistics_main)
[0m14:07:14.633691 [debug] [ThreadPool]: Using duckdb connection "list_logistics_main"
[0m14:07:14.633888 [debug] [ThreadPool]: On list_logistics_main: BEGIN
[0m14:07:14.634070 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:07:14.636421 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:14.636624 [debug] [ThreadPool]: Using duckdb connection "list_logistics_main"
[0m14:07:14.636821 [debug] [ThreadPool]: On list_logistics_main: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "list_logistics_main"} */
select
      'logistics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'logistics'
  
[0m14:07:14.642843 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:07:14.643936 [debug] [ThreadPool]: On list_logistics_main: ROLLBACK
[0m14:07:14.644265 [debug] [ThreadPool]: Failed to rollback 'list_logistics_main'
[0m14:07:14.644473 [debug] [ThreadPool]: On list_logistics_main: Close
[0m14:07:14.645709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8606f34c-c915-45ad-b4fd-3302aea62d06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1651700>]}
[0m14:07:14.646069 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:14.646261 [debug] [MainThread]: On master: BEGIN
[0m14:07:14.646460 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:07:14.648747 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:14.648954 [debug] [MainThread]: On master: COMMIT
[0m14:07:14.649152 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:14.649347 [debug] [MainThread]: On master: COMMIT
[0m14:07:14.649561 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:14.649749 [debug] [MainThread]: On master: Close
[0m14:07:14.650682 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:07:14.650922 [info ] [MainThread]: 
[0m14:07:14.656073 [debug] [Thread-1  ]: Began running node model.logistics_analytics.stg_shipments
[0m14:07:14.656738 [info ] [Thread-1  ]: 1 of 2 START sql view model main.stg_shipments ................................. [RUN]
[0m14:07:14.657516 [debug] [Thread-1  ]: Acquiring new duckdb connection 'model.logistics_analytics.stg_shipments'
[0m14:07:14.657959 [debug] [Thread-1  ]: Began compiling node model.logistics_analytics.stg_shipments
[0m14:07:14.662024 [debug] [Thread-1  ]: Writing injected SQL for node "model.logistics_analytics.stg_shipments"
[0m14:07:14.662960 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.stg_shipments (compile): 14:07:14.658168 => 14:07:14.662802
[0m14:07:14.663209 [debug] [Thread-1  ]: Began executing node model.logistics_analytics.stg_shipments
[0m14:07:14.678780 [debug] [Thread-1  ]: Writing runtime sql for node "model.logistics_analytics.stg_shipments"
[0m14:07:14.679543 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m14:07:14.679794 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: BEGIN
[0m14:07:14.680019 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m14:07:14.682650 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:07:14.682894 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m14:07:14.683131 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */

  
  create view "logistics"."main"."stg_shipments__dbt_tmp" as (
    select
    shipment_id,
    carrier,
    origin,
    destination,

    cast(order_date as date) as order_date,
    cast(delivery_date as date) as delivery_date,
    cast(expected_delivery_date as date) as expected_delivery_date,

    distance_km,

    datediff(
        'day',
        cast(order_date as date),
        cast(delivery_date as date)
    ) as delivery_days,

    case
        when cast(delivery_date as date) > cast(expected_delivery_date as date)
            then 1
        else 0
    end as is_delayed

from read_parquet('../../data/parquet/shipments.parquet')
  );

[0m14:07:14.683860 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:07:14.687578 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m14:07:14.687804 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */
alter view "logistics"."main"."stg_shipments__dbt_tmp" rename to "stg_shipments"
[0m14:07:14.688073 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:07:14.695888 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: COMMIT
[0m14:07:14.696241 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m14:07:14.696496 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: COMMIT
[0m14:07:14.697079 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:07:14.699741 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m14:07:14.700028 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */
drop view if exists "logistics"."main"."stg_shipments__dbt_backup" cascade
[0m14:07:14.700379 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:07:14.701127 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.stg_shipments (execute): 14:07:14.663388 => 14:07:14.701022
[0m14:07:14.701350 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: Close
[0m14:07:14.703202 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8606f34c-c915-45ad-b4fd-3302aea62d06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae14b3d0>]}
[0m14:07:14.703583 [info ] [Thread-1  ]: 1 of 2 OK created sql view model main.stg_shipments ............................ [[32mOK[0m in 0.05s]
[0m14:07:14.703949 [debug] [Thread-1  ]: Finished running node model.logistics_analytics.stg_shipments
[0m14:07:14.704624 [debug] [Thread-1  ]: Began running node model.logistics_analytics.carrier_performance
[0m14:07:14.704900 [info ] [Thread-1  ]: 2 of 2 START sql view model main.carrier_performance ........................... [RUN]
[0m14:07:14.705329 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.logistics_analytics.stg_shipments, now model.logistics_analytics.carrier_performance)
[0m14:07:14.705557 [debug] [Thread-1  ]: Began compiling node model.logistics_analytics.carrier_performance
[0m14:07:14.707296 [debug] [Thread-1  ]: Writing injected SQL for node "model.logistics_analytics.carrier_performance"
[0m14:07:14.708153 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.carrier_performance (compile): 14:07:14.705687 => 14:07:14.708025
[0m14:07:14.708377 [debug] [Thread-1  ]: Began executing node model.logistics_analytics.carrier_performance
[0m14:07:14.710291 [debug] [Thread-1  ]: Writing runtime sql for node "model.logistics_analytics.carrier_performance"
[0m14:07:14.710822 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m14:07:14.711013 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: BEGIN
[0m14:07:14.711191 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:07:14.714928 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:07:14.715266 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m14:07:14.715831 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */

  
  create view "logistics"."main"."carrier_performance__dbt_tmp" as (
    select
    carrier,
    count(*) as total_shipments,
    round(avg(delivery_days), 2) as avg_delivery_days,
    round(100.0 * avg(is_delayed), 2) as delay_rate_pct
from "logistics"."main"."stg_shipments"
group by carrier
  );

[0m14:07:14.716644 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:07:14.718437 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m14:07:14.718641 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */
alter view "logistics"."main"."carrier_performance__dbt_tmp" rename to "carrier_performance"
[0m14:07:14.718899 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:07:14.719622 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: COMMIT
[0m14:07:14.719814 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m14:07:14.719987 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: COMMIT
[0m14:07:14.720397 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:07:14.721714 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m14:07:14.721922 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */
drop view if exists "logistics"."main"."carrier_performance__dbt_backup" cascade
[0m14:07:14.722196 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:07:14.722883 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.carrier_performance (execute): 14:07:14.708505 => 14:07:14.722784
[0m14:07:14.723083 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: Close
[0m14:07:14.725783 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8606f34c-c915-45ad-b4fd-3302aea62d06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae149a00>]}
[0m14:07:14.726118 [info ] [Thread-1  ]: 2 of 2 OK created sql view model main.carrier_performance ...................... [[32mOK[0m in 0.02s]
[0m14:07:14.726496 [debug] [Thread-1  ]: Finished running node model.logistics_analytics.carrier_performance
[0m14:07:14.727291 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:14.727511 [debug] [MainThread]: On master: BEGIN
[0m14:07:14.727682 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:07:14.732387 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:14.732701 [debug] [MainThread]: On master: COMMIT
[0m14:07:14.732881 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:14.733043 [debug] [MainThread]: On master: COMMIT
[0m14:07:14.733235 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:14.733418 [debug] [MainThread]: On master: Close
[0m14:07:14.734490 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:07:14.734670 [debug] [MainThread]: Connection 'list_logistics_main' was properly closed.
[0m14:07:14.734820 [debug] [MainThread]: Connection 'model.logistics_analytics.carrier_performance' was properly closed.
[0m14:07:14.735022 [info ] [MainThread]: 
[0m14:07:14.735261 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m14:07:14.735820 [debug] [MainThread]: Command end result
[0m14:07:14.741640 [info ] [MainThread]: 
[0m14:07:14.741938 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:07:14.742209 [info ] [MainThread]: 
[0m14:07:14.742457 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:07:14.743053 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.3154932, "process_user_time": 1.379494, "process_kernel_time": 0.13071, "process_mem_max_rss": "135612", "process_out_blocks": "3124", "process_in_blocks": "0"}
[0m14:07:14.743360 [debug] [MainThread]: Command `dbt run` succeeded at 14:07:14.743288 after 0.32 seconds
[0m14:07:14.743574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3bc75e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1776340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb173e130>]}
[0m14:07:14.743784 [debug] [MainThread]: Flushing usage events
[0m14:09:48.451102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb865e5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb64b66d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb64b69a0>]}


============================== 14:09:48.453746 | f251635f-2948-4822-b7b1-0ca7f2460618 ==============================
[0m14:09:48.453746 [info ] [MainThread]: Running with dbt=1.7.18
[0m14:09:48.454107 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/logistics_analytics', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logistics_analytics/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:09:48.548382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f251635f-2948-4822-b7b1-0ca7f2460618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb64faf10>]}
[0m14:09:48.573350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f251635f-2948-4822-b7b1-0ca7f2460618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb64b65b0>]}
[0m14:09:48.573754 [info ] [MainThread]: Registered adapter: duckdb=1.7.5
[0m14:09:48.578468 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m14:09:48.592697 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:09:48.592924 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:09:48.593221 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.logistics_analytics.marts
[0m14:09:48.596363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f251635f-2948-4822-b7b1-0ca7f2460618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3511ee0>]}
[0m14:09:48.603115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f251635f-2948-4822-b7b1-0ca7f2460618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb35ea100>]}
[0m14:09:48.603348 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m14:09:48.603545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f251635f-2948-4822-b7b1-0ca7f2460618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb35ea0d0>]}
[0m14:09:48.604248 [info ] [MainThread]: 
[0m14:09:48.604669 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:09:48.605282 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_logistics'
[0m14:09:48.610785 [debug] [ThreadPool]: Using duckdb connection "list_logistics"
[0m14:09:48.611005 [debug] [ThreadPool]: On list_logistics: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "list_logistics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"logistics"'
    
  
  
[0m14:09:48.611189 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:09:48.613950 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:09:48.614247 [debug] [MainThread]: Connection 'list_logistics' was properly closed.
[0m14:09:48.614468 [info ] [MainThread]: 
[0m14:09:48.614698 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.01 seconds (0.01s).
[0m14:09:48.615019 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Trying to read a database file with version number 64, but we can only read version 51.
  The database file was created with an newer version of DuckDB.
  
  The storage of DuckDB is not yet stable; newer versions of DuckDB cannot read old database files and vice versa.
  The storage will be stabilized when version 1.0 releases.
  
  For now, we recommend that you load the database file in a supported version of DuckDB, and use the EXPORT DATABASE command followed by IMPORT DATABASE on the current version of DuckDB.
  
  See the storage page for more information: https://duckdb.org/internals/storage
[0m14:09:48.615512 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.18287925, "process_user_time": 1.229773, "process_kernel_time": 0.100307, "process_mem_max_rss": "130588", "process_out_blocks": "759", "command_success": false, "process_in_blocks": "0"}
[0m14:09:48.615813 [debug] [MainThread]: Command `dbt run` failed at 14:09:48.615746 after 0.18 seconds
[0m14:09:48.616032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb865e5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb35ea250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb612d790>]}
[0m14:09:48.616237 [debug] [MainThread]: Flushing usage events
[0m14:10:03.532552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff876d7370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85576400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85576580>]}


============================== 14:10:03.534973 | 90439dce-7950-4dc2-a146-22ff9b6f143f ==============================
[0m14:10:03.534973 [info ] [MainThread]: Running with dbt=1.7.18
[0m14:10:03.535230 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/logistics_analytics', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logistics_analytics/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:10:03.611653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90439dce-7950-4dc2-a146-22ff9b6f143f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff853fedc0>]}
[0m14:10:03.635727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90439dce-7950-4dc2-a146-22ff9b6f143f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff827c6d30>]}
[0m14:10:03.636092 [info ] [MainThread]: Registered adapter: duckdb=1.7.5
[0m14:10:03.640215 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m14:10:03.652900 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:10:03.653077 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:10:03.653368 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.logistics_analytics.marts
[0m14:10:03.656119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90439dce-7950-4dc2-a146-22ff9b6f143f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81d51e50>]}
[0m14:10:03.662165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90439dce-7950-4dc2-a146-22ff9b6f143f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82669070>]}
[0m14:10:03.662388 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m14:10:03.662605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90439dce-7950-4dc2-a146-22ff9b6f143f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff827b3130>]}
[0m14:10:03.663280 [info ] [MainThread]: 
[0m14:10:03.663715 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:10:03.664347 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_logistics'
[0m14:10:03.669647 [debug] [ThreadPool]: Using duckdb connection "list_logistics"
[0m14:10:03.669837 [debug] [ThreadPool]: On list_logistics: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "list_logistics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"logistics"'
    
  
  
[0m14:10:03.670019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:10:03.674070 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:10:03.674726 [debug] [ThreadPool]: On list_logistics: Close
[0m14:10:03.675803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_logistics, now create_logistics_main)
[0m14:10:03.676135 [debug] [ThreadPool]: Creating schema "database: "logistics"
schema: "main"
"
[0m14:10:03.679023 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m14:10:03.679216 [debug] [ThreadPool]: On create_logistics_main: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "create_logistics_main"} */

    
        select type from duckdb_databases()
        where database_name='logistics'
        and type='sqlite'
    
  
[0m14:10:03.679378 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:10:03.681647 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:10:03.682362 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m14:10:03.682541 [debug] [ThreadPool]: On create_logistics_main: BEGIN
[0m14:10:03.682719 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:10:03.682862 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m14:10:03.683034 [debug] [ThreadPool]: On create_logistics_main: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "create_logistics_main"} */

    
    
        create schema if not exists "logistics"."main"
    
[0m14:10:03.683252 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:10:03.683616 [debug] [ThreadPool]: On create_logistics_main: COMMIT
[0m14:10:03.683820 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m14:10:03.684045 [debug] [ThreadPool]: On create_logistics_main: COMMIT
[0m14:10:03.684268 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:10:03.684442 [debug] [ThreadPool]: On create_logistics_main: Close
[0m14:10:03.685873 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_logistics_main, now list_logistics_main)
[0m14:10:03.688405 [debug] [ThreadPool]: Using duckdb connection "list_logistics_main"
[0m14:10:03.688589 [debug] [ThreadPool]: On list_logistics_main: BEGIN
[0m14:10:03.688763 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:10:03.690837 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:10:03.691021 [debug] [ThreadPool]: Using duckdb connection "list_logistics_main"
[0m14:10:03.691258 [debug] [ThreadPool]: On list_logistics_main: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "list_logistics_main"} */
select
      'logistics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'logistics'
  
[0m14:10:03.697871 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:10:03.699277 [debug] [ThreadPool]: On list_logistics_main: ROLLBACK
[0m14:10:03.699657 [debug] [ThreadPool]: Failed to rollback 'list_logistics_main'
[0m14:10:03.699843 [debug] [ThreadPool]: On list_logistics_main: Close
[0m14:10:03.701117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90439dce-7950-4dc2-a146-22ff9b6f143f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81d2a730>]}
[0m14:10:03.701487 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:03.701662 [debug] [MainThread]: On master: BEGIN
[0m14:10:03.701822 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:10:03.704146 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:03.704387 [debug] [MainThread]: On master: COMMIT
[0m14:10:03.704599 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:03.704781 [debug] [MainThread]: On master: COMMIT
[0m14:10:03.704988 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:03.705174 [debug] [MainThread]: On master: Close
[0m14:10:03.706135 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:10:03.706336 [info ] [MainThread]: 
[0m14:10:03.709978 [debug] [Thread-1  ]: Began running node model.logistics_analytics.stg_shipments
[0m14:10:03.710343 [info ] [Thread-1  ]: 1 of 2 START sql view model main.stg_shipments ................................. [RUN]
[0m14:10:03.710920 [debug] [Thread-1  ]: Acquiring new duckdb connection 'model.logistics_analytics.stg_shipments'
[0m14:10:03.711145 [debug] [Thread-1  ]: Began compiling node model.logistics_analytics.stg_shipments
[0m14:10:03.716237 [debug] [Thread-1  ]: Writing injected SQL for node "model.logistics_analytics.stg_shipments"
[0m14:10:03.718852 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.stg_shipments (compile): 14:10:03.711409 => 14:10:03.718456
[0m14:10:03.719670 [debug] [Thread-1  ]: Began executing node model.logistics_analytics.stg_shipments
[0m14:10:03.736373 [debug] [Thread-1  ]: Writing runtime sql for node "model.logistics_analytics.stg_shipments"
[0m14:10:03.737308 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m14:10:03.737546 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: BEGIN
[0m14:10:03.737756 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m14:10:03.740758 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:10:03.740975 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m14:10:03.741178 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */

  
  create view "logistics"."main"."stg_shipments__dbt_tmp" as (
    select
    shipment_id,
    carrier,
    origin,
    destination,

    cast(order_date as date) as order_date,
    cast(delivery_date as date) as delivery_date,
    cast(expected_delivery_date as date) as expected_delivery_date,

    distance_km,

    datediff(
        'day',
        cast(order_date as date),
        cast(delivery_date as date)
    ) as delivery_days,

    case
        when cast(delivery_date as date) > cast(expected_delivery_date as date)
            then 1
        else 0
    end as is_delayed

from read_parquet('../../data/parquet/shipments.parquet')
  );

[0m14:10:03.742140 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:10:03.745570 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m14:10:03.745781 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */
alter view "logistics"."main"."stg_shipments__dbt_tmp" rename to "stg_shipments"
[0m14:10:03.746053 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:10:03.752488 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: COMMIT
[0m14:10:03.752715 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m14:10:03.752922 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: COMMIT
[0m14:10:03.753375 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:10:03.755624 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m14:10:03.755823 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */
drop view if exists "logistics"."main"."stg_shipments__dbt_backup" cascade
[0m14:10:03.756099 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:10:03.756726 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.stg_shipments (execute): 14:10:03.720095 => 14:10:03.756627
[0m14:10:03.756931 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: Close
[0m14:10:03.758731 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90439dce-7950-4dc2-a146-22ff9b6f143f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81c82520>]}
[0m14:10:03.759045 [info ] [Thread-1  ]: 1 of 2 OK created sql view model main.stg_shipments ............................ [[32mOK[0m in 0.05s]
[0m14:10:03.759416 [debug] [Thread-1  ]: Finished running node model.logistics_analytics.stg_shipments
[0m14:10:03.759868 [debug] [Thread-1  ]: Began running node model.logistics_analytics.carrier_performance
[0m14:10:03.760106 [info ] [Thread-1  ]: 2 of 2 START sql view model main.carrier_performance ........................... [RUN]
[0m14:10:03.760472 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.logistics_analytics.stg_shipments, now model.logistics_analytics.carrier_performance)
[0m14:10:03.760672 [debug] [Thread-1  ]: Began compiling node model.logistics_analytics.carrier_performance
[0m14:10:03.761875 [debug] [Thread-1  ]: Writing injected SQL for node "model.logistics_analytics.carrier_performance"
[0m14:10:03.762555 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.carrier_performance (compile): 14:10:03.760779 => 14:10:03.762449
[0m14:10:03.762736 [debug] [Thread-1  ]: Began executing node model.logistics_analytics.carrier_performance
[0m14:10:03.764454 [debug] [Thread-1  ]: Writing runtime sql for node "model.logistics_analytics.carrier_performance"
[0m14:10:03.764831 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m14:10:03.765020 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: BEGIN
[0m14:10:03.765190 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:10:03.767519 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:10:03.767701 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m14:10:03.767871 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */

  
  create view "logistics"."main"."carrier_performance__dbt_tmp" as (
    select
    carrier,
    count(*) as total_shipments,
    round(avg(delivery_days), 2) as avg_delivery_days,
    round(100.0 * avg(is_delayed), 2) as delay_rate_pct
from "logistics"."main"."stg_shipments"
group by carrier
  );

[0m14:10:03.768461 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:10:03.769934 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m14:10:03.770150 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */
alter view "logistics"."main"."carrier_performance__dbt_tmp" rename to "carrier_performance"
[0m14:10:03.770473 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:10:03.771228 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: COMMIT
[0m14:10:03.771415 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m14:10:03.771572 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: COMMIT
[0m14:10:03.771875 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:10:03.773000 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m14:10:03.773197 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */
drop view if exists "logistics"."main"."carrier_performance__dbt_backup" cascade
[0m14:10:03.773460 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:10:03.774080 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.carrier_performance (execute): 14:10:03.762845 => 14:10:03.773986
[0m14:10:03.774276 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: Close
[0m14:10:03.776253 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90439dce-7950-4dc2-a146-22ff9b6f143f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff813c8370>]}
[0m14:10:03.776556 [info ] [Thread-1  ]: 2 of 2 OK created sql view model main.carrier_performance ...................... [[32mOK[0m in 0.02s]
[0m14:10:03.776914 [debug] [Thread-1  ]: Finished running node model.logistics_analytics.carrier_performance
[0m14:10:03.777584 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:03.777791 [debug] [MainThread]: On master: BEGIN
[0m14:10:03.777992 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:10:03.780905 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:03.781095 [debug] [MainThread]: On master: COMMIT
[0m14:10:03.781261 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:03.781416 [debug] [MainThread]: On master: COMMIT
[0m14:10:03.781578 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:03.781727 [debug] [MainThread]: On master: Close
[0m14:10:03.782515 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:03.782672 [debug] [MainThread]: Connection 'list_logistics_main' was properly closed.
[0m14:10:03.782806 [debug] [MainThread]: Connection 'model.logistics_analytics.carrier_performance' was properly closed.
[0m14:10:03.782990 [info ] [MainThread]: 
[0m14:10:03.783217 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m14:10:03.783680 [debug] [MainThread]: Command end result
[0m14:10:03.788341 [info ] [MainThread]: 
[0m14:10:03.788592 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:10:03.788848 [info ] [MainThread]: 
[0m14:10:03.789100 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:10:03.789558 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.274907, "process_user_time": 1.286717, "process_kernel_time": 0.075572, "process_mem_max_rss": "137696", "process_out_blocks": "3124", "process_in_blocks": "0"}
[0m14:10:03.789862 [debug] [MainThread]: Command `dbt run` succeeded at 14:10:03.789796 after 0.28 seconds
[0m14:10:03.790086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff876d7370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff827bf940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff827c6d30>]}
[0m14:10:03.790289 [debug] [MainThread]: Flushing usage events
[0m14:27:53.960933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad7f83d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab5775e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab577850>]}


============================== 14:27:53.963919 | 7cca6107-b241-45b7-ad09-ae80a266e2e1 ==============================
[0m14:27:53.963919 [info ] [MainThread]: Running with dbt=1.7.18
[0m14:27:53.964276 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/logistics_analytics', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logistics_analytics/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:27:54.084067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7cca6107-b241-45b7-ad09-ae80a266e2e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab4e5b80>]}
[0m14:27:54.110777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7cca6107-b241-45b7-ad09-ae80a266e2e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab577250>]}
[0m14:27:54.111281 [info ] [MainThread]: Registered adapter: duckdb=1.7.5
[0m14:27:54.116262 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m14:27:54.130386 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:27:54.130609 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:27:54.130889 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.logistics_analytics.marts
[0m14:27:54.133981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7cca6107-b241-45b7-ad09-ae80a266e2e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa868feb0>]}
[0m14:27:54.141415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7cca6107-b241-45b7-ad09-ae80a266e2e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab3c7d30>]}
[0m14:27:54.141646 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m14:27:54.141840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cca6107-b241-45b7-ad09-ae80a266e2e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8769220>]}
[0m14:27:54.142546 [info ] [MainThread]: 
[0m14:27:54.142929 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:27:54.143548 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_logistics'
[0m14:27:54.149242 [debug] [ThreadPool]: Using duckdb connection "list_logistics"
[0m14:27:54.149428 [debug] [ThreadPool]: On list_logistics: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "list_logistics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"logistics"'
    
  
  
[0m14:27:54.149585 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:54.154720 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:27:54.155434 [debug] [ThreadPool]: On list_logistics: Close
[0m14:27:54.156629 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_logistics, now create_logistics_main)
[0m14:27:54.156944 [debug] [ThreadPool]: Creating schema "database: "logistics"
schema: "main"
"
[0m14:27:54.160176 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m14:27:54.160370 [debug] [ThreadPool]: On create_logistics_main: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "create_logistics_main"} */

    
        select type from duckdb_databases()
        where database_name='logistics'
        and type='sqlite'
    
  
[0m14:27:54.160536 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:27:54.162933 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:27:54.163755 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m14:27:54.163975 [debug] [ThreadPool]: On create_logistics_main: BEGIN
[0m14:27:54.164250 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:27:54.164434 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m14:27:54.164595 [debug] [ThreadPool]: On create_logistics_main: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "create_logistics_main"} */

    
    
        create schema if not exists "logistics"."main"
    
[0m14:27:54.164808 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:27:54.165179 [debug] [ThreadPool]: On create_logistics_main: COMMIT
[0m14:27:54.165348 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m14:27:54.165505 [debug] [ThreadPool]: On create_logistics_main: COMMIT
[0m14:27:54.165701 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:27:54.165872 [debug] [ThreadPool]: On create_logistics_main: Close
[0m14:27:54.167218 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_logistics_main, now list_logistics_main)
[0m14:27:54.169616 [debug] [ThreadPool]: Using duckdb connection "list_logistics_main"
[0m14:27:54.169792 [debug] [ThreadPool]: On list_logistics_main: BEGIN
[0m14:27:54.169945 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:27:54.171995 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:27:54.172212 [debug] [ThreadPool]: Using duckdb connection "list_logistics_main"
[0m14:27:54.172390 [debug] [ThreadPool]: On list_logistics_main: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "list_logistics_main"} */
select
      'logistics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'logistics'
  
[0m14:27:54.178441 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:27:54.179421 [debug] [ThreadPool]: On list_logistics_main: ROLLBACK
[0m14:27:54.179702 [debug] [ThreadPool]: Failed to rollback 'list_logistics_main'
[0m14:27:54.179881 [debug] [ThreadPool]: On list_logistics_main: Close
[0m14:27:54.180883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cca6107-b241-45b7-ad09-ae80a266e2e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8666790>]}
[0m14:27:54.181145 [debug] [MainThread]: Using duckdb connection "master"
[0m14:27:54.181316 [debug] [MainThread]: On master: BEGIN
[0m14:27:54.181479 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:27:54.183363 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:27:54.183528 [debug] [MainThread]: On master: COMMIT
[0m14:27:54.183672 [debug] [MainThread]: Using duckdb connection "master"
[0m14:27:54.183822 [debug] [MainThread]: On master: COMMIT
[0m14:27:54.184006 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:27:54.184174 [debug] [MainThread]: On master: Close
[0m14:27:54.185042 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:27:54.185271 [info ] [MainThread]: 
[0m14:27:54.192910 [debug] [Thread-1  ]: Began running node model.logistics_analytics.stg_shipments
[0m14:27:54.193225 [info ] [Thread-1  ]: 1 of 2 START sql view model main.stg_shipments ................................. [RUN]
[0m14:27:54.193710 [debug] [Thread-1  ]: Acquiring new duckdb connection 'model.logistics_analytics.stg_shipments'
[0m14:27:54.193914 [debug] [Thread-1  ]: Began compiling node model.logistics_analytics.stg_shipments
[0m14:27:54.197154 [debug] [Thread-1  ]: Writing injected SQL for node "model.logistics_analytics.stg_shipments"
[0m14:27:54.197946 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.stg_shipments (compile): 14:27:54.194065 => 14:27:54.197841
[0m14:27:54.198151 [debug] [Thread-1  ]: Began executing node model.logistics_analytics.stg_shipments
[0m14:27:54.211767 [debug] [Thread-1  ]: Writing runtime sql for node "model.logistics_analytics.stg_shipments"
[0m14:27:54.212389 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m14:27:54.212595 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: BEGIN
[0m14:27:54.212779 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m14:27:54.215031 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:27:54.215260 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m14:27:54.215468 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */

  
  create view "logistics"."main"."stg_shipments__dbt_tmp" as (
    select
    shipment_id,
    carrier,
    origin,
    destination,

    cast(order_date as date) as order_date,
    cast(delivery_date as date) as delivery_date,
    cast(expected_delivery_date as date) as expected_delivery_date,

    distance_km,

    datediff(
        'day',
        cast(order_date as date),
        cast(delivery_date as date)
    ) as delivery_days,

    case
        when cast(delivery_date as date) > cast(expected_delivery_date as date)
            then 1
        else 0
    end as is_delayed

from read_parquet('../../data/parquet/shipments.parquet')
  );

[0m14:27:54.216135 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:27:54.219458 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m14:27:54.219672 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */
alter view "logistics"."main"."stg_shipments__dbt_tmp" rename to "stg_shipments"
[0m14:27:54.219930 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:27:54.226529 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: COMMIT
[0m14:27:54.226956 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m14:27:54.227294 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: COMMIT
[0m14:27:54.227947 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:27:54.230509 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m14:27:54.230718 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */
drop view if exists "logistics"."main"."stg_shipments__dbt_backup" cascade
[0m14:27:54.231022 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:27:54.231708 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.stg_shipments (execute): 14:27:54.198283 => 14:27:54.231615
[0m14:27:54.231895 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: Close
[0m14:27:54.233431 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cca6107-b241-45b7-ad09-ae80a266e2e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7d82580>]}
[0m14:27:54.233725 [info ] [Thread-1  ]: 1 of 2 OK created sql view model main.stg_shipments ............................ [[32mOK[0m in 0.04s]
[0m14:27:54.234028 [debug] [Thread-1  ]: Finished running node model.logistics_analytics.stg_shipments
[0m14:27:54.234490 [debug] [Thread-1  ]: Began running node model.logistics_analytics.carrier_performance
[0m14:27:54.234702 [info ] [Thread-1  ]: 2 of 2 START sql view model main.carrier_performance ........................... [RUN]
[0m14:27:54.235016 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.logistics_analytics.stg_shipments, now model.logistics_analytics.carrier_performance)
[0m14:27:54.235214 [debug] [Thread-1  ]: Began compiling node model.logistics_analytics.carrier_performance
[0m14:27:54.236460 [debug] [Thread-1  ]: Writing injected SQL for node "model.logistics_analytics.carrier_performance"
[0m14:27:54.237054 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.carrier_performance (compile): 14:27:54.235329 => 14:27:54.236944
[0m14:27:54.237239 [debug] [Thread-1  ]: Began executing node model.logistics_analytics.carrier_performance
[0m14:27:54.238976 [debug] [Thread-1  ]: Writing runtime sql for node "model.logistics_analytics.carrier_performance"
[0m14:27:54.239395 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m14:27:54.239579 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: BEGIN
[0m14:27:54.239748 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:27:54.242031 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:27:54.242256 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m14:27:54.242456 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */

  
  create view "logistics"."main"."carrier_performance__dbt_tmp" as (
    select
    carrier,
    count(*) as total_shipments,
    round(avg(delivery_days), 2) as avg_delivery_days,
    round(100.0 * avg(is_delayed), 2) as delay_rate_pct
from "logistics"."main"."stg_shipments"
group by carrier
  );

[0m14:27:54.243006 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:27:54.244461 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m14:27:54.244672 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */
alter view "logistics"."main"."carrier_performance__dbt_tmp" rename to "carrier_performance"
[0m14:27:54.245040 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:27:54.245820 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: COMMIT
[0m14:27:54.246036 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m14:27:54.246229 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: COMMIT
[0m14:27:54.246569 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:27:54.247719 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m14:27:54.247961 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */
drop view if exists "logistics"."main"."carrier_performance__dbt_backup" cascade
[0m14:27:54.248246 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:27:54.248853 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.carrier_performance (execute): 14:27:54.237357 => 14:27:54.248763
[0m14:27:54.249044 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: Close
[0m14:27:54.250709 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cca6107-b241-45b7-ad09-ae80a266e2e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7d914f0>]}
[0m14:27:54.251005 [info ] [Thread-1  ]: 2 of 2 OK created sql view model main.carrier_performance ...................... [[32mOK[0m in 0.02s]
[0m14:27:54.251287 [debug] [Thread-1  ]: Finished running node model.logistics_analytics.carrier_performance
[0m14:27:54.251931 [debug] [MainThread]: Using duckdb connection "master"
[0m14:27:54.252133 [debug] [MainThread]: On master: BEGIN
[0m14:27:54.252290 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:27:54.255023 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:27:54.255242 [debug] [MainThread]: On master: COMMIT
[0m14:27:54.255426 [debug] [MainThread]: Using duckdb connection "master"
[0m14:27:54.255574 [debug] [MainThread]: On master: COMMIT
[0m14:27:54.255752 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:27:54.255904 [debug] [MainThread]: On master: Close
[0m14:27:54.256655 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:27:54.256818 [debug] [MainThread]: Connection 'list_logistics_main' was properly closed.
[0m14:27:54.256958 [debug] [MainThread]: Connection 'model.logistics_analytics.carrier_performance' was properly closed.
[0m14:27:54.257157 [info ] [MainThread]: 
[0m14:27:54.257347 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m14:27:54.257701 [debug] [MainThread]: Command end result
[0m14:27:54.262640 [info ] [MainThread]: 
[0m14:27:54.262865 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:27:54.263052 [info ] [MainThread]: 
[0m14:27:54.263278 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:27:54.263744 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.32473558, "process_user_time": 1.411525, "process_kernel_time": 0.162984, "process_mem_max_rss": "145460", "process_out_blocks": "4804", "process_in_blocks": "0"}
[0m14:27:54.264029 [debug] [MainThread]: Command `dbt run` succeeded at 14:27:54.263959 after 0.33 seconds
[0m14:27:54.264227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad7f83d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7de9f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab4e5b80>]}
[0m14:27:54.264430 [debug] [MainThread]: Flushing usage events
[0m14:27:58.409412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9347f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff912b75e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff912b7850>]}


============================== 14:27:58.411934 | 9a922eac-9f1b-4c60-9b6e-23ee64bd50cc ==============================
[0m14:27:58.411934 [info ] [MainThread]: Running with dbt=1.7.18
[0m14:27:58.412221 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/logistics_analytics', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logistics_analytics/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:27:58.490281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a922eac-9f1b-4c60-9b6e-23ee64bd50cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff911e6b80>]}
[0m14:27:58.514457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a922eac-9f1b-4c60-9b6e-23ee64bd50cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff912b7250>]}
[0m14:27:58.514824 [info ] [MainThread]: Registered adapter: duckdb=1.7.5
[0m14:27:58.518847 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m14:27:58.530558 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:27:58.530765 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:27:58.531083 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.logistics_analytics.marts
[0m14:27:58.533594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a922eac-9f1b-4c60-9b6e-23ee64bd50cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e312eb0>]}
[0m14:27:58.539936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a922eac-9f1b-4c60-9b6e-23ee64bd50cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9108dd30>]}
[0m14:27:58.540183 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m14:27:58.540398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a922eac-9f1b-4c60-9b6e-23ee64bd50cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e3e7220>]}
[0m14:27:58.540987 [info ] [MainThread]: 
[0m14:27:58.541346 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:27:58.541933 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_logistics'
[0m14:27:58.547344 [debug] [ThreadPool]: Using duckdb connection "list_logistics"
[0m14:27:58.547549 [debug] [ThreadPool]: On list_logistics: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "list_logistics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"logistics"'
    
  
  
[0m14:27:58.547747 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:58.551510 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:27:58.552164 [debug] [ThreadPool]: On list_logistics: Close
[0m14:27:58.553185 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_logistics, now create_logistics_main)
[0m14:27:58.553490 [debug] [ThreadPool]: Creating schema "database: "logistics"
schema: "main"
"
[0m14:27:58.556465 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m14:27:58.556668 [debug] [ThreadPool]: On create_logistics_main: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "create_logistics_main"} */

    
        select type from duckdb_databases()
        where database_name='logistics'
        and type='sqlite'
    
  
[0m14:27:58.556857 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:27:58.559300 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:27:58.559815 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m14:27:58.560008 [debug] [ThreadPool]: On create_logistics_main: BEGIN
[0m14:27:58.560212 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:27:58.560386 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m14:27:58.560551 [debug] [ThreadPool]: On create_logistics_main: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "create_logistics_main"} */

    
    
        create schema if not exists "logistics"."main"
    
[0m14:27:58.560757 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:27:58.561111 [debug] [ThreadPool]: On create_logistics_main: COMMIT
[0m14:27:58.561279 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m14:27:58.561442 [debug] [ThreadPool]: On create_logistics_main: COMMIT
[0m14:27:58.561652 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:27:58.561905 [debug] [ThreadPool]: On create_logistics_main: Close
[0m14:27:58.563353 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_logistics_main, now list_logistics_main)
[0m14:27:58.565738 [debug] [ThreadPool]: Using duckdb connection "list_logistics_main"
[0m14:27:58.565933 [debug] [ThreadPool]: On list_logistics_main: BEGIN
[0m14:27:58.566129 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:27:58.568625 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:27:58.568807 [debug] [ThreadPool]: Using duckdb connection "list_logistics_main"
[0m14:27:58.569010 [debug] [ThreadPool]: On list_logistics_main: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "list_logistics_main"} */
select
      'logistics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'logistics'
  
[0m14:27:58.574339 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:27:58.575288 [debug] [ThreadPool]: On list_logistics_main: ROLLBACK
[0m14:27:58.575573 [debug] [ThreadPool]: Failed to rollback 'list_logistics_main'
[0m14:27:58.575747 [debug] [ThreadPool]: On list_logistics_main: Close
[0m14:27:58.576951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a922eac-9f1b-4c60-9b6e-23ee64bd50cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e2eb790>]}
[0m14:27:58.577215 [debug] [MainThread]: Using duckdb connection "master"
[0m14:27:58.577412 [debug] [MainThread]: On master: BEGIN
[0m14:27:58.577577 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:27:58.579865 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:27:58.580051 [debug] [MainThread]: On master: COMMIT
[0m14:27:58.580238 [debug] [MainThread]: Using duckdb connection "master"
[0m14:27:58.580423 [debug] [MainThread]: On master: COMMIT
[0m14:27:58.580617 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:27:58.580790 [debug] [MainThread]: On master: Close
[0m14:27:58.581555 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:27:58.581776 [info ] [MainThread]: 
[0m14:27:58.584816 [debug] [Thread-1  ]: Began running node model.logistics_analytics.stg_shipments
[0m14:27:58.585095 [info ] [Thread-1  ]: 1 of 2 START sql view model main.stg_shipments ................................. [RUN]
[0m14:27:58.585467 [debug] [Thread-1  ]: Acquiring new duckdb connection 'model.logistics_analytics.stg_shipments'
[0m14:27:58.585678 [debug] [Thread-1  ]: Began compiling node model.logistics_analytics.stg_shipments
[0m14:27:58.588862 [debug] [Thread-1  ]: Writing injected SQL for node "model.logistics_analytics.stg_shipments"
[0m14:27:58.589484 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.stg_shipments (compile): 14:27:58.585809 => 14:27:58.589374
[0m14:27:58.589676 [debug] [Thread-1  ]: Began executing node model.logistics_analytics.stg_shipments
[0m14:27:58.603640 [debug] [Thread-1  ]: Writing runtime sql for node "model.logistics_analytics.stg_shipments"
[0m14:27:58.604189 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m14:27:58.604399 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: BEGIN
[0m14:27:58.604584 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m14:27:58.607046 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:27:58.607242 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m14:27:58.607435 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */

  
  create view "logistics"."main"."stg_shipments__dbt_tmp" as (
    select
    shipment_id,
    carrier,
    origin,
    destination,

    cast(order_date as date) as order_date,
    cast(delivery_date as date) as delivery_date,
    cast(expected_delivery_date as date) as expected_delivery_date,

    distance_km,

    datediff(
        'day',
        cast(order_date as date),
        cast(delivery_date as date)
    ) as delivery_days,

    case
        when cast(delivery_date as date) > cast(expected_delivery_date as date)
            then 1
        else 0
    end as is_delayed

from read_parquet('../../data/parquet/shipments.parquet')
  );

[0m14:27:58.607867 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:27:58.611089 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m14:27:58.611302 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */
alter view "logistics"."main"."stg_shipments" rename to "stg_shipments__dbt_backup"
[0m14:27:58.611539 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:27:58.612870 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m14:27:58.613079 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */
alter view "logistics"."main"."stg_shipments__dbt_tmp" rename to "stg_shipments"
[0m14:27:58.613290 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:27:58.620363 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: COMMIT
[0m14:27:58.620589 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m14:27:58.620774 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: COMMIT
[0m14:27:58.621159 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:27:58.623379 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m14:27:58.623590 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */
drop view if exists "logistics"."main"."stg_shipments__dbt_backup" cascade
[0m14:27:58.623958 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:27:58.624637 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.stg_shipments (execute): 14:27:58.589797 => 14:27:58.624536
[0m14:27:58.624833 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: Close
[0m14:27:58.626419 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a922eac-9f1b-4c60-9b6e-23ee64bd50cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e24cb50>]}
[0m14:27:58.626714 [info ] [Thread-1  ]: 1 of 2 OK created sql view model main.stg_shipments ............................ [[32mOK[0m in 0.04s]
[0m14:27:58.627019 [debug] [Thread-1  ]: Finished running node model.logistics_analytics.stg_shipments
[0m14:27:58.627385 [debug] [Thread-1  ]: Began running node model.logistics_analytics.carrier_performance
[0m14:27:58.627614 [info ] [Thread-1  ]: 2 of 2 START sql view model main.carrier_performance ........................... [RUN]
[0m14:27:58.627978 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.logistics_analytics.stg_shipments, now model.logistics_analytics.carrier_performance)
[0m14:27:58.628189 [debug] [Thread-1  ]: Began compiling node model.logistics_analytics.carrier_performance
[0m14:27:58.629421 [debug] [Thread-1  ]: Writing injected SQL for node "model.logistics_analytics.carrier_performance"
[0m14:27:58.629892 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.carrier_performance (compile): 14:27:58.628317 => 14:27:58.629787
[0m14:27:58.630094 [debug] [Thread-1  ]: Began executing node model.logistics_analytics.carrier_performance
[0m14:27:58.631769 [debug] [Thread-1  ]: Writing runtime sql for node "model.logistics_analytics.carrier_performance"
[0m14:27:58.632165 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m14:27:58.632347 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: BEGIN
[0m14:27:58.632514 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:27:58.634714 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:27:58.634896 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m14:27:58.635091 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */

  
  create view "logistics"."main"."carrier_performance__dbt_tmp" as (
    select
    carrier,
    count(*) as total_shipments,
    round(avg(delivery_days), 2) as avg_delivery_days,
    round(100.0 * avg(is_delayed), 2) as delay_rate_pct
from "logistics"."main"."stg_shipments"
group by carrier
  );

[0m14:27:58.635594 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:27:58.637016 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m14:27:58.637241 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */
alter view "logistics"."main"."carrier_performance" rename to "carrier_performance__dbt_backup"
[0m14:27:58.637580 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:27:58.638997 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m14:27:58.639194 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */
alter view "logistics"."main"."carrier_performance__dbt_tmp" rename to "carrier_performance"
[0m14:27:58.639432 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:27:58.640207 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: COMMIT
[0m14:27:58.640393 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m14:27:58.640563 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: COMMIT
[0m14:27:58.640868 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:27:58.642465 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m14:27:58.642660 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */
drop view if exists "logistics"."main"."carrier_performance__dbt_backup" cascade
[0m14:27:58.642930 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:27:58.643520 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.carrier_performance (execute): 14:27:58.630218 => 14:27:58.643426
[0m14:27:58.643717 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: Close
[0m14:27:58.645264 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a922eac-9f1b-4c60-9b6e-23ee64bd50cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e24b7c0>]}
[0m14:27:58.645548 [info ] [Thread-1  ]: 2 of 2 OK created sql view model main.carrier_performance ...................... [[32mOK[0m in 0.02s]
[0m14:27:58.645850 [debug] [Thread-1  ]: Finished running node model.logistics_analytics.carrier_performance
[0m14:27:58.646491 [debug] [MainThread]: Using duckdb connection "master"
[0m14:27:58.646696 [debug] [MainThread]: On master: BEGIN
[0m14:27:58.646881 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:27:58.649233 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:27:58.649401 [debug] [MainThread]: On master: COMMIT
[0m14:27:58.649548 [debug] [MainThread]: Using duckdb connection "master"
[0m14:27:58.649692 [debug] [MainThread]: On master: COMMIT
[0m14:27:58.649848 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:27:58.650010 [debug] [MainThread]: On master: Close
[0m14:27:58.650802 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:27:58.650954 [debug] [MainThread]: Connection 'list_logistics_main' was properly closed.
[0m14:27:58.651122 [debug] [MainThread]: Connection 'model.logistics_analytics.carrier_performance' was properly closed.
[0m14:27:58.651303 [info ] [MainThread]: 
[0m14:27:58.651485 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m14:27:58.651835 [debug] [MainThread]: Command end result
[0m14:27:58.675202 [info ] [MainThread]: 
[0m14:27:58.675468 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:27:58.675664 [info ] [MainThread]: 
[0m14:27:58.675861 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:27:58.676260 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.2848659, "process_user_time": 1.293164, "process_kernel_time": 0.060539, "process_mem_max_rss": "145508", "process_out_blocks": "3615", "process_in_blocks": "0"}
[0m14:27:58.676511 [debug] [MainThread]: Command `dbt run` succeeded at 14:27:58.676449 after 0.29 seconds
[0m14:27:58.676706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9347f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9108ddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91102940>]}
[0m14:27:58.676921 [debug] [MainThread]: Flushing usage events
[0m14:45:06.934137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb214c610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaff10610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaff10b80>]}


============================== 14:45:06.937134 | 6536123a-94ee-49a4-be48-d4b0cb552254 ==============================
[0m14:45:06.937134 [info ] [MainThread]: Running with dbt=1.7.18
[0m14:45:06.937408 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt/logistics_analytics', 'log_path': '/opt/airflow/dbt/logistics_analytics/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:45:07.035296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6536123a-94ee-49a4-be48-d4b0cb552254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1077f10>]}
[0m14:45:07.062028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6536123a-94ee-49a4-be48-d4b0cb552254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafd3c130>]}
[0m14:45:07.062646 [info ] [MainThread]: Registered adapter: duckdb=1.7.5
[0m14:45:07.068058 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m14:45:07.081065 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:45:07.081263 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:45:07.081527 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.logistics_analytics.marts
[0m14:45:07.084499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6536123a-94ee-49a4-be48-d4b0cb552254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad051f10>]}
[0m14:45:07.091964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6536123a-94ee-49a4-be48-d4b0cb552254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad12a130>]}
[0m14:45:07.092188 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m14:45:07.092387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6536123a-94ee-49a4-be48-d4b0cb552254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafc6c8e0>]}
[0m14:45:07.093126 [info ] [MainThread]: 
[0m14:45:07.093515 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:45:07.094103 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_logistics'
[0m14:45:07.099990 [debug] [ThreadPool]: Using duckdb connection "list_logistics"
[0m14:45:07.100212 [debug] [ThreadPool]: On list_logistics: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "list_logistics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"logistics"'
    
  
  
[0m14:45:07.100517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:07.105444 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:45:07.106136 [debug] [ThreadPool]: On list_logistics: Close
[0m14:45:07.107728 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_logistics, now create_logistics_main)
[0m14:45:07.108051 [debug] [ThreadPool]: Creating schema "database: "logistics"
schema: "main"
"
[0m14:45:07.110929 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m14:45:07.111106 [debug] [ThreadPool]: On create_logistics_main: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "create_logistics_main"} */

    
        select type from duckdb_databases()
        where database_name='logistics'
        and type='sqlite'
    
  
[0m14:45:07.111263 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:45:07.113491 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:45:07.114051 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m14:45:07.114224 [debug] [ThreadPool]: On create_logistics_main: BEGIN
[0m14:45:07.114421 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:45:07.114597 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m14:45:07.114791 [debug] [ThreadPool]: On create_logistics_main: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "create_logistics_main"} */

    
    
        create schema if not exists "logistics"."main"
    
[0m14:45:07.115119 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:45:07.115508 [debug] [ThreadPool]: On create_logistics_main: COMMIT
[0m14:45:07.115673 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m14:45:07.115819 [debug] [ThreadPool]: On create_logistics_main: COMMIT
[0m14:45:07.116015 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:45:07.116215 [debug] [ThreadPool]: On create_logistics_main: Close
[0m14:45:07.117636 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_logistics_main, now list_logistics_main)
[0m14:45:07.120156 [debug] [ThreadPool]: Using duckdb connection "list_logistics_main"
[0m14:45:07.120357 [debug] [ThreadPool]: On list_logistics_main: BEGIN
[0m14:45:07.120519 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:45:07.122615 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:45:07.122783 [debug] [ThreadPool]: Using duckdb connection "list_logistics_main"
[0m14:45:07.122967 [debug] [ThreadPool]: On list_logistics_main: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "list_logistics_main"} */
select
      'logistics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'logistics'
  
[0m14:45:07.128858 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:45:07.129814 [debug] [ThreadPool]: On list_logistics_main: ROLLBACK
[0m14:45:07.130129 [debug] [ThreadPool]: Failed to rollback 'list_logistics_main'
[0m14:45:07.130350 [debug] [ThreadPool]: On list_logistics_main: Close
[0m14:45:07.131403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6536123a-94ee-49a4-be48-d4b0cb552254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafc5b700>]}
[0m14:45:07.131632 [debug] [MainThread]: Using duckdb connection "master"
[0m14:45:07.131796 [debug] [MainThread]: On master: BEGIN
[0m14:45:07.131990 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:45:07.133875 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:45:07.134073 [debug] [MainThread]: On master: COMMIT
[0m14:45:07.134240 [debug] [MainThread]: Using duckdb connection "master"
[0m14:45:07.134397 [debug] [MainThread]: On master: COMMIT
[0m14:45:07.134576 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:45:07.134737 [debug] [MainThread]: On master: Close
[0m14:45:07.135468 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:45:07.135676 [info ] [MainThread]: 
[0m14:45:07.139477 [debug] [Thread-1  ]: Began running node model.logistics_analytics.stg_shipments
[0m14:45:07.139761 [info ] [Thread-1  ]: 1 of 2 START sql view model main.stg_shipments ................................. [RUN]
[0m14:45:07.140203 [debug] [Thread-1  ]: Acquiring new duckdb connection 'model.logistics_analytics.stg_shipments'
[0m14:45:07.140403 [debug] [Thread-1  ]: Began compiling node model.logistics_analytics.stg_shipments
[0m14:45:07.143564 [debug] [Thread-1  ]: Writing injected SQL for node "model.logistics_analytics.stg_shipments"
[0m14:45:07.144481 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.stg_shipments (compile): 14:45:07.140535 => 14:45:07.144372
[0m14:45:07.144670 [debug] [Thread-1  ]: Began executing node model.logistics_analytics.stg_shipments
[0m14:45:07.158180 [debug] [Thread-1  ]: Writing runtime sql for node "model.logistics_analytics.stg_shipments"
[0m14:45:07.158724 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m14:45:07.158921 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: BEGIN
[0m14:45:07.159113 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m14:45:07.161300 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:45:07.161478 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m14:45:07.161648 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */

  
  create view "logistics"."main"."stg_shipments__dbt_tmp" as (
    select
    shipment_id,
    carrier,
    origin,
    destination,

    cast(order_date as date) as order_date,
    cast(delivery_date as date) as delivery_date,
    cast(expected_delivery_date as date) as expected_delivery_date,

    distance_km,

    datediff(
        'day',
        cast(order_date as date),
        cast(delivery_date as date)
    ) as delivery_days,

    case
        when cast(delivery_date as date) > cast(expected_delivery_date as date)
            then 1
        else 0
    end as is_delayed

from read_parquet('../../data/parquet/shipments.parquet')
  );

[0m14:45:07.162319 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:45:07.165458 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m14:45:07.165637 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */
alter view "logistics"."main"."stg_shipments__dbt_tmp" rename to "stg_shipments"
[0m14:45:07.165865 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:45:07.171857 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: COMMIT
[0m14:45:07.172091 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m14:45:07.172421 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: COMMIT
[0m14:45:07.172790 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:45:07.174945 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m14:45:07.175151 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */
drop view if exists "logistics"."main"."stg_shipments__dbt_backup" cascade
[0m14:45:07.175447 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:45:07.176088 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.stg_shipments (execute): 14:45:07.144794 => 14:45:07.175989
[0m14:45:07.176282 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: Close
[0m14:45:07.177718 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6536123a-94ee-49a4-be48-d4b0cb552254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac74a3d0>]}
[0m14:45:07.178017 [info ] [Thread-1  ]: 1 of 2 OK created sql view model main.stg_shipments ............................ [[32mOK[0m in 0.04s]
[0m14:45:07.178384 [debug] [Thread-1  ]: Finished running node model.logistics_analytics.stg_shipments
[0m14:45:07.178789 [debug] [Thread-1  ]: Began running node model.logistics_analytics.carrier_performance
[0m14:45:07.179101 [info ] [Thread-1  ]: 2 of 2 START sql view model main.carrier_performance ........................... [RUN]
[0m14:45:07.179448 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.logistics_analytics.stg_shipments, now model.logistics_analytics.carrier_performance)
[0m14:45:07.179633 [debug] [Thread-1  ]: Began compiling node model.logistics_analytics.carrier_performance
[0m14:45:07.180874 [debug] [Thread-1  ]: Writing injected SQL for node "model.logistics_analytics.carrier_performance"
[0m14:45:07.181583 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.carrier_performance (compile): 14:45:07.179742 => 14:45:07.181481
[0m14:45:07.181752 [debug] [Thread-1  ]: Began executing node model.logistics_analytics.carrier_performance
[0m14:45:07.183386 [debug] [Thread-1  ]: Writing runtime sql for node "model.logistics_analytics.carrier_performance"
[0m14:45:07.183742 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m14:45:07.183915 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: BEGIN
[0m14:45:07.184084 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:45:07.186429 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:45:07.186602 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m14:45:07.186764 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */

  
  create view "logistics"."main"."carrier_performance__dbt_tmp" as (
    select
    carrier,
    count(*) as total_shipments,
    round(avg(delivery_days), 2) as avg_delivery_days,
    round(100.0 * avg(is_delayed), 2) as delay_rate_pct
from "logistics"."main"."stg_shipments"
group by carrier
  );

[0m14:45:07.187349 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:45:07.188792 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m14:45:07.189004 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */
alter view "logistics"."main"."carrier_performance__dbt_tmp" rename to "carrier_performance"
[0m14:45:07.189348 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:45:07.190043 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: COMMIT
[0m14:45:07.190229 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m14:45:07.190385 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: COMMIT
[0m14:45:07.190682 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:45:07.191814 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m14:45:07.192009 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */
drop view if exists "logistics"."main"."carrier_performance__dbt_backup" cascade
[0m14:45:07.192281 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m14:45:07.192875 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.carrier_performance (execute): 14:45:07.181857 => 14:45:07.192789
[0m14:45:07.193068 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: Close
[0m14:45:07.195378 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6536123a-94ee-49a4-be48-d4b0cb552254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac748a00>]}
[0m14:45:07.195646 [info ] [Thread-1  ]: 2 of 2 OK created sql view model main.carrier_performance ...................... [[32mOK[0m in 0.02s]
[0m14:45:07.195983 [debug] [Thread-1  ]: Finished running node model.logistics_analytics.carrier_performance
[0m14:45:07.196611 [debug] [MainThread]: Using duckdb connection "master"
[0m14:45:07.196808 [debug] [MainThread]: On master: BEGIN
[0m14:45:07.197003 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:45:07.199565 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:45:07.199729 [debug] [MainThread]: On master: COMMIT
[0m14:45:07.199875 [debug] [MainThread]: Using duckdb connection "master"
[0m14:45:07.200045 [debug] [MainThread]: On master: COMMIT
[0m14:45:07.200258 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:45:07.200442 [debug] [MainThread]: On master: Close
[0m14:45:07.201217 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:45:07.201371 [debug] [MainThread]: Connection 'list_logistics_main' was properly closed.
[0m14:45:07.201506 [debug] [MainThread]: Connection 'model.logistics_analytics.carrier_performance' was properly closed.
[0m14:45:07.201665 [info ] [MainThread]: 
[0m14:45:07.201851 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m14:45:07.202298 [debug] [MainThread]: Command end result
[0m14:45:07.207726 [info ] [MainThread]: 
[0m14:45:07.208022 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:45:07.208265 [info ] [MainThread]: 
[0m14:45:07.208491 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:45:07.208976 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.29401654, "process_user_time": 1.281388, "process_kernel_time": 0.156802, "process_mem_max_rss": "135516", "process_out_blocks": "3124", "process_in_blocks": "0"}
[0m14:45:07.209259 [debug] [MainThread]: Command `dbt run` succeeded at 14:45:07.209189 after 0.29 seconds
[0m14:45:07.209461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb214c610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac751700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1077f10>]}
[0m14:45:07.209639 [debug] [MainThread]: Flushing usage events
[0m15:00:36.011744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91e5b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fcf9670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fcf9940>]}


============================== 15:00:36.014566 | 60d53b13-cd5b-415b-b965-19cd69450661 ==============================
[0m15:00:36.014566 [info ] [MainThread]: Running with dbt=1.7.18
[0m15:00:36.014925 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logistics_analytics/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt/logistics_analytics', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:00:36.108221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60d53b13-cd5b-415b-b965-19cd69450661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fc26bb0>]}
[0m15:00:36.133206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60d53b13-cd5b-415b-b965-19cd69450661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fcf92e0>]}
[0m15:00:36.133779 [info ] [MainThread]: Registered adapter: duckdb=1.7.5
[0m15:00:36.139496 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m15:00:36.152900 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:00:36.153352 [debug] [MainThread]: Partial parsing: updated file: logistics_analytics://models/staging/stg_shipments.sql
[0m15:00:36.226536 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.logistics_analytics.marts
[0m15:00:36.229124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60d53b13-cd5b-415b-b965-19cd69450661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c381f10>]}
[0m15:00:36.236705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60d53b13-cd5b-415b-b965-19cd69450661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f86a070>]}
[0m15:00:36.237069 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m15:00:36.237387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60d53b13-cd5b-415b-b965-19cd69450661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8faca6d0>]}
[0m15:00:36.238671 [info ] [MainThread]: 
[0m15:00:36.239148 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:00:36.239925 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_logistics'
[0m15:00:36.246340 [debug] [ThreadPool]: Using duckdb connection "list_logistics"
[0m15:00:36.246629 [debug] [ThreadPool]: On list_logistics: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "list_logistics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"logistics"'
    
  
  
[0m15:00:36.246804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:36.251895 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:00:36.252864 [debug] [ThreadPool]: On list_logistics: Close
[0m15:00:36.254236 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_logistics, now create_logistics_main)
[0m15:00:36.254591 [debug] [ThreadPool]: Creating schema "database: "logistics"
schema: "main"
"
[0m15:00:36.258044 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m15:00:36.258295 [debug] [ThreadPool]: On create_logistics_main: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "create_logistics_main"} */

    
        select type from duckdb_databases()
        where database_name='logistics'
        and type='sqlite'
    
  
[0m15:00:36.258490 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:00:36.262245 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:00:36.263110 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m15:00:36.263341 [debug] [ThreadPool]: On create_logistics_main: BEGIN
[0m15:00:36.263595 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:00:36.263794 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m15:00:36.263992 [debug] [ThreadPool]: On create_logistics_main: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "create_logistics_main"} */

    
    
        create schema if not exists "logistics"."main"
    
[0m15:00:36.264261 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:00:36.264687 [debug] [ThreadPool]: On create_logistics_main: COMMIT
[0m15:00:36.264883 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m15:00:36.265079 [debug] [ThreadPool]: On create_logistics_main: COMMIT
[0m15:00:36.265315 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:00:36.265512 [debug] [ThreadPool]: On create_logistics_main: Close
[0m15:00:36.267162 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_logistics_main, now list_logistics_main)
[0m15:00:36.269891 [debug] [ThreadPool]: Using duckdb connection "list_logistics_main"
[0m15:00:36.270108 [debug] [ThreadPool]: On list_logistics_main: BEGIN
[0m15:00:36.270302 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:00:36.272872 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:00:36.273064 [debug] [ThreadPool]: Using duckdb connection "list_logistics_main"
[0m15:00:36.273372 [debug] [ThreadPool]: On list_logistics_main: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "list_logistics_main"} */
select
      'logistics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'logistics'
  
[0m15:00:36.279924 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:00:36.280959 [debug] [ThreadPool]: On list_logistics_main: ROLLBACK
[0m15:00:36.281333 [debug] [ThreadPool]: Failed to rollback 'list_logistics_main'
[0m15:00:36.281570 [debug] [ThreadPool]: On list_logistics_main: Close
[0m15:00:36.282949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60d53b13-cd5b-415b-b965-19cd69450661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c3df580>]}
[0m15:00:36.283231 [debug] [MainThread]: Using duckdb connection "master"
[0m15:00:36.283430 [debug] [MainThread]: On master: BEGIN
[0m15:00:36.283625 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:00:36.286080 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:00:36.286305 [debug] [MainThread]: On master: COMMIT
[0m15:00:36.286481 [debug] [MainThread]: Using duckdb connection "master"
[0m15:00:36.286676 [debug] [MainThread]: On master: COMMIT
[0m15:00:36.286899 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:00:36.287094 [debug] [MainThread]: On master: Close
[0m15:00:36.288204 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:00:36.288428 [info ] [MainThread]: 
[0m15:00:36.292113 [debug] [Thread-1  ]: Began running node model.logistics_analytics.stg_shipments
[0m15:00:36.292451 [info ] [Thread-1  ]: 1 of 2 START sql view model main.stg_shipments ................................. [RUN]
[0m15:00:36.293077 [debug] [Thread-1  ]: Acquiring new duckdb connection 'model.logistics_analytics.stg_shipments'
[0m15:00:36.293318 [debug] [Thread-1  ]: Began compiling node model.logistics_analytics.stg_shipments
[0m15:00:36.297362 [debug] [Thread-1  ]: Writing injected SQL for node "model.logistics_analytics.stg_shipments"
[0m15:00:36.298356 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.stg_shipments (compile): 15:00:36.293458 => 15:00:36.298238
[0m15:00:36.298580 [debug] [Thread-1  ]: Began executing node model.logistics_analytics.stg_shipments
[0m15:00:36.337500 [debug] [Thread-1  ]: Writing runtime sql for node "model.logistics_analytics.stg_shipments"
[0m15:00:36.338479 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m15:00:36.338731 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: BEGIN
[0m15:00:36.338957 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:00:36.342496 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m15:00:36.342763 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m15:00:36.342977 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */

  
  create view "logistics"."main"."stg_shipments__dbt_tmp" as (
    select
    shipment_id,
    carrier,
    origin,
    destination,

    cast(order_date as date) as order_date,
    cast(delivery_date as date) as delivery_date,
    cast(expected_delivery_date as date) as expected_delivery_date,

    distance_km,

    datediff(
        'day',
        cast(order_date as date),
        cast(delivery_date as date)
    ) as delivery_days,

    case
        when cast(delivery_date as date) > cast(expected_delivery_date as date)
            then 1
        else 0
    end as is_delayed

from read_parquet('/app/data/parquet/shipments.parquet')
  );

[0m15:00:36.346256 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.stg_shipments (execute): 15:00:36.298726 => 15:00:36.346127
[0m15:00:36.346481 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: ROLLBACK
[0m15:00:36.349904 [debug] [Thread-1  ]: Failed to rollback 'model.logistics_analytics.stg_shipments'
[0m15:00:36.350154 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: Close
[0m15:00:36.351545 [debug] [Thread-1  ]: Runtime Error in model stg_shipments (models/staging/stg_shipments.sql)
  IO Error: No files found that match the pattern "/app/data/parquet/shipments.parquet"
[0m15:00:36.351851 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60d53b13-cd5b-415b-b965-19cd69450661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fa76400>]}
[0m15:00:36.352185 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model main.stg_shipments ........................ [[31mERROR[0m in 0.06s]
[0m15:00:36.352540 [debug] [Thread-1  ]: Finished running node model.logistics_analytics.stg_shipments
[0m15:00:36.353096 [debug] [Thread-1  ]: Began running node model.logistics_analytics.carrier_performance
[0m15:00:36.353351 [info ] [Thread-1  ]: 2 of 2 SKIP relation main.carrier_performance .................................. [[33mSKIP[0m]
[0m15:00:36.353625 [debug] [Thread-1  ]: Finished running node model.logistics_analytics.carrier_performance
[0m15:00:36.354327 [debug] [MainThread]: Using duckdb connection "master"
[0m15:00:36.354519 [debug] [MainThread]: On master: BEGIN
[0m15:00:36.354693 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:00:36.357188 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:00:36.357387 [debug] [MainThread]: On master: COMMIT
[0m15:00:36.357545 [debug] [MainThread]: Using duckdb connection "master"
[0m15:00:36.357729 [debug] [MainThread]: On master: COMMIT
[0m15:00:36.357965 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:00:36.358162 [debug] [MainThread]: On master: Close
[0m15:00:36.359144 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:00:36.359340 [debug] [MainThread]: Connection 'list_logistics_main' was properly closed.
[0m15:00:36.359537 [debug] [MainThread]: Connection 'model.logistics_analytics.stg_shipments' was properly closed.
[0m15:00:36.359765 [info ] [MainThread]: 
[0m15:00:36.360155 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m15:00:36.360701 [debug] [MainThread]: Command end result
[0m15:00:36.365238 [info ] [MainThread]: 
[0m15:00:36.365533 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:00:36.365807 [info ] [MainThread]: 
[0m15:00:36.366063 [error] [MainThread]:   Runtime Error in model stg_shipments (models/staging/stg_shipments.sql)
  IO Error: No files found that match the pattern "/app/data/parquet/shipments.parquet"
[0m15:00:36.366285 [info ] [MainThread]: 
[0m15:00:36.366496 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m15:00:36.367000 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.37471995, "process_user_time": 1.369261, "process_kernel_time": 0.112514, "process_mem_max_rss": "139600", "process_in_blocks": "2056", "process_out_blocks": "2303", "command_success": false}
[0m15:00:36.367282 [debug] [MainThread]: Command `dbt run` failed at 15:00:36.367222 after 0.38 seconds
[0m15:00:36.367487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91e5b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fa4d730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8faf2d30>]}
[0m15:00:36.367700 [debug] [MainThread]: Flushing usage events
[0m15:07:36.021178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2c473d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0a79610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0a79880>]}


============================== 15:07:36.023733 | 95fb8f8f-d1fc-468e-8d83-31ff5bfec17e ==============================
[0m15:07:36.023733 [info ] [MainThread]: Running with dbt=1.7.18
[0m15:07:36.024168 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/logistics_analytics', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logistics_analytics/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:07:36.113172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95fb8f8f-d1fc-468e-8d83-31ff5bfec17e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa09a6bb0>]}
[0m15:07:36.137166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95fb8f8f-d1fc-468e-8d83-31ff5bfec17e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0a70af0>]}
[0m15:07:36.137560 [info ] [MainThread]: Registered adapter: duckdb=1.7.5
[0m15:07:36.141853 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m15:07:36.154146 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:07:36.154453 [debug] [MainThread]: Partial parsing: updated file: logistics_analytics://models/staging/stg_shipments.sql
[0m15:07:36.207670 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.logistics_analytics.marts
[0m15:07:36.210097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95fb8f8f-d1fc-468e-8d83-31ff5bfec17e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d101ee0>]}
[0m15:07:36.216604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95fb8f8f-d1fc-468e-8d83-31ff5bfec17e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dbaa250>]}
[0m15:07:36.216853 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m15:07:36.217077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95fb8f8f-d1fc-468e-8d83-31ff5bfec17e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dbaa0d0>]}
[0m15:07:36.217749 [info ] [MainThread]: 
[0m15:07:36.218168 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:07:36.218826 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_logistics'
[0m15:07:36.224274 [debug] [ThreadPool]: Using duckdb connection "list_logistics"
[0m15:07:36.224463 [debug] [ThreadPool]: On list_logistics: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "list_logistics"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"logistics"'
    
  
  
[0m15:07:36.224643 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:36.230287 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:07:36.231367 [debug] [ThreadPool]: On list_logistics: Close
[0m15:07:36.232808 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_logistics, now create_logistics_main)
[0m15:07:36.233223 [debug] [ThreadPool]: Creating schema "database: "logistics"
schema: "main"
"
[0m15:07:36.236859 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m15:07:36.237092 [debug] [ThreadPool]: On create_logistics_main: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "create_logistics_main"} */

    
        select type from duckdb_databases()
        where database_name='logistics'
        and type='sqlite'
    
  
[0m15:07:36.237293 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:07:36.239870 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:07:36.240652 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m15:07:36.240869 [debug] [ThreadPool]: On create_logistics_main: BEGIN
[0m15:07:36.241089 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:07:36.241314 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m15:07:36.241485 [debug] [ThreadPool]: On create_logistics_main: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "create_logistics_main"} */

    
    
        create schema if not exists "logistics"."main"
    
[0m15:07:36.241756 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:07:36.242135 [debug] [ThreadPool]: On create_logistics_main: COMMIT
[0m15:07:36.242305 [debug] [ThreadPool]: Using duckdb connection "create_logistics_main"
[0m15:07:36.242467 [debug] [ThreadPool]: On create_logistics_main: COMMIT
[0m15:07:36.242671 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:07:36.242892 [debug] [ThreadPool]: On create_logistics_main: Close
[0m15:07:36.244469 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_logistics_main, now list_logistics_main)
[0m15:07:36.247039 [debug] [ThreadPool]: Using duckdb connection "list_logistics_main"
[0m15:07:36.247254 [debug] [ThreadPool]: On list_logistics_main: BEGIN
[0m15:07:36.247431 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:07:36.249897 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:07:36.250125 [debug] [ThreadPool]: Using duckdb connection "list_logistics_main"
[0m15:07:36.250426 [debug] [ThreadPool]: On list_logistics_main: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "connection_name": "list_logistics_main"} */
select
      'logistics' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'logistics'
  
[0m15:07:36.256633 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:07:36.257450 [debug] [ThreadPool]: On list_logistics_main: ROLLBACK
[0m15:07:36.257794 [debug] [ThreadPool]: Failed to rollback 'list_logistics_main'
[0m15:07:36.257998 [debug] [ThreadPool]: On list_logistics_main: Close
[0m15:07:36.259125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95fb8f8f-d1fc-468e-8d83-31ff5bfec17e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d15f550>]}
[0m15:07:36.259431 [debug] [MainThread]: Using duckdb connection "master"
[0m15:07:36.259622 [debug] [MainThread]: On master: BEGIN
[0m15:07:36.259810 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:07:36.262079 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:07:36.262261 [debug] [MainThread]: On master: COMMIT
[0m15:07:36.262433 [debug] [MainThread]: Using duckdb connection "master"
[0m15:07:36.262604 [debug] [MainThread]: On master: COMMIT
[0m15:07:36.262801 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:07:36.262972 [debug] [MainThread]: On master: Close
[0m15:07:36.263739 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:07:36.263989 [info ] [MainThread]: 
[0m15:07:36.267202 [debug] [Thread-1  ]: Began running node model.logistics_analytics.stg_shipments
[0m15:07:36.267484 [info ] [Thread-1  ]: 1 of 2 START sql view model main.stg_shipments ................................. [RUN]
[0m15:07:36.268018 [debug] [Thread-1  ]: Acquiring new duckdb connection 'model.logistics_analytics.stg_shipments'
[0m15:07:36.268219 [debug] [Thread-1  ]: Began compiling node model.logistics_analytics.stg_shipments
[0m15:07:36.271769 [debug] [Thread-1  ]: Writing injected SQL for node "model.logistics_analytics.stg_shipments"
[0m15:07:36.272761 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.stg_shipments (compile): 15:07:36.268350 => 15:07:36.272659
[0m15:07:36.272956 [debug] [Thread-1  ]: Began executing node model.logistics_analytics.stg_shipments
[0m15:07:36.310557 [debug] [Thread-1  ]: Writing runtime sql for node "model.logistics_analytics.stg_shipments"
[0m15:07:36.311314 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m15:07:36.311518 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: BEGIN
[0m15:07:36.311722 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:07:36.314003 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m15:07:36.314186 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m15:07:36.314359 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */

  
  create view "logistics"."main"."stg_shipments__dbt_tmp" as (
    select
    shipment_id,
    carrier,
    origin,
    destination,

    cast(order_date as date) as order_date,
    cast(delivery_date as date) as delivery_date,
    cast(expected_delivery_date as date) as expected_delivery_date,

    distance_km,

    datediff(
        'day',
        cast(order_date as date),
        cast(delivery_date as date)
    ) as delivery_days,

    case
        when cast(delivery_date as date) > cast(expected_delivery_date as date)
            then 1
        else 0
    end as is_delayed

FROM read_parquet('/opt/airflow/data/parquet/shipments.parquet')
  );

[0m15:07:36.315152 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m15:07:36.317843 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m15:07:36.318034 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */
alter view "logistics"."main"."stg_shipments__dbt_tmp" rename to "stg_shipments"
[0m15:07:36.318275 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m15:07:36.324390 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: COMMIT
[0m15:07:36.324639 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m15:07:36.324841 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: COMMIT
[0m15:07:36.325210 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m15:07:36.327441 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.stg_shipments"
[0m15:07:36.327768 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.stg_shipments"} */
drop view if exists "logistics"."main"."stg_shipments__dbt_backup" cascade
[0m15:07:36.328078 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m15:07:36.328738 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.stg_shipments (execute): 15:07:36.273087 => 15:07:36.328644
[0m15:07:36.328946 [debug] [Thread-1  ]: On model.logistics_analytics.stg_shipments: Close
[0m15:07:36.330621 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95fb8f8f-d1fc-468e-8d83-31ff5bfec17e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0733610>]}
[0m15:07:36.330933 [info ] [Thread-1  ]: 1 of 2 OK created sql view model main.stg_shipments ............................ [[32mOK[0m in 0.06s]
[0m15:07:36.331313 [debug] [Thread-1  ]: Finished running node model.logistics_analytics.stg_shipments
[0m15:07:36.331823 [debug] [Thread-1  ]: Began running node model.logistics_analytics.carrier_performance
[0m15:07:36.332081 [info ] [Thread-1  ]: 2 of 2 START sql view model main.carrier_performance ........................... [RUN]
[0m15:07:36.332482 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.logistics_analytics.stg_shipments, now model.logistics_analytics.carrier_performance)
[0m15:07:36.332739 [debug] [Thread-1  ]: Began compiling node model.logistics_analytics.carrier_performance
[0m15:07:36.334016 [debug] [Thread-1  ]: Writing injected SQL for node "model.logistics_analytics.carrier_performance"
[0m15:07:36.334648 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.carrier_performance (compile): 15:07:36.332874 => 15:07:36.334536
[0m15:07:36.334844 [debug] [Thread-1  ]: Began executing node model.logistics_analytics.carrier_performance
[0m15:07:36.336500 [debug] [Thread-1  ]: Writing runtime sql for node "model.logistics_analytics.carrier_performance"
[0m15:07:36.336958 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m15:07:36.337169 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: BEGIN
[0m15:07:36.337333 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:07:36.339574 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m15:07:36.339861 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m15:07:36.340054 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */

  
  create view "logistics"."main"."carrier_performance__dbt_tmp" as (
    select
    carrier,
    count(*) as total_shipments,
    round(avg(delivery_days), 2) as avg_delivery_days,
    round(100.0 * avg(is_delayed), 2) as delay_rate_pct
from "logistics"."main"."stg_shipments"
group by carrier
  );

[0m15:07:36.340568 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m15:07:36.341985 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m15:07:36.342204 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */
alter view "logistics"."main"."carrier_performance__dbt_tmp" rename to "carrier_performance"
[0m15:07:36.342584 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m15:07:36.343956 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: COMMIT
[0m15:07:36.344153 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m15:07:36.344328 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: COMMIT
[0m15:07:36.344662 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m15:07:36.345762 [debug] [Thread-1  ]: Using duckdb connection "model.logistics_analytics.carrier_performance"
[0m15:07:36.345965 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "logistics_analytics", "target_name": "dev", "node_id": "model.logistics_analytics.carrier_performance"} */
drop view if exists "logistics"."main"."carrier_performance__dbt_backup" cascade
[0m15:07:36.346217 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m15:07:36.346809 [debug] [Thread-1  ]: Timing info for model.logistics_analytics.carrier_performance (execute): 15:07:36.334963 => 15:07:36.346718
[0m15:07:36.346981 [debug] [Thread-1  ]: On model.logistics_analytics.carrier_performance: Close
[0m15:07:36.348804 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95fb8f8f-d1fc-468e-8d83-31ff5bfec17e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c7a9e50>]}
[0m15:07:36.349099 [info ] [Thread-1  ]: 2 of 2 OK created sql view model main.carrier_performance ...................... [[32mOK[0m in 0.02s]
[0m15:07:36.349420 [debug] [Thread-1  ]: Finished running node model.logistics_analytics.carrier_performance
[0m15:07:36.350093 [debug] [MainThread]: Using duckdb connection "master"
[0m15:07:36.350265 [debug] [MainThread]: On master: BEGIN
[0m15:07:36.350408 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:07:36.353001 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:07:36.353174 [debug] [MainThread]: On master: COMMIT
[0m15:07:36.353317 [debug] [MainThread]: Using duckdb connection "master"
[0m15:07:36.353458 [debug] [MainThread]: On master: COMMIT
[0m15:07:36.353645 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:07:36.353815 [debug] [MainThread]: On master: Close
[0m15:07:36.354605 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:07:36.354790 [debug] [MainThread]: Connection 'list_logistics_main' was properly closed.
[0m15:07:36.354942 [debug] [MainThread]: Connection 'model.logistics_analytics.carrier_performance' was properly closed.
[0m15:07:36.355155 [info ] [MainThread]: 
[0m15:07:36.355394 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m15:07:36.355846 [debug] [MainThread]: Command end result
[0m15:07:36.360378 [info ] [MainThread]: 
[0m15:07:36.360668 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:07:36.360912 [info ] [MainThread]: 
[0m15:07:36.361146 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:07:36.361635 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.3582342, "process_user_time": 1.411289, "process_kernel_time": 0.116693, "process_mem_max_rss": "138244", "process_out_blocks": "3851", "process_in_blocks": "0"}
[0m15:07:36.361910 [debug] [MainThread]: Command `dbt run` succeeded at 15:07:36.361851 after 0.36 seconds
[0m15:07:36.362106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2c473d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa09a6190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa084a790>]}
[0m15:07:36.362284 [debug] [MainThread]: Flushing usage events
